DEFINE NEW SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE NEW SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE NEW SHARED VARIABLE XPROG AS LOGICAL.
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
REPEAT:
    PROMPT-FOR CMP-FILE.COMP# WITH NO-BOX.
    IF LASTKEY = KEYCODE("F4") THEN LEAVE.
    FIND CMP-FILE USING CMP-FILE.COMP# NO-ERROR.
    XCOM = INPUT CMP-FILE.COMP#.
    IF NOT AVAILABLE CMP-FILE THEN
      DO:
	MESSAGE "NEW COMPANY RECORD CREATED.".
	CREATE CMP-FILE.
	ASSIGN CMP-FILE.COMP#.
      END.
    ELSE DISPLAY CMP-FILE.COMP# CO-NAME.
    SET CMP-FILE.
    PROMPT-FOR DIV-FILE.DIV# WITH NO-BOX.
    XDIV = INPUT DIV-FILE.DIV#.
    FIND DIV-FILE WHERE DIV-FILE.COMP# = XCOM AND DIV-FILE.DIV# = XDIV
      NO-ERROR.
    IF NOT AVAILABLE DIV-FILE THEN
	DO:
	    MESSAGE "NEW DIVISION RECORD CREATED.".
	    CREATE DIV-FILE.
	    ASSIGN DIV-FILE.COMP# = XCOM DIV-FILE.DIV#.
	END.
     ELSE DISPLAY DIV-FILE.DIV# DV-NAME DIV-FILE.PROG.
     SET DIV-FILE EXCEPT DIV-FILE.COMP#.
END.
