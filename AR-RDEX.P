DEFINE SHARED VARIABLE XCOM-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XDIV-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XOPR AS CHAR FORMAT "XXX".
DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE VARIABLE BEG# AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "ENTER BEGINNING CUSTOMER NUMBER".
DEFINE VARIABLE END# AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "ENTER ENDING CUSTOMER NUMBER   ".
DEFINE VARIABLE MANAGER AS LOGICAL
    LABEL "MANAGER'S ROLODEX ?".
DEFINE VARIABLE RPTDATE AS DATE.
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
DISPLAY SPACE(4)
"        R O L O D E X   C A R D   P R I N T I N G   S C R E E N       "
SKIP(1) WITH FRAME A.
    UPDATE MANAGER WITH ROW FRAME-ROW + 5 + FRAME-LINE + 5 COLUMN 17
       SIDE-LABELS OVERLAY FRAME M
       COLOR DISPLAY WHITE/RED PROMPT RED/WHITE.
    IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
    UPDATE BEG# WITH ROW FRAME-ROW + 5 + FRAME-LINE + 5 COLUMN 17
       SIDE-LABELS OVERLAY FRAME X
       COLOR DISPLAY WHITE/RED PROMPT RED/WHITE.
    IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
    UPDATE END# WITH ROW FRAME-ROW + 5 + FRAME-LINE + 5 COLUMN 17
       SIDE-LABELS OVERLAY FRAME B
       COLOR DISPLAY WHITE/RED PROMPT RED/WHITE.
    IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
  OUTPUT TO PRINTER PAGE-SIZE 0.
  FOR EACH propsl WHERE propsl.COMP# = XCOM AND
			  propsl.DIV# = XDIV AND
			  propsl.CUST# >= BEG# AND
			  propsl.CUST# <= END#
			  BY propsl.C-NAME:
    FIND FIRST ACCT-RCV WHERE ACCT-RCV.COMP# = XCOM AND
			      ACCT-RCV.DIV# = XDIV AND
			      ACCT-RCV.C-STATUS <> "I" AND
			      ACCT-RCV.CUST# = propsl.CUST# NO-ERROR.
    IF NOT AVAILABLE ACCT-RCV THEN NEXT.
    IF NOT MANAGER THEN DO:
    DISPLAY
	    propsl.C-NAME SPACE(5)
	    propsl.CUST# SKIP(0)
	    propsl.ADDR1 propsl.PROPSL# SKIP(0)
	    propsl.ADDR2 SKIP(0)
	    propsl.ADDR3 SKIP(0)
	    propsl.ADDR4 propsl.STATE SPACE(1) propsl.ZIP SKIP(0)
	    propsl.ADDR5 SKIP(0)
	    propsl.TELE SKIP(1)
	    propsl.L-NAME SKIP(0)
	    propsl.LADDR01 SKIP(0)
	    propsl.LADDR02 SKIP(0)
	    propsl.LADDR03 SPACE(1)
	    propsl.L-STATE SKIP(0)
	    propsl.FAX-TELE SKIP(5)
	    WITH NO-BOX NO-LABELS.
    END.
    IF MANAGER THEN DO:
    DISPLAY
	    propsl.CUST#
	    propsl.PROPSL# SKIP(0)
	    propsl.L-NAME SKIP(0)
	    propsl.LADDR01 SKIP(0)
	    propsl.LADDR02 SKIP(0)
	    propsl.LADDR03 SPACE(1)
	    propsl.L-STATE SKIP(13)
	    WITH FRAME MM NO-BOX NO-LABELS.
    END.
  END.
