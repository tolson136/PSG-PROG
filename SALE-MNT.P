DEF VAR SLS AS INTEGER FORMAT "ZZZ".
DEF VAR ACT-CODE AS CHAR FORMAT "X" LABEL "ACTION TO TAKE".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
FORM SPACE (15) "S A L E S   P E R S O N   U P D A T E   S C R E E N" SKIP(2)
     ACT-CODE SPACE(5) "Enter C to change, D to delete, A to add" SKIP(1)
     SPACE(20) SALESMAN.SLS# LABEL "SALES PERSON'S NUMBER" SKIP(1)
     SPACE(20) SALESMAN.SLSNAME LABEL "SALES PERSON'S NAME" SKIP(1)
     SALESMAN.M-JAN LABEL "JANUARY SALES  " SPACE(10)
     SALESMAN.M-JUL LABEL "JULY SALES     " SKIP(1)
     SALESMAN.M-FEB LABEL "FEBRUARY SALES " SPACE(10)
     SALESMAN.M-AUG LABEL "AUGUST SALES   " SKIP(1)
     SALESMAN.M-MAR LABEL "MARCH SALES    " SPACE(10)
     SALESMAN.M-SEP LABEL "SEPTEMBER SALES" SKIP(1)
     SALESMAN.M-APR LABEL "APRIL SALES    " SPACE(10)
     SALESMAN.M-OCT LABEL "OCTOBER SALES  " SKIP(1)
     SALESMAN.M-MAY LABEL "MAY SALES      " SPACE(10)
     SALESMAN.M-NOV LABEL "NOVEMBER SALES " SKIP(1)
     SALESMAN.M-JUN LABEL "JUNE SALES     " SPACE(10)
     SALESMAN.M-DEC LABEL "DECEMBER SALES " SKIP(1)
     SALESMAN.SLSYTD LABEL "SALES YTD"
     WITH FRAME TKO NO-BOX SIDE-LABELS.

PAR0: REPEAT:
  CLEAR FRAME TKO NO-PAUSE.
  UPDATE ACT-CODE WITH FRAME TKO.

IF ACT-CODE = "A" OR ACT-CODE = "a"
THEN DO:
  CREATE SALESMAN.
  UPDATE SALESMAN.SLS# SALESMAN.SLSNAME SALESMAN.M-JAN SALESMAN.M-FEB
	 SALESMAN.M-MAR SALESMAN.M-APR SALESMAN.M-MAY SALESMAN.M-JUN
	 SALESMAN.M-JUL SALESMAN.M-AUG SALESMAN.M-SEP SALESMAN.M-OCT
	 SALESMAN.M-NOV SALESMAN.M-DEC SALESMAN.SLSYTD WITH FRAME TKO.
  RELEASE SALESMAN.
  NEXT PAR0.
END.

IF ACT-CODE = "C" OR ACT-CODE = "c"
THEN DO:
  PROMPT-FOR SALESMAN.SLS# WITH FRAME TKO.
  SLS = INPUT SALESMAN.SLS#.
  FIND FIRST SALESMAN WHERE SALESMAN.SLS# = SLS.
  IF NOT AVAILABLE SALESMAN THEN NEXT PAR0.
  UPDATE SALESMAN.SLSNAME SALESMAN.M-JAN SALESMAN.M-FEB
	 SALESMAN.M-MAR SALESMAN.M-APR SALESMAN.M-MAY SALESMAN.M-JUN
	 SALESMAN.M-JUL SALESMAN.M-AUG SALESMAN.M-SEP SALESMAN.M-OCT
	 SALESMAN.M-NOV SALESMAN.M-DEC SALESMAN.SLSYTD WITH FRAME TKO.
  RELEASE SALESMAN.
  NEXT PAR0.
END.

IF ACT-CODE = "D" OR ACT-CODE = "d"
THEN DO:
  PROMPT-FOR SALESMAN.SLS# WITH FRAME TKO.
  SLS = INPUT SALESMAN.SLS#.
  FIND FIRST SALESMAN WHERE SALESMAN.SLS# = SLS.
  IF NOT AVAILABLE SALESMAN THEN NEXT PAR0.
  DISPLAY SALESMAN WITH FRAME TKO.
  PAUSE MESSAGE
   "PRESS <D> TO VERIFY DELETE. PRESS <F4> TO AVOID DELETE".
 IF LASTKEY = KEYCODE("D") THEN DELETE SALESMAN.
 IF LASTKEY = KEYCODE("F4") THEN NEXT PAR0.
END.
END.
