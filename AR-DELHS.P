DEFINE SHARED VAR XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VAR XDIV AS INTEGER FORMAT "ZZ".
DEFINE VAR BEG# AS DATE FORMAT "99/99/9999".
DEFINE VAR END# AS DATE FORMAT "99/99/9999".
DEFINE VAR CUST-BEG AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEFINE VAR CUST-END AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEFINE VAR CNT AS INTEGER FORMAT "ZZZZZ"
    LABEL "NUMBER OF A/R HISTORY TRANSACTIONS DELETED ".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
DISPLAY SPACE(15)
"A/R   H I S T O R Y   D E L E T I O N   S C R E E N" SKIP(0)
    "COMPANY: " XCOM SPACE(29) "DIVISION: " XDIV SKIP(4)
    WITH NO-BOX NO-LABELS.
UPDATE SKIP(1) BEG# LABEL "ENTER BEGINNING DATE"
    WITH NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
UPDATE SKIP(1) END# LABEL "ENTER ENDING DATE"
    WITH NO-BOX SIDE-LABELS.
UPDATE SKIP(1) CUST-BEG LABEL "ENTER FIRST CUSTOMER TO DELETE"
    WITH NO-BOX SIDE-LABELS.
UPDATE SKIP(1) CUST-END LABEL "ENTER LAST CUSTOMER TO DELETE"
    WITH NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
CNT = 0.
FOR EACH TRANFILE WHERE TRANFILE.COMP# = XCOM AND
			TRANFILE.DIV# = XDIV AND
			TRANFILE.TR-STAT = "I" AND
			TRANFILE.T-DATE >= BEG# AND
			TRANFILE.T-DATE <= END# AND
			TRANFILE.CUST# >= CUST-BEG AND
			TRANFILE.CUST# <= CUST-END:
	    DELETE TRANFILE.
	    CNT = CNT + 1.
END.
	    CLEAR FRAME A NO-PAUSE.
	    DISPLAY CNT WITH FRAME A NO-BOX SIDE-LABELS.
