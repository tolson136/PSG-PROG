DEF VAR BEG# AS DECIMAL FORMAT "ZZZZZZZZZZ"
	     LABEL "ENTER BEGINNING CUSTOMER NUMBER".
DEF VAR END# AS DECIMAL FORMAT "ZZZZZZZZZZ"
	     LABEL "ENTER ENDING CUSTOMER NUMBER   ".
DEF VAR BEGM# AS DATE FORMAT "99/99/9999"
	     LABEL "ENTER BEGINNING DATE".
DEF VAR ENDM# AS DATE FORMAT "99/99/9999"
	     LABEL "ENTER ENDING DATE".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
DISPLAY SPACE(6)
"A R C H I V E D   M E T A L   T I C K E T   R E P O R T   S C R E E N"
SKIP(4) WITH NO-BOX.
    UPDATE BEG# SKIP(2) WITH SIDE-LABELS COLOR DISPLAY NORMAL PROMPT W/MA.
    UPDATE END# SKIP(2) WITH SIDE-LABELS COLOR DISPLAY NORMAL PROMPT W/MA.
    UPDATE BEGM# SKIP(2) WITH SIDE-LABELS COLOR DISPLAY NORMAL PROMPT W/MA.
    UPDATE ENDM# SKIP(2) WITH SIDE-LABELS COLOR DISPLAY NORMAL PROMPT W/MA.
    HIDE.
    OUTPUT TO PRINTER.
     FOR EACH MET-ARCH USE-INDEX INDX6 WHERE MET-ARCH.CUST# >= BEG# AND
					     MET-ARCH.CUST# <= END# AND
					     MET-ARCH.DATE-RET >= BEGM# AND
					     MET-ARCH.DATE-RET <= ENDM#:
     FIND FIRST ACCT-RCV WHERE ACCT-RCV.CUST# = MET-ARCH.CUST# NO-ERROR.
     IF NOT AVAILABLE ACCT-RCV THEN NEXT.
    FORM HEADER TODAY FORMAT "99/99/9999"
	"ARCHIVED METAL TICKET REPORT" AT 25
	"PAGE: " AT 65 PAGE-NUMBER FORMAT ">>9" SKIP(0)
"--------------------------------------------------------------------------------" SKIP(0)
	    "CUST NO." AT 1 "CUSTOMER NAME" AT 12 "ITEM#" AT 38
	    "VOL AMT" AT 49 "D/L SPENT" AT 59 "DATE COMPL" AT 70
"--------------------------------------------------------------------------------" SKIP(1)
      WITH FRAME X PAGE-TOP NO-BOX NO-LABEL NO-UNDERLINE.
      VIEW FRAME X.
     DISPLAY MET-ARCH.CUST# ACCT-RCV.C-NAME MET-ARCH.ITEM#
	     MET-ARCH.TOT-AMT-REM FORMAT "$->>>,>>>.99"
	     MET-ARCH.DL FORMAT "$->>>,>>>.99"
	     MET-ARCH.DATE-RET WITH NO-LABELS NO-BOX.
END.
