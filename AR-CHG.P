DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE VARIABLE XCUST AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEFINE VAR XPROP AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEFINE SHARED VARIABLE XCOM-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XDIV-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XOPR AS CHAR FORMAT "XXX".
DEF VAR Q1 AS CHAR FORMAT "X(25)".
DEF VAR Q2 AS CHAR FORMAT "X(25)".
DEF VAR Q3 AS CHAR FORMAT "X(25)".
DEF VAR QNAME AS CHAR FORMAT "X(25)".
DEF VAR QSTATE AS CHAR FORMAT "XX".
DEF VAR QMENTS AS CHAR FORMAT "X(10)".
DEF VAR QTELE AS CHAR FORMAT "(999) 999-9999".
REPEAT:
DISPLAY SPACE(13)
"A C C O U N T   M A I N T E N A N C E   S C R E E N         (CHG)"
SKIP(0) XCOM-N LABEL "CMP" SPACE(1)
	XDIV-N LABEL "DIV" SPACE(1)
	XOPR LABEL "OPR" SKIP(0)
	       WITH SIDE-LABELS NO-BOX COLOR DISPLAY W/BLU PROMPT Y/BLU.
    PROMPT-FOR ACCT-RCV.CUST#
	       WITH SIDE-LABELS NO-BOX COLOR DISPLAY W/BLU PROMPT Y/BLU.
    XCUST = INPUT ACCT-RCV.CUST#.
    FIND FIRST ACCT-RCV WHERE ACCT-RCV.CUST# = XCUST AND
			      ACCT-RCV.COMP# = XCOM AND
			      ACCT-RCV.DIV# = XDIV NO-ERROR.
    IF NOT AVAILABLE ACCT-RCV
	THEN DO:
	    MESSAGE "CUSTOMER # " XCUST " DOES NOT EXIST. TRY ANOTHER".
	    UNDO, RETRY.
	END.
    PROMPT-FOR XPROP
	       WITH SIDE-LABELS NO-BOX COLOR DISPLAY W/BLU PROMPT Y/BLU.
    ASSIGN XPROP.
    ASSIGN Q1 = "".
    ASSIGN Q2 = "".
    ASSIGN Q3 = "".
    ASSIGN QNAME = "".
    ASSIGN QSTATE = "".
    ASSIGN QMENTS = "".
    ASSIGN QTELE = "".
    IF XPROP <> 0 THEN DO:
      FIND FIRST PROPSL WHERE PROPSL.COMP# = XCOM AND PROPSL.DIV# = XDIV AND
	   PROPSL.CUST# = XCUST AND PROPSL.PROPSL# = XPROP NO-ERROR.
      IF NOT AVAILABLE PROPSL THEN DO:
	   MESSAGE "LEAVE BLANK OR TRY A VALID PROPOSAL #".
	   UNDO, RETRY.
      END.
      ASSIGN Q1 = LADDR01.
      ASSIGN Q2 = LADDR02.
      ASSIGN Q3 = LADDR03.
      ASSIGN QNAME = L-NAME.
      ASSIGN QSTATE = L-STATE.
      ASSIGN QMENTS = L-COMMENTS.
      ASSIGN QTELE = L-TELE.
    END.
    IF LASTKEY = KEYCODE("F4") THEN LEAVE.
    DISPLAY
	    ACCT-RCV.CUST# LABEL "CUSTOMER NUMBER" SPACE(3)
	    XPROP LABEL "CURRENT PROPOSAL #"
	    ACCT-RCV.COMP# LABEL "COMPANY NUMBER " SKIP(0)
	    ACCT-RCV.C-NAME LABEL "CUSTOMER NAME  " SPACE(4)
	    C-STATUS LABEL "STATUS" SPACE(6)
	    ACCT-RCV.DIV# LABEL "DIVISION NUMBER" SKIP(0)
	    ADDR-1 LABEL "ADDRESS 1" SPACE(5)
	    QNAME LABEL "LOC NAME.." SKIP(0)
	    ADDR-2 LABEL "ADDRESS 2" SPACE(5)
	    Q1 LABEL "LOC ADDR 1" SKIP(0)
	    ADDR-3 LABEL "ADDRESS 3" SPACE(5)
	    Q2 LABEL "LOC ADDR 2" SKIP(0)
	    ADDR-4 LABEL "ADDRESS 4" SPACE(5)
	    Q3 LABEL "LOC ADDR 3" SKIP(0)
	    ADDR-5 LABEL "ADDRESS 5" SPACE(5)
	    QSTATE LABEL "LOC STATE " SPACE(2)
	    QMENTS LABEL "LOC COMM." SKIP(0)
	    ACCT-RCV.STATE LABEL "STATE    " SPACE(8)
	    ACCT-RCV.ZIP SPACE(5)
	    QTELE LABEL "LOC TELEPHONE" SKIP(0)
	    ACCT-RCV.TELE LABEL "TELEPHONE"
	    PO# LABEL "PO"
	    ACCT-RCV.SUB#
	    ACCT-RCV.ROUTE# SKIP(0)
	    EXP-DATE LABEL "CNTRT STR DT"
	    EXPIRE-DT LABEL "EXPIRATION DATE"
	    COMMENTS LABEL "COMMENTS "
	    SHRT-NAM LABEL "SHORT NAME"
	    C-TYPE LABEL "CUSTOMER TYPE"
	    OPEN-DT LABEL "OPEN DATE"
	    STMT-CD LABEL "PRINT STATEMENT? Y/N"
	    SRVC-CHG LABEL "SRV?"
	    SRVC-PER LABEL "%"
	    SRVC-DAYS LABEL "DAYS"
	    Fuel_Sur LABEL "FUEL?"
	    Fuel% LABEL "Muliplier" SKIP(0)
	    LP-DATE LABEL "PAY DATE." SPACE(5)
	    SLS# LABEL "SALES PERSON........" SPACE(4)
	    CITY-CD LABEL "CITY CODE........." SKIP(0)
	    LST-DATE LABEL "SALE DATE" SPACE(5)
	    TERM-CD LABEL "TERMS CODE.........." SPACE(6)
	    CNTY-CD LABEL "COUNTY CODE......." SKIP(0)
	    BAL-1 LABEL "PERIOD 1 BALANCE" SPACE(2)
	    SLS-YTD LABEL "SALES YTD........." SKIP(0)
	    BAL-2 LABEL "PERIOD 2 BALANCE" SPACE(2)
	    COST-YTD LABEL "COST YTD.........." SKIP(0)
	    BAL-3 LABEL "PERIOD 3 BALANCE" SPACE(2)
	    SRVC-YTD LABEL "SERVICE CHARGE YTD" SKIP(0)
	    BAL-4 LABEL "PERIOD 4 BALANCE" SPACE(2)
	    SLS-LAST LABEL "SALES LAST YEAR..." SKIP(0)
	    FUTR-DUE LABEL "FUTURE BALANCE.." SPACE(2)
	    CST-LAST LABEL "COST LAST YEAR...." SKIP(0)
	    SRVC-DUE LABEL "SERV CHARGE DUE." SPACE(2)
	    TOT-BAL LABEL "TOTAL BALANCE DUE."
	       WITH SIDE-LABELS NO-BOX COLOR DISPLAY W/BLU PROMPT Y/BLU.
IF (USERID <> "OPERATIONS") AND (USERID <> "LANDMARK") AND (USERID <> "GARCIA")
THEN DO:
    PROMPT-FOR ACCT-RCV.C-NAME
	       C-STATUS ADDR-1 ADDR-2 ADDR-3 ADDR-4 ADDR-5 ACCT-RCV.STATE
	       ACCT-RCV.ZIP ACCT-RCV.TELE PO# EXP-DATE EXPIRE-DT COMMENTS
	       SHRT-NAM C-TYPE OPEN-DT STMT-CD SRVC-CHG SRVC-PER
	       SRVC-DAYS Fuel_Sur Fuel% LP-DATE SLS# CITY-CD LST-DATE
	       TERM-CD CNTY-CD BAL-1 BAL-2 BAL-3 BAL-4
	       FUTR-DUE SRVC-DUE SLS-YTD COST-YTD SRVC-YTD SLS-LAST
	       CST-LAST TOT-BAL WITH COLOR DISPLAY W/BLU PROMPT Y/BLU.
    ASSIGN ACCT-RCV.
END.
END.
