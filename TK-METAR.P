DEFINE SHARED VAR XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VAR XDIV AS INTEGER FORMAT "ZZ".
DEFINE VAR BEG# AS DATE FORMAT "99/99/9999".
DEFINE VAR END# AS DATE FORMAT "99/99/9999".
DEFINE VAR BG# AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEFINE VAR ED# AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEFINE VAR CNT AS INTEGER FORMAT "ZZZZZ" LABEL "NUMBER OF TICKETS ARCHIVED".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
DISPLAY SPACE(18) "C O N T R A C T   A R C H I V E   S C R E E N" SKIP(0)
    "COMPANY: " XCOM SPACE(29) "DIVISION: " XDIV SKIP(3)
    WITH NO-BOX NO-LABELS.
UPDATE SKIP(2) BEG# LABEL "ENTER BEGINNING DATE"
    WITH NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
UPDATE SKIP(2) END# LABEL "ENTER ENDING DATE" SKIP(2)
    WITH NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
UPDATE BG# LABEL "ENTER BEGINNING CUSTOMER" SKIP(2)
    WITH NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
UPDATE ED# LABEL "ENTER ENDING CUSTOMER" SKIP(2)
    WITH NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
CNT = 0.
FOR EACH TICKET WHERE TICKET.COMP# = XCOM AND
			TICKET.DIV# = XDIV AND
			TICKET.T-STAT = "X" AND
			TICKET.DATE-PRT >= BEG# AND
			TICKET.DATE-PRT <= END# AND
			TICKET.CUST# >= BG# AND
			TICKET.CUST# <= ED#:
CREATE MET-ARCH.
    MET-ARCH.CABLE = TICKET.CABLE.
    MET-ARCH.CABLE-AMT = TICKET.CABLE-AMT.
    MET-ARCH.COMP# = TICKET.COMP#.
    MET-ARCH.CUST# = TICKET.CUST#.
    MET-ARCH.DATE-PRT = TICKET.DATE-PRT.
    MET-ARCH.DATE-RET = TICKET.DATE-RET.
    MET-ARCH.DIV# = TICKET.DIV#.
    MET-ARCH.DL = TICKET.DL.
    MET-ARCH.DL-BAL = TICKET.DL-BAL.
    MET-ARCH.DL-BUD = TICKET.DL-BUD.
    MET-ARCH.DL-LAST = TICKET.DL-LAST.
    MET-ARCH.FREQ = TICKET.FREQ.
    MET-ARCH.ITEM# = TICKET.ITEM#.
    MET-ARCH.M-NAME = TICKET.M-NAME.
    MET-ARCH.M-NUM = TICKET.M-NUM.
    MET-ARCH.MONTH# = TICKET.MONTH#.
    MET-ARCH.MTD-VOL = TICKET.MTD-VOL.
    MET-ARCH.OTH-AMT = TICKET.OTH-AMT.
    MET-ARCH.OTHER = TICKET.OTHER.
    MET-ARCH.PRISEC = TICKET.PRISEC.
    MET-ARCH.PROPSL# = TICKET.PROPSL#.
    MET-ARCH.PRT = TICKET.PRT.
    MET-ARCH.RET = TICKET.RET.
    MET-ARCH.SCAFF-AMT = TICKET.SCAFF-AMT.
    MET-ARCH.SCAFFOLD = TICKET.SCAFFOLD.
    MET-ARCH.T-INDX = TICKET.T-INDX.
    MET-ARCH.T-STAT = TICKET.T-STAT.
    MET-ARCH.TOT-AMT = TICKET.TOT-AMT.
    MET-ARCH.TOT-AMT-REM = TICKET.TOT-AMT-REM.
    MET-ARCH.WK-BAL = TICKET.WK-BAL.
    MET-ARCH.WK-DL = TICKET.WK-DL.
    MET-ARCH.WK-DL-BAL = TICKET.WK-DL-BAL.
    MET-ARCH.WK-DL-BUD = TICKET.WK-DL-BUD.
    MET-ARCH.WK-START = TICKET.WK-START.
    MET-ARCH.WK-USED = TICKET.WK-USED.
    MET-ARCH.WTD-VOL = TICKET.WTD-VOL.
RELEASE MET-ARCH.
END.
FOR EACH TICKET WHERE TICKET.COMP# = XCOM AND
			TICKET.DIV# = XDIV AND
			TICKET.T-STAT = "X" AND
			TICKET.DATE-PRT >= BEG# AND
			TICKET.DATE-PRT <= END# AND
			TICKET.CUST# >= BG# AND
			TICKET.CUST# <= ED#:
	    DELETE TICKET.
	    CNT = CNT + 1.
END.
	    CLEAR FRAME A NO-PAUSE.
	    DISPLAY CNT WITH FRAME A NO-BOX SIDE-LABELS.
