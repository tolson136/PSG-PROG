DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE VAR BDATE AS DATE FORMAT "99/99/9999".
DEFINE VAR EDATE AS DATE FORMAT "99/99/9999".
DEFINE VAR NMO AS INTEGER FORMAT "ZZ".
DEF VAR XSUB AS INTEGER FORMAT "ZZ" LABEL "ENTER SUB-DIVISION #".
DEF VAR XROUTE AS INTEGER FORMAT "ZZ" LABEL "ENTER ROUTE #".
DEF VAR TOT1 AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEF VAR TOT2 AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEF VAR TOT3 AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEF VAR TOT4 AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEF VAR BIRD-SONG AS LOGICAL
  LABEL "INCLUDE WEEKLY BALANCE AND TOTAL AMOUNT REMAINING ?".
IF (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
DISPLAY SPACE(1)
"O U T S T A N D I N G   D/L   T I C K E T   S U B   &   R O U T E   R P T"
SKIP(2) WITH FRAME C NO-BOX SIDE-LABELS.
UPDATE BDATE LABEL "ENTER STARTING DATE RANGE"
    WITH FRAME C NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
UPDATE EDATE LABEL "ENTER ENDING DATE RANGE  "
    WITH FRAME C NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
UPDATE SKIP(1) NMO LABEL "ENTER ANY MONTH YOU WISH TO EXCLUDE"
   WITH FRAME C NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
UPDATE SKIP(1) XSUB WITH FRAME C NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
UPDATE SKIP(1) XROUTE WITH FRAME C NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
UPDATE SKIP(1) BIRD-SONG WITH FRAME C NO-BOX SIDE-LABELS.
OUTPUT TO PRINTER.
FOR EACH TICKET WHERE TICKET.COMP# = XCOM AND
		      TICKET.DIV# = XDIV AND
		      (T-STAT = "I" OR T-STAT = "Z" OR
		      T-STAT = "P" OR T-STAT = "Y") AND
		      (DATE-PRT >= BDATE AND DATE-PRT <= EDATE) AND
		      TICKET.SUB# = XSUB AND
		      TICKET.ROUTE# = XROUTE AND
		      (TICKET.MONTH# <> NMO)
				    BY TICKET.CUST#
				    BY TICKET.PROPSL#
				    BY TICKET.ITEM#
				    BY TICKET.MONTH#
				    BY TICKET.T-INDX:
    FORM HEADER TODAY FORMAT "99/99/9999"
	 "OUTSTANDING D/L TICKET SUB & ROUTE REPORT" AT 20 SKIP(1)
	 "COMPANY" AT 20 TICKET.COMP# "DIVISION" AT 50 TICKET.DIV# SKIP(1)
	 "SUB-DIVISION" AT 20 TICKET.SUB# "ROUTE #" AT 50 TICKET.ROUTE# SKIP(1)
	 "FROM:" AT 20 BDATE "TO:" AT 40 EDATE SKIP(1).
FIND FIRST ACCT-RCV WHERE ACCT-RCV.COMP# = TICKET.COMP# AND
		    ACCT-RCV.DIV# = TICKET.DIV# AND
		    ACCT-RCV.CUST# = TICKET.CUST# AND
		    ACCT-RCV.C-STATUS <> "I".
IF NOT AVAILABLE ACCT-RCV THEN NEXT.
FIND FIRST PROPSL WHERE PROPSL.COMP# = TICKET.COMP# AND
			PROPSL.DIV# = TICKET.DIV# AND
			PROPSL.CUST# = TICKET.CUST# AND
			PROPSL.PROPSL# = TICKET.PROPSL# NO-ERROR.
DISPLAY SKIP(0) ACCT-RCV.C-NAME PROPSL.L-NAME TICKET.FREQ
	SKIP(0) TICKET.CUST# TICKET.PROPSL# TICKET.ITEM# TICKET.MONTH#
	TICKET.T-INDX SPACE(10) TICKET.DATE-PRT TICKET.T-STAT SKIP(0)
	TICKET.DL-BUD SPACE(5) TICKET.DL-BAL SPACE(5).
TOT1 = TOT1 + TICKET.DL-BUD.
TOT2 = TOT2 + TICKET.DL-BAL.
IF BIRD-SONG THEN DO:
   TOT3 = TOT3 + TICKET.WK-BAL.
   TOT4 = TOT4 + TICKET.TOT-AMT-REM.
   DISPLAY TICKET.WK-BAL SPACE(4) TICKET.TOT-AMT-REM SKIP(0).
END.
END.
DISPLAY SKIP(2) TOT1 SPACE(5) TOT2 SPACE(5) TOT3 SPACE(4) TOT4 SKIP(0)
	"          T  O  T  A  L  S" WITH FRAME B NO-LABELS.
