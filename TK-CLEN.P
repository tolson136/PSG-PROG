DEFINE SHARED VARIABLE XCOM-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XDIV-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XOPR AS CHAR FORMAT "XXX".
DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE VARIABLE BEG# AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "ENTER BEGINNING CUSTOMER NUMBER".
DEFINE VARIABLE END# AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "ENTER ENDING CUSTOMER NUMBER   ".
DEF VAR ONCE AS LOGICAL LABEL "EXCLUDE 'ONE_TIME_CLEANING' FROM REPORT ?".
DEFINE VARIABLE RPTDATE AS DATE FORMAT "99/99/9999".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
ONCE = no.
DISPLAY SPACE(4)
"     S P E C I A L   C L E A N I N G S   R E P O R T   S C R E E N     "
SKIP(1) WITH FRAME A.
    UPDATE BEG# WITH ROW FRAME-ROW + 5 + FRAME-LINE + 5 COLUMN 17
       SIDE-LABELS OVERLAY FRAME X
       COLOR DISPLAY WHITE/RED PROMPT RED/WHITE.
    IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
    UPDATE END# WITH ROW FRAME-ROW + 5 + FRAME-LINE + 5 COLUMN 17
       SIDE-LABELS OVERLAY FRAME B
       COLOR DISPLAY WHITE/RED PROMPT RED/WHITE.
    IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
    UPDATE ONCE WITH ROW FRAME-ROW + 5 + FRAME-LINE + 5 COLUMN 17
       SIDE-LABELS OVERLAY FRAME QC
       COLOR DISPLAY WHITE/RED PROMPT RED/WHITE.
  OUTPUT TO PRINTER.
  RPTDATE = TODAY.
  FOR EACH PRO-DESP WHERE PRO-DESP.COMP# = XCOM AND
			  PRO-DESP.DIV# = XDIV AND
			  (PRO-DESP.FREQ = "ONE_TIME_CLEANING" OR
			   PRO-DESP.FREQ = "SPECIAL_CLEANING" OR
			   PRO-DESP.FREQ = "ON_CALL" OR
			   PRO-DESP.FREQ = "INITIAL_CLEANING") AND
			  PRO-DESP.CUST# >= BEG# AND
			  PRO-DESP.CUST# <= END#
			  BY PRO-DESP.CUST#
			  BY PRO-DESP.PROPSL#
			  BY PRO-DESP.ITEM#:
    IF ONCE AND PRO-DESP.FREQ = "ONE_TIME_CLEANING" THEN NEXT.
       FIND FIRST PROPSL WHERE PROPSL.COMP# = XCOM AND
			       PROPSL.DIV# = XDIV AND
			       PROPSL.CUST# = PRO-DESP.CUST# AND
			       PROPSL.PROPSL# = PRO-DESP.PROPSL# NO-ERROR.
       IF NOT AVAILABLE PROPSL THEN NEXT.
       FORM HEADER RPTDATE FORMAT "99/99/9999"
	    "SPECIAL CLEANING REPORT" AT 28
	    "PAGE:" AT 65 PAGE-NUMBER FORMAT ">>9" SKIP(0)
	    "COMPANY: " AT 21 XCOM-N SKIP(0)
	    "DIVISION: " AT 21 XDIV-N "OPER: " AT 65 XOPR SKIP(1)
	    "CUST NUMBER" AT 1 "CUSTOMER NAME" AT 15 "LOCATION" AT 50 SKIP(0)
	    "ITEM #" AT 1 "PROPOSAL #" AT 10 "FREQUENCY" AT 25
	    "LAST CLEANING" AT 60 SKIP(0).
    DISPLAY
	    PROPSL.CUST# AT 1
	    PROPSL.C-NAME AT 15
	    PROPSL.L-NAME AT 50 SKIP(0)
	    PRO-DESP.ITEM# AT 1
	    PROPSL.PROPSL# AT 10
	    PRO-DESP.FREQ AT 25
	    PRO-DESP.CL-DATE AT 60 WITH NO-BOX NO-LABELS.
  END.
