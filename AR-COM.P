DEF SHARED VAR XCOM AS INTEGER FORMAT "ZZ".
DEF SHARED VAR XDIV AS INTEGER FORMAT "ZZ".
DEF SHARED VAR XCOM-N AS CHAR FORMAT "X(30)".
DEF SHARED VAR XDIV-N AS CHAR FORMAT "X(30)".
DEF SHARED VAR XOPR AS CHAR FORMAT "XXX".
DEF VAR BEG# AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEF VAR END# AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEF VAR BDATE AS DATE FORMAT "99/99/9999".
DEF VAR EDATE AS DATE FORMAT "99/99/9999".
DEF VAR TOT-OUT AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEF VAR TOT-CSH AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEF VAR H-AMT AS DECIMAL FORMAT "$->>>,>>>.99".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
TOT-OUT = 0.00.
TOT-CSH = 0.00.
DISPLAY SPACE(15) "C O M M I S S I O N S   R E P O R T   S C R E E N"
SKIP(0) XCOM-N LABEL "COMPANY" XDIV-N LABEL "DIVISION"
SKIP(4) BEG# LABEL "ENTER BEGINNING CUSTOMER"
SKIP(2) END# LABEL "ENTER ENDING CUSTOMER"
SKIP(2) BDATE LABEL "ENTER BEGINNING DATE"
SKIP(2) EDATE LABEL "ENTER ENDING DATE"
    WITH FRAME A NO-BOX NO-LABELS.
UPDATE BEG# END# BDATE EDATE
    WITH FRAME A SIDE-LABELS COLOR DISPLAY NORMAL PROMPT W/MA.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
OUTPUT TO PRINTER.
FOR EACH TRANFILE WHERE TRANFILE.COMP# = XCOM AND
			TRANFILE.DIV# = XDIV AND
			TRANFILE.CUST# >= BEG# AND
			TRANFILE.CUST# <= END# AND
			TRANFILE.T-DATE >= BDATE AND
			TRANFILE.T-DATE <= EDATE AND
			TRANFILE.COMMIS > 0.00 AND
			TRANFILE.T-TYPE = "A"
			BY TRANFILE.CUST#
			BY TRANFILE.INV-NO:
    FIND FIRST ACCT-RCV WHERE ACCT-RCV.COMP# = TRANFILE.COMP# AND
			      ACCT-RCV.DIV# = TRANFILE.DIV# AND
			      ACCT-RCV.CUST# = TRANFILE.CUST# NO-ERROR.
	IF NOT AVAILABLE ACCT-RCV THEN NEXT.
    H-AMT = TRANFILE.COMMIS.
    FORM HEADER TODAY FORMAT "99/99/9999"
	"COMMISSION REPORT" AT 31
	"PAGE: " AT 65 PAGE-NUMBER FORMAT ">>9" SKIP(0)
	"FROM: " BDATE "COMPANY :" AT 25 XCOM-N SKIP(0)
	"TO  : " EDATE "DIVISION:" AT 25 XDIV-N "OPER:" AT 65 XOPR SKIP(0)
"--------------------------------------------------------------------------------" SKIP(0) "ACCOUNT NO" AT 1 "ACCOUNT NAME" AT 12 "DATE" AT 41 "INVOICE #"
    AT 51 "OUTSTANDING" AT 61 "PAID" AT 76 SKIP(0)
"--------------------------------------------------------------------------------" SKIP(1) WITH FRAME X PAGE-TOP NO-BOX NO-LABEL NO-UNDERLINE.
	    VIEW FRAME X.
	DISPLAY TRANFILE.CUST# AT 1 ACCT-RCV.C-NAME AT 12
		TRANFILE.T-DATE AT 38 TRANFILE.INV-NO AT 50
		WITH NO-BOX NO-LABELS.
	IF TRANFILE.TR-STAT = "A"
	    THEN DO:
		DISPLAY TRANFILE.COMMIS FORMAT "$->,>>>.99" AT 61.
		TOT-OUT = TOT-OUT + TRANFILE.COMMIS.
	    END.
	IF TRANFILE.TR-STAT = "I"
	    THEN DO:
		DISPLAY H-AMT FORMAT "$->,>>>.99" AT 71.
		TOT-CSH = TOT-CSH + TRANFILE.COMMIS.
	    END.
END.
    DISPLAY SKIP(3) TOT-OUT LABEL "TOTAL OUTSTANDING"
    SPACE(10) TOT-CSH LABEL "TOTAL RECEIVED" WITH NO-BOX SIDE-LABELS.
