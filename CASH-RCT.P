DEF VAR ASTER AS CHAR FORMAT "XX".
DEF VARIABLE BS AS CHAR FORMAT "X".
DEF SHARED VARIABLE XOPR AS CHAR FORMAT "XXX".
DEF SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEF SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEF VARIABLE XCST AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEF SHARED VARIABLE XCOM-N AS CHAR FORMAT "X(30)".
DEF SHARED VARIABLE XDIV-N AS CHAR FORMAT "X(30)".
DEF VARIABLE XCTR AS INTEGER FORMAT "99".
DEF VARIABLE YYY AS INTEGER FORMAT "9999".
DEF SHARED VARIABLE P-PERIOD AS CHAR FORMAT "XXXXXX".
DEF SHARED VARIABLE P-DATE AS DATE FORMAT "99/99/9999".
DEF SHARED VARIABLE PC-RECPT AS LOGICAL.
DEF VAR CHK-TOT AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEF VAR ADJ-TOT AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEF VAR NINE AS INTEGER FORMAT "ZZZZ".
DEF VAR HOLD-AMT AS DECIMAL FORMAT "$->>>,>>>.99".
DEF VAR HOLD-INV AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEF VAR HOLD-PRF AS DECIMAL FORMAT "$->>>,>>>.99".
DEF VAR HOLD-DIF AS DECIMAL FORMAT "$->>>,>>>.99".
DEF VAR HOLD-CHECK AS CHAR FORMAT "X(10)".
DEF VAR HOLD-REC# AS INTEGER FORMAT "ZZZZ".
DEF VAR HOLDX-REC# AS INTEGER FORMAT "ZZZZ".
DEF VAR XX-REC# AS INTEGER FORMAT "ZZZZ".
DEF VAR XX-LINE AS INTEGER FORMAT "ZZZZ".
DEF VAR XLINE AS INTEGER FORMAT "ZZZZ".
DEF VAR HOLD-T-TYPE AS CHAR FORMAT "X".
DEF VAR HOLD-TR-STAT AS CHAR FORMAT "X".
DEF VAR HOLDX-TR-STAT AS CHAR FORMAT "X".
DEF VAR HOLD-T-DATE AS DATE FORMAT "99/99/9999".
DEF VAR HOLDX-T-DATE AS DATE FORMAT "99/99/9999".
DEF VAR HOLD-REFER AS CHAR FORMAT "X(14)".
DEF VAR HOLDX-REFER AS CHAR FORMAT "X(14)".
DEF VAR HOLD-T-AMT AS DECIMAL FORMAT "$->>>,>>>.99".
DEF VAR HOLDX-T-AMT AS DECIMAL FORMAT "$->>>,>>>.99".
DEF VAR HOLD-INV-NO AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEF VAR HOLD-AGE AS CHAR FORMAT "X".
DEF VAR HOLD-PERIOD AS CHAR FORMAT "X(6)".
DEF VAR HOLD-SLS# AS INTEGER FORMAT "ZZZ".
DEF VAR HOLD-T-OPR AS CHAR FORMAT "XXX".
DEF VAR REC-CTR AS INTEGER FORMAT "ZZZZ".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
YYY = 0.
NINE = 9.
 FORM TRANFILE.REC# SPACE(6) TRANFILE.T-AMT FORMAT "$-ZZZ,ZZZ.99"
      SPACE(3) TRANFILE.INV-NO SPACE(7) TRANFILE.T-TYPE SPACE(2)
      TRANFILE.TR-STAT SPACE(6)
      TRANFILE.T-DATE FORMAT "99/99/9999" SPACE(4) TRANFILE.REFER
      WITH FRAME POST-C OVERLAY SCROLL 1 10 DOWN NO-LABELS NO-BOX.
 FORM HOLD-REC# SPACE(6) HOLDX-T-AMT FORMAT "$-ZZZ,ZZZ.99"
      SPACE(3) HOLD-INV-NO SPACE(7) HOLD-T-TYPE SPACE(2)
      HOLDX-TR-STAT SPACE(6)
      HOLDX-T-DATE FORMAT "99/99/9999" SPACE(4) HOLDX-REFER
      WITH FRAME POST-D OVERLAY NO-LABELS NO-BOX ROW 21.
 FORM TRANFILE.T-TYPE LABEL "TYPE" SPACE(2) TRANFILE.INV-NO LABEL "INV#"
      SPACE(2) TRANFILE.T-DATE LABEL "DATE" FORMAT "99/99/9999" SPACE(2)
      TRANFILE.REFER WITH FRAME POST-E OVERLAY NO-BOX SIDE-LABELS ROW 21.
PAR0: REPEAT:
HIDE FRAME POST-C NO-PAUSE.
HIDE FRAME POST-D NO-PAUSE.
HIDE FRAME POST-E NO-PAUSE.
CLEAR FRAME POST-C ALL NO-PAUSE.
CLEAR FRAME POST-D ALL NO-PAUSE.
CLEAR FRAME POST-E ALL NO-PAUSE.
ASTER = "**".
DISPLAY
" A/R            C A S H   R E C E I P T S   S C R E E N      DATE:" TODAY
FORMAT "99/99/9999" SKIP(1)
	XCOM LABEL "COMPANY NUMBER" SPACE(18)
	XDIV LABEL "DIVISION NUMBER" SKIP(0)
	XCOM-N LABEL "CMP" SPACE(1)
	XDIV-N LABEL "DIV" SPACE(1)
	XOPR LABEL "OPR" SKIP(0)
"================================================================================"
SKIP(0) WITH FRAME POST-A SIDE-LABELS NO-BOX.
    PROMPT-FOR ACCT-RCV.CUST# LABEL "CUST #" WITH FRAME POST-A.
    XCST = INPUT ACCT-RCV.CUST#.
    IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
    FIND FIRST ACCT-RCV WHERE ACCT-RCV.CUST# = XCST AND
			ACCT-RCV.COMP# = XCOM AND
			ACCT-RCV.DIV# = XDIV.
    IF ACCT-RCV.C-STATUS = "I" THEN DO:
	MESSAGE "THIS IS AN INACTIVE CUSTOMER - CAN NOT UPDATE".
	NEXT.
    END.
    DISPLAY
	    ACCT-RCV.CUST# LABEL "CUST #" SPACE(2)
	    ACCT-RCV.C-NAME LABEL "CUST NAME" SPACE(2)
	    P-DATE LABEL "POST DATE" SKIP(0) WITH FRAME POST-A.
    UPDATE HOLD-AMT LABEL "AMT" SPACE(2)
	   HOLD-CHECK LABEL "CHECK #" SPACE(2) WITH FRAME POST-A.
    DISPLAY HOLD-PRF LABEL "PROOF" HOLD-DIF LABEL "DIF" SKIP(0)
"================================================================================" SKIP(0) SPACE(2)
"REC #      AMOUNT      INVOICE #       TY/ST        DATE        REFERENCE"
SKIP(1) WITH FRAME POST-A NO-HIDE.
YYY = 0.
BS = "N".
 HOLD-DIF = 0.0.
 HOLD-PRF = 0.0.
 DISPLAY HOLD-PRF HOLD-DIF WITH FRAME POST-A.
    FOR EACH TRANFILE WHERE TRANFILE.COMP# = XCOM AND
			    TRANFILE.DIV# = XDIV AND
			    TRANFILE.CUST# = XCST AND
			    TRANFILE.TR-STAT = "A":
	  YYY = YYY + 1.
	  UPDATE TRANFILE.REC# = YYY.
	  UPDATE BS = "Y".
    END.
    IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
  FIND FIRST TRANFILE WHERE TRANFILE.COMP# = XCOM AND
					    TRANFILE.DIV# = XDIV AND
					    TRANFILE.CUST# = XCST AND
					    TRANFILE.REC# > 0 NO-ERROR.
 IF NOT AVAILABLE TRANFILE THEN NEXT PAR0.
      HIDE FRAME POST-C NO-PAUSE.
      HIDE FRAME POST-D NO-PAUSE.
      HIDE FRAME POST-E NO-PAUSE.
      CLEAR FRAME POST-C ALL NO-PAUSE.
      CLEAR FRAME POST-D ALL NO-PAUSE.
      CLEAR FRAME POST-E ALL NO-PAUSE.
 REPEAT XCTR = 1 TO 10:
      DISPLAY TRANFILE.REC# TRANFILE.T-AMT TRANFILE.INV-NO TRANFILE.T-TYPE
	      TRANFILE.TR-STAT TRANFILE.T-DATE TRANFILE.REFER
	      WITH FRAME POST-C.
      DOWN WITH FRAME POST-C.
      FIND NEXT TRANFILE WHERE TRANFILE.COMP# = XCOM AND
					       TRANFILE.DIV# = XDIV AND
					       TRANFILE.CUST# = XCST AND
					       TRANFILE.REC# > 0 NO-ERROR.
      IF NOT AVAILABLE TRANFILE THEN LEAVE.
 END.
 UP FRAME-LINE(POST-C) - 1 WITH FRAME POST-C.
 PAR8:  REPEAT:
      CHOOSE ROW TRANFILE.REC# NO-ERROR WITH FRAME POST-C.
      COLOR DISPLAY NORMAL TRANFILE.REC# WITH FRAME POST-C.
      IF LASTKEY = KEYCODE("CURSOR-DOWN") AND FRAME-LINE(POST-C) > YYY
	  THEN DO:
	    UP 1 WITH FRAME POST-C.
	    NEXT PAR8.
	  END.
      IF LASTKEY = KEYCODE("F1")
      THEN DO:
      IF FRAME-LINE > YYY THEN NEXT PAR8.
	  FIND FIRST TRANFILE WHERE TRANFILE.COMP# = XCOM AND
				    TRANFILE.DIV# = XDIV AND
				    TRANFILE.CUST# = XCST AND
				    TRANFILE.REC# = INTEGER(FRAME-VALUE)
				    NO-WAIT NO-ERROR.
	  IF NOT AVAILABLE TRANFILE THEN NEXT PAR8.
	  UPDATE HOLD-REC# = TRANFILE.REC#.
	  UPDATE HOLD-T-AMT = TRANFILE.T-AMT.
	  UPDATE HOLD-INV-NO = TRANFILE.INV-NO.
	  UPDATE HOLD-T-TYPE = TRANFILE.T-TYPE.
	  UPDATE HOLD-TR-STAT = TRANFILE.TR-STAT.
	  UPDATE HOLD-T-DATE = TRANFILE.T-DATE.
	  UPDATE HOLD-REFER = TRANFILE.REFER.
	  UPDATE HOLD-AGE = TRANFILE.AGE.
	  UPDATE HOLD-PERIOD = TRANFILE.PERIOD.
	  UPDATE HOLD-SLS# = TRANFILE.SLS#.
	  UPDATE HOLD-T-OPR = TRANFILE.T-OPR.
	  UPDATE HOLDX-T-AMT = TRANFILE.T-AMT.
	  UPDATE HOLDX-TR-STAT = TRANFILE.TR-STAT.
	  UPDATE HOLDX-T-DATE = TRANFILE.T-DATE.
	  UPDATE HOLDX-REFER = TRANFILE.REFER.
     REPEAT:
	REPEAT:
	  UPDATE HOLDX-T-AMT HOLDX-TR-STAT HOLDX-T-DATE HOLDX-REFER
		 WITH FRAME POST-D OVERLAY COLOR DISPLAY MA/BLU PROMPT W/MA.
	  IF LASTKEY = KEYCODE("F1") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
	END.
	  IF LASTKEY = KEYCODE("ESC")
	   THEN DO:
	    UPDATE TRANFILE.REC# = HOLD-REC#.
	    UPDATE TRANFILE.T-AMT = HOLD-T-AMT.
	    UPDATE TRANFILE.INV-NO = HOLD-INV-NO.
	    UPDATE TRANFILE.T-TYPE = HOLD-T-TYPE.
	    UPDATE TRANFILE.TR-STAT = HOLD-TR-STAT.
	    UPDATE TRANFILE.T-DATE = HOLD-T-DATE.
	    UPDATE TRANFILE.REFER = HOLD-REFER.
	    UPDATE TRANFILE.AGE = HOLD-AGE.
	    UPDATE TRANFILE.PERIOD = HOLD-PERIOD.
	    UPDATE TRANFILE.SLS# = HOLD-SLS#.
	    UPDATE TRANFILE.T-OPR = HOLD-T-OPR.
	    DISPLAY TRANFILE.REC# TRANFILE.T-AMT TRANFILE.INV-NO
		    TRANFILE.T-TYPE TRANFILE.TR-STAT
		    TRANFILE.T-DATE TRANFILE.REFER
		    WITH FRAME POST-C.
	    RELEASE TRANFILE.
	    HIDE FRAME POST-D NO-PAUSE.
	    HIDE FRAME POST-E NO-PAUSE.
	    CLEAR FRAME POST-D ALL NO-PAUSE.
	    CLEAR FRAME POST-E ALL NO-PAUSE.
	    NEXT PAR8.
	  END.
	  IF LASTKEY = KEYCODE("F1") AND TRANFILE.TR-STAT = "A"
	  THEN DO:
	  UPDATE HOLDX-TR-STAT = "I".
	  UPDATE TRANFILE.TR-STAT = HOLDX-TR-STAT.
	  UPDATE TRANFILE.CHECK# = HOLD-CHECK.
	  UPDATE TRANFILE.T-AMT = HOLDX-T-AMT.
	  UPDATE TRANFILE.T-DATE = HOLDX-T-DATE.
	  UPDATE TRANFILE.REFER = HOLDX-REFER.
	  UPDATE HOLDX-REC# = 9999.
	  UPDATE TRANFILE.REC# = HOLDX-REC#.
	  RELEASE TRANFILE.
	  REPEAT XCTR = 1 TO 10 WHILE FRAME-LINE(POST-C)
				   <= FRAME-DOWN(POST-C):
	  FIND NEXT TRANFILE WHERE TRANFILE.COMP# = XCOM AND
				   TRANFILE.DIV# = XDIV AND
				   TRANFILE.CUST# = XCST AND
				   TRANFILE.TR-STAT = "A" AND
				   TRANFILE.REC# > 0 NO-ERROR.
	  IF AVAILABLE TRANFILE THEN
		DISPLAY TRANFILE.REC# TRANFILE.T-AMT TRANFILE.INV-NO
			TRANFILE.T-TYPE TRANFILE.TR-STAT
			TRANFILE.T-DATE TRANFILE.REFER
			WITH FRAME POST-C.
	  ELSE CLEAR FRAME POST-C NO-PAUSE.
	  DOWN WITH FRAME POST-C.
	  END.
	  UP XCTR - 1 WITH FRAME POST-C.
	  UPDATE YYY = YYY - 1.
	  IF HOLD-T-TYPE = "A"
	    THEN DO:
	      CREATE TRANFILE.
	      TRANFILE.AGE = HOLD-AGE.
	      TRANFILE.CHECK# = HOLD-CHECK.
	      TRANFILE.COMP# = XCOM.
	      TRANFILE.CUST# = XCST.
	      TRANFILE.DIV# = XDIV.
	      TRANFILE.INV-NO = HOLD-INV-NO.
	      TRANFILE.PERIOD = P-PERIOD.
	      TRANFILE.REFER = HOLDX-REFER.
	      TRANFILE.SLS# = HOLD-SLS#.
	      TRANFILE.T-AMT = HOLDX-T-AMT.
	      TRANFILE.T-DATE = P-DATE.
	      TRANFILE.T-OPR = HOLD-T-OPR.
	      TRANFILE.T-TYPE = "B".
	      TRANFILE.TR-STAT = "I".
	      UPDATE HOLDX-REC# = 9999.
	      UPDATE TRANFILE.REC# = HOLDX-REC#.
	      RELEASE TRANFILE.
	      UPDATE HOLD-PRF = HOLD-PRF + HOLDX-T-AMT.
	      UPDATE HOLD-DIF = HOLD-DIF + (HOLD-T-AMT - HOLDX-T-AMT).
	      DISPLAY HOLD-PRF HOLD-DIF WITH FRAME POST-A.
	      FIND FIRST ACCT-RCV WHERE ACCT-RCV.COMP# = XCOM AND
					ACCT-RCV.DIV# = XDIV AND
					ACCT-RCV.CUST# = XCST.
	      UPDATE ACCT-RCV.LP-DATE = P-DATE.
	      UPDATE ACCT-RCV.TOT-BAL = ACCT-RCV.TOT-BAL - HOLDX-T-AMT.
	      UPDATE ACCT-RCV.BAL-1 = ACCT-RCV.BAL-1 - HOLDX-T-AMT.
	      RELEASE ACCT-RCV.
	      HIDE FRAME POST-D NO-PAUSE.
	      CLEAR FRAME POST-D ALL NO-PAUSE.
	      NEXT PAR8.
	  END.
	  IF HOLD-T-TYPE = "D"
	    THEN DO:
	      CREATE TRANFILE.
	      TRANFILE.AGE = HOLD-AGE.
	      TRANFILE.CHECK# = HOLD-CHECK.
	      TRANFILE.COMP# = XCOM.
	      TRANFILE.CUST# = XCST.
	      TRANFILE.DIV# = XDIV.
	      TRANFILE.INV-NO = HOLD-INV-NO.
	      TRANFILE.PERIOD = P-PERIOD.
	      TRANFILE.REFER = HOLDX-REFER.
	      TRANFILE.SLS# = HOLD-SLS#.
	      TRANFILE.T-AMT = HOLDX-T-AMT.
	      TRANFILE.T-DATE = P-DATE.
	      TRANFILE.T-OPR = HOLD-T-OPR.
	      TRANFILE.T-TYPE = "F".
	      TRANFILE.TR-STAT = "I".
	      UPDATE HOLDX-REC# = 9999.
	      UPDATE TRANFILE.REC# = HOLDX-REC#.
	      RELEASE TRANFILE.
	      UPDATE HOLD-PRF = HOLD-PRF + HOLDX-T-AMT.
	      UPDATE HOLD-DIF = HOLD-DIF + (HOLD-T-AMT - HOLDX-T-AMT).
	      DISPLAY HOLD-PRF HOLD-DIF WITH FRAME POST-A.
	      FIND FIRST ACCT-RCV WHERE ACCT-RCV.COMP# = XCOM AND
					ACCT-RCV.DIV# = XDIV AND
					ACCT-RCV.CUST# = XCST.
	      UPDATE ACCT-RCV.SRVC-DUE = ACCT-RCV.SRVC-DUE - HOLDX-T-AMT.
	      UPDATE ACCT-RCV.TOT-BAL = ACCT-RCV.TOT-BAL - HOLDX-T-AMT.
	      RELEASE ACCT-RCV.
	      HIDE FRAME POST-D NO-PAUSE.
	      CLEAR FRAME POST-D ALL NO-PAUSE.
	      NEXT PAR8.
	  END.
	  IF HOLD-T-TYPE = "B"
	    THEN DO:
	      UPDATE HOLD-PRF = HOLD-PRF - HOLDX-T-AMT.
	      UPDATE HOLD-DIF = HOLD-DIF + (HOLD-T-AMT - HOLDX-T-AMT).
	      DISPLAY HOLD-PRF HOLD-DIF WITH FRAME POST-A.
	      FIND FIRST ACCT-RCV WHERE ACCT-RCV.COMP# = XCOM AND
					ACCT-RCV.DIV# = XDIV AND
					ACCT-RCV.CUST# = XCST.
	      UPDATE ACCT-RCV.LP-DATE = P-DATE.
	      UPDATE ACCT-RCV.TOT-BAL = ACCT-RCV.TOT-BAL + HOLDX-T-AMT.
	      UPDATE ACCT-RCV.BAL-1 = ACCT-RCV.BAL-1 + HOLDX-T-AMT.
	      RELEASE ACCT-RCV.
	      HIDE FRAME POST-D NO-PAUSE.
	      CLEAR FRAME POST-D ALL NO-PAUSE.
	      NEXT PAR8.
	  END.
	  IF HOLD-T-TYPE = "C"
	    THEN DO:
	      UPDATE HOLD-PRF = HOLD-PRF - HOLDX-T-AMT.
	      UPDATE HOLD-DIF = HOLD-DIF + (HOLD-T-AMT - HOLDX-T-AMT).
	      DISPLAY HOLD-PRF HOLD-DIF WITH FRAME POST-A.
	      FIND FIRST ACCT-RCV WHERE ACCT-RCV.COMP# = XCOM AND
					ACCT-RCV.DIV# = XDIV AND
					ACCT-RCV.CUST# = XCST.
	      UPDATE ACCT-RCV.LP-DATE = P-DATE.
	      UPDATE ACCT-RCV.TOT-BAL = ACCT-RCV.TOT-BAL + HOLDX-T-AMT.
	      UPDATE ACCT-RCV.BAL-1 = ACCT-RCV.BAL-1 + HOLDX-T-AMT.
	      RELEASE ACCT-RCV.
	      HIDE FRAME POST-D NO-PAUSE.
	      CLEAR FRAME POST-D ALL NO-PAUSE.
	      NEXT PAR8.
	  END.
	  IF HOLD-T-TYPE = "K"
	    THEN DO:
	      UPDATE HOLD-PRF = HOLD-PRF - HOLDX-T-AMT.
	      UPDATE HOLD-DIF = HOLD-DIF + (HOLD-T-AMT - HOLDX-T-AMT).
	      DISPLAY HOLD-PRF HOLD-DIF WITH FRAME POST-A.
	      FIND FIRST ACCT-RCV WHERE ACCT-RCV.COMP# = XCOM AND
					ACCT-RCV.DIV# = XDIV AND
					ACCT-RCV.CUST# = XCST.
	      UPDATE ACCT-RCV.LP-DATE = P-DATE.
	      UPDATE ACCT-RCV.TOT-BAL = ACCT-RCV.TOT-BAL + HOLDX-T-AMT.
	      UPDATE ACCT-RCV.BAL-1 = ACCT-RCV.BAL-1 + HOLDX-T-AMT.
	      RELEASE ACCT-RCV.
	      HIDE FRAME POST-D NO-PAUSE.
	      CLEAR FRAME POST-D ALL NO-PAUSE.
	      NEXT PAR8.
	  END.
	  IF HOLD-T-TYPE = "L"
	    THEN DO:
	      UPDATE HOLD-PRF = HOLD-PRF - HOLDX-T-AMT.
	      UPDATE HOLD-DIF = HOLD-DIF + (HOLD-T-AMT - HOLDX-T-AMT).
	      DISPLAY HOLD-PRF HOLD-DIF WITH FRAME POST-A.
	      FIND FIRST ACCT-RCV WHERE ACCT-RCV.COMP# = XCOM AND
					ACCT-RCV.DIV# = XDIV AND
					ACCT-RCV.CUST# = XCST.
	      UPDATE ACCT-RCV.LP-DATE = P-DATE.
	      UPDATE ACCT-RCV.TOT-BAL = ACCT-RCV.TOT-BAL + HOLDX-T-AMT.
	      UPDATE ACCT-RCV.BAL-1 = ACCT-RCV.BAL-1 + HOLDX-T-AMT.
	      RELEASE ACCT-RCV.
	      HIDE FRAME POST-D NO-PAUSE.
	      CLEAR FRAME POST-D ALL NO-PAUSE.
	      NEXT PAR8.
	  END.
	  IF HOLD-T-TYPE = "N"
	    THEN DO:
	      CREATE TRANFILE.
	      TRANFILE.AGE = HOLD-AGE.
	      TRANFILE.CHECK# = HOLD-CHECK.
	      TRANFILE.COMP# = XCOM.
	      TRANFILE.CUST# = XCST.
	      TRANFILE.DIV# = XDIV.
	      TRANFILE.INV-NO = HOLD-INV-NO.
	      TRANFILE.PERIOD = P-PERIOD.
	      TRANFILE.REFER = HOLDX-REFER.
	      TRANFILE.SLS# = HOLD-SLS#.
	      TRANFILE.T-AMT = HOLDX-T-AMT.
	      TRANFILE.T-DATE = P-DATE.
	      TRANFILE.T-OPR = HOLD-T-OPR.
	      TRANFILE.T-TYPE = "P".
	      TRANFILE.TR-STAT = "I".
	      UPDATE HOLDX-REC# = 9999.
	      UPDATE TRANFILE.REC# = HOLDX-REC#.
	      RELEASE TRANFILE.
	      UPDATE HOLD-PRF = HOLD-PRF + HOLDX-T-AMT.
	      UPDATE HOLD-DIF = HOLD-DIF + (HOLD-T-AMT - HOLDX-T-AMT).
	      DISPLAY HOLD-PRF HOLD-DIF WITH FRAME POST-A.
	      FIND FIRST ACCT-RCV WHERE ACCT-RCV.COMP# = XCOM AND
					ACCT-RCV.DIV# = XDIV AND
					ACCT-RCV.CUST# = XCST.
	      UPDATE ACCT-RCV.SRVC-DUE = ACCT-RCV.SRVC-DUE - HOLDX-T-AMT.
	      UPDATE ACCT-RCV.TOT-BAL = ACCT-RCV.TOT-BAL - HOLDX-T-AMT.
	      RELEASE ACCT-RCV.
	      HIDE FRAME POST-D NO-PAUSE.
	      CLEAR FRAME POST-D ALL NO-PAUSE.
	      NEXT PAR8.
	  END.
	  END.
      END.
      END.
      IF LASTKEY = KEYCODE("F5") THEN
      IF HOLD-AMT <> HOLD-PRF THEN DO:
	  BELL.
	  BELL.
	  MESSAGE "WARNING: CHECK AMOUNT AND PROOF AMOUNT DO NOT AGREE".
	  PAUSE.
      END.
      IF LASTKEY = KEYCODE("F5") THEN
      IF HOLD-DIF <> 0.0 THEN DO:
	  BELL.
	  BELL.
	  MESSAGE "A DIFFERENCE OF " HOLD-DIF " EXISTS".
	  MESSAGE
	  "PLEASE DISTRIBUTE IT TO PROPER ACCOUNT TYPE".
	      CREATE TRANFILE.
	      TRANFILE.AGE = HOLD-AGE.
	      TRANFILE.CHECK# = HOLD-CHECK.
	      TRANFILE.COMP# = XCOM.
	      TRANFILE.CUST# = XCST.
	      TRANFILE.DIV# = XDIV.
	      TRANFILE.PERIOD = P-PERIOD.
	      TRANFILE.SLS# = HOLD-SLS#.
	      TRANFILE.T-AMT = HOLD-DIF.
	      TRANFILE.T-OPR = HOLD-T-OPR.
	      TRANFILE.TR-STAT = "A".
	      UPDATE HOLDX-REC# = 9999.
	      UPDATE TRANFILE.REC# = HOLDX-REC#.
	      UPDATE TRANFILE.T-TYPE TRANFILE.INV-NO TRANFILE.T-DATE
		     TRANFILE.REFER WITH FRAME POST-E.
	      IF TRANFILE.T-TYPE = "C" OR TRANFILE.T-TYPE = "K" OR
		 TRANFILE.T-TYPE = "L" THEN
		 TRANFILE.TR-STAT = "I".
	      RELEASE TRANFILE.
	      FIND FIRST ACCT-RCV WHERE ACCT-RCV.COMP# = XCOM AND
					ACCT-RCV.DIV# = XDIV AND
					ACCT-RCV.CUST# = XCST.
	      UPDATE ACCT-RCV.LP-DATE = P-DATE.
	      UPDATE ACCT-RCV.TOT-BAL = ACCT-RCV.TOT-BAL - HOLDX-T-AMT.
	      UPDATE ACCT-RCV.BAL-1 = ACCT-RCV.BAL-1 - HOLDX-T-AMT.
	      RELEASE ACCT-RCV.
	      HIDE FRAME POST-C NO-PAUSE.
	      HIDE FRAME POST-D NO-PAUSE.
	      HIDE FRAME POST-E NO-PAUSE.
	      CLEAR FRAME POST-C ALL NO-PAUSE.
	      CLEAR FRAME POST-D ALL NO-PAUSE.
	      CLEAR FRAME POST-E ALL NO-PAUSE.
	      NEXT PAR0.
	     END.
	    ELSE NEXT PAR0.
   IF YYY > 10 THEN DO:
      IF LASTKEY = KEYCODE("CURSOR-DOWN") AND FRAME-LINE(POST-C) = 10
      THEN DO:
      IF FRAME-LINE(POST-C) > YYY THEN NEXT PAR8.
	  FIND NEXT TRANFILE WHERE TRANFILE.COMP# = XCOM AND
				   TRANFILE.DIV# = XDIV AND
				   TRANFILE.CUST# = XCST AND
				   TRANFILE.TR-STAT = "A" AND
				   TRANFILE.REC# > INTEGER(FRAME-VALUE)
				   NO-ERROR.
	  IF NOT AVAILABLE TRANFILE THEN NEXT PAR8.
	  SCROLL UP WITH FRAME POST-C.
	  DISPLAY TRANFILE.REC# TRANFILE.T-AMT TRANFILE.INV-NO
	  TRANFILE.T-TYPE TRANFILE.TR-STAT TRANFILE.T-DATE TRANFILE.REFER
	  WITH FRAME POST-C.
	  NEXT PAR8.
      END.
      IF LASTKEY = KEYCODE("CURSOR-UP") AND FRAME-LINE(POST-C) = 1
      THEN DO:
      IF FRAME-LINE > YYY THEN NEXT PAR8.
	  FIND PREV TRANFILE WHERE TRANFILE.COMP# = XCOM AND
				   TRANFILE.DIV# = XDIV AND
				   TRANFILE.CUST# = XCST AND
				   TRANFILE.TR-STAT = "A" AND
				   TRANFILE.REC# < INTEGER(FRAME-VALUE)
				   NO-ERROR.
	  IF NOT AVAILABLE TRANFILE THEN NEXT PAR8.
	  SCROLL DOWN WITH FRAME POST-C.
	  DISPLAY TRANFILE.REC# TRANFILE.T-AMT TRANFILE.INV-NO
	  TRANFILE.T-TYPE TRANFILE.TR-STAT TRANFILE.T-DATE TRANFILE.REFER
	  WITH FRAME POST-C.
	  NEXT PAR8.
      END.
    END.
 END.
 END.
 FIND FIRST TRANFILE WHERE TRANFILE.REC# = 9999 NO-ERROR.
 IF NOT AVAILABLE TRANFILE THEN LEAVE.
 ELSE DO:
 OUTPUT TO PRINTER.
 ADJ-TOT = 0.0.
 CHK-TOT = 0.0.
 FOR EACH TRANFILE WHERE TRANFILE.COMP# = XCOM AND
					 TRANFILE.DIV# = XDIV AND
					 TRANFILE.REC# = 9999:
	FORM HEADER TODAY FORMAT "99/99/9999"
		    "A/R CASH RECEIPTS JOURNAL" AT 28
		    "PAGE:" AT 65 PAGE-NUMBER FORMAT ">>9" SKIP(0)
		    "COMPANY: " AT 20 XCOM-N
		    "TIME: " AT 65 STRING(TIME,"HH:MM:SS") SKIP(0)
		    "DIVISION: " AT 20 XDIV-N "OPER: " AT 65 XOPR SKIP(0)
		    "ACCOUNTING PERIOD: " P-PERIOD FORMAT "XX-XXXX" SKIP(0)
		    "--------------------------------------------------------------------------------" SKIP(0)
		    "   ACCOUNT     NAME                                 CHECK #          AMOUNT     " SKIP(0)
		    "    DATE    REFERENCE       INVOICE #     SLS #    AGE
       TYPE           " SKIP(0) WITH NO-BOX.
		    FIND ACCT-RCV WHERE ACCT-RCV.CUST# = TRANFILE.CUST# AND
			ACCT-RCV.COMP# = XCOM AND ACCT-RCV.DIV# = XDIV NO-ERROR.
		    IF NOT AVAILABLE ACCT-RCV THEN LEAVE.
      IF TRANFILE.T-TYPE = "C" OR
	 TRANFILE.T-TYPE = "K" OR
	 TRANFILE.T-TYPE = "L" THEN ADJ-TOT = ADJ-TOT + TRANFILE.T-AMT.
      IF TRANFILE.T-TYPE = "B" THEN CHK-TOT = CHK-TOT + TRANFILE.T-AMT.
		    DISPLAY TRANFILE.CUST#
			    ACCT-RCV.C-NAME AT 16
			    TRANFILE.CHECK# AT 45
			    TRANFILE.T-AMT AT 63 WITH NO-LABELS.
		    DISPLAY TRANFILE.T-DATE
			    TRANFILE.REFER AT 13
			    TRANFILE.INV-NO AT 29
			    TRANFILE.SLS# AT 44
			    TRANFILE.AGE AT 53
			    TRANFILE.T-TYPE AT 63
					  SKIP(0) "--------------------------------------------------------------------------------"
WITH NO-LABELS.
END.
END.
    DISPLAY SKIP(2) "CHECK  TOTALS: " CHK-TOT SKIP(0)
		    "ADJUST TOTALS: " ADJ-TOT WITH NO-LABELS NO-BOX.
    FOR EACH TRANFILE WHERE TRANFILE.COMP# = XCOM AND
					    TRANFILE.DIV# = XDIV AND
					    TRANFILE.REC# > 0:
    UPDATE TRANFILE.REC# = 0.
    END.
