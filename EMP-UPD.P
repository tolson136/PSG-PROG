DEF VAR COUNTER AS INTEGER FORMAT "ZZ".
DEF VAR OLDCHOICE AS CHAR.
DEF VAR BS AS CHAR.
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
FORM EMP-NAME.E-NUM SPACE(2) EMP-NAME.E-NAME SPACE(2)
     EMP-NAME.COMP# SPACE(2) EMP-NAME.DIV#
     WITH FRAME EMP-FRAME SCROLL 1 15 DOWN NO-BOX NO-LABELS.
DISPLAY "NUMB" SPACE(7) "EMP NAME" SPACE(14) "CO" SPACE(2) "DV" SKIP(2)
     WITH FRAME A NO-BOX NO-LABELS.
FIND FIRST EMP-NAME.
REPEAT COUNTER = 1 TO 15:
  DISPLAY EMP-NAME.E-NUM EMP-NAME.E-NAME
  EMP-NAME.COMP# EMP-NAME.DIV# WITH FRAME EMP-FRAME.
  DOWN WITH FRAME EMP-FRAME.
  FIND NEXT EMP-NAME NO-ERROR.
  IF NOT AVAILABLE EMP-NAME THEN LEAVE.
END.

UP FRAME-LINE(EMP-FRAME) - 1 WITH FRAME EMP-FRAME.

PAR0: REPEAT:
  STATUS DEFAULT
    "Use up and down arrows. Enter C to chng, D to del, A to add".
  CHOOSE ROW EMP-NAME.E-NUM NO-ERROR WITH FRAME EMP-FRAME.
  COLOR DISPLAY NORMAL EMP-NAME.E-NUM WITH FRAME EMP-FRAME.

IF LASTKEY = KEYCODE("CURSOR-DOWN") THEN DO:
  FIND NEXT EMP-NAME WHERE E-NUM >= FRAME-VALUE AND
			   EMP-NAME.DIV# > 0 AND
			   EMP-NAME.COMP# > 0 NO-ERROR.
  IF NOT AVAILABLE EMP-NAME THEN NEXT PAR0.
  SCROLL UP WITH FRAME EMP-FRAME.
  DISPLAY EMP-NAME.E-NUM EMP-NAME.E-NAME
  EMP-NAME.COMP# EMP-NAME.DIV# WITH FRAME EMP-FRAME.
  NEXT PAR0.
END.


IF LASTKEY = KEYCODE("CURSOR-UP") THEN DO:
  FIND PREV EMP-NAME WHERE E-NUM <= FRAME-VALUE AND
			   EMP-NAME.DIV# > 0 AND
			   EMP-NAME.COMP# > 0 NO-ERROR.
  IF NOT AVAILABLE EMP-NAME THEN NEXT PAR0.
  SCROLL DOWN WITH FRAME EMP-FRAME.
  DISPLAY EMP-NAME.E-NUM EMP-NAME.E-NAME
  EMP-NAME.COMP# EMP-NAME.DIV# WITH FRAME EMP-FRAME.
  NEXT PAR0.
END.

IF LASTKEY = KEYCODE("A") OR LASTKEY = KEYCODE("a")
THEN DO:
  SCROLL FROM-CURRENT DOWN WITH FRAME EMP-FRAME.
  CREATE EMP-NAME.
  UPDATE EMP-NAME.E-NUM EMP-NAME.E-NAME
  EMP-NAME.COMP# EMP-NAME.DIV# WITH FRAME EMP-FRAME.
  NEXT PAR0.
END.

IF LASTKEY = KEYCODE("C") OR LASTKEY = KEYCODE("c")
THEN DO:
  FIND FIRST EMP-NAME WHERE EMP-NAME.E-NUM = FRAME-VALUE AND
			    EMP-NAME.DIV# > 0 AND
			    EMP-NAME.COMP# > 0.
  UPDATE EMP-NAME.E-NUM EMP-NAME.E-NAME
  EMP-NAME.COMP# EMP-NAME.DIV# WITH FRAME EMP-FRAME.
  NEXT PAR0.
END.

IF LASTKEY = KEYCODE("D") OR LASTKEY = KEYCODE("d")
THEN DO:
  FIND FIRST EMP-NAME WHERE EMP-NAME.E-NUM = FRAME-VALUE AND
			    EMP-NAME.DIV# > 0 AND
			    EMP-NAME.COMP# > 0.
  BS = FRAME-VALUE.
  DELETE EMP-NAME.
  REPEAT COUNTER = 1 TO 15 WHILE FRAME-LINE(EMP-FRAME)
			      <= FRAME-DOWN(EMP-FRAME):
  FIND NEXT EMP-NAME WHERE E-NUM > BS AND
			   EMP-NAME.DIV# > 0 AND
			   EMP-NAME.COMP# > 0 NO-ERROR.
  IF AVAILABLE EMP-NAME THEN
  DISPLAY EMP-NAME.E-NUM EMP-NAME.E-NAME
  EMP-NAME.COMP# EMP-NAME.DIV# WITH FRAME EMP-FRAME.
  ELSE CLEAR FRAME EMP-FRAME NO-PAUSE.
  BS = FRAME-VALUE.
  DOWN WITH FRAME EMP-FRAME.
  END.
  UP COUNTER - 1 WITH FRAME EMP-FRAME.
END.
END.
STATUS DEFAULT.
