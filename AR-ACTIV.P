DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE VARIABLE BEG# AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEFINE VARIABLE END# AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEFINE VARIABLE B-DATE AS DATE FORMAT "99/99/9999".
DEFINE VARIABLE E-DATE AS DATE FORMAT "99/99/9999".
DEFINE VARIABLE A-TRAN AS LOGICAL.
DEFINE VARIABLE B-TRAN AS LOGICAL.
DEFINE VARIABLE C-TRAN AS LOGICAL.
DEFINE VARIABLE D-TRAN AS LOGICAL.
DEFINE VARIABLE E-TRAN AS LOGICAL.
DEFINE VARIABLE F-TRAN AS LOGICAL.
DEFINE VARIABLE G-TRAN AS LOGICAL.
DEFINE VARIABLE H-TRAN AS LOGICAL.
/* DEFINE VARIABLE I-TRAN AS LOGICAL. */
DEFINE VARIABLE J-TRAN AS LOGICAL.
DEFINE VARIABLE K-TRAN AS LOGICAL.
DEFINE VARIABLE L-TRAN AS LOGICAL.
DEFINE VARIABLE M-TRAN AS LOGICAL.
DEFINE VARIABLE N-TRAN AS LOGICAL.
DEFINE VARIABLE O-TRAN AS LOGICAL.
DEFINE VARIABLE P-TRAN AS LOGICAL.
DEFINE VARIABLE Z-TRAN AS LOGICAL.
DEFINE VARIABLE ACTIVE AS LOGICAL.
DEFINE VARIABLE INACTIVE AS LOGICAL.
DEFINE VARIABLE A-CHAR AS CHARACTER FORMAT "X".
DEFINE VARIABLE B-CHAR AS CHAR FORMAT "X".
DEFINE VARIABLE C-CHAR AS CHAR FORMAT "X".
DEFINE VARIABLE D-CHAR AS CHAR FORMAT "X".
DEFINE VARIABLE E-CHAR AS CHAR FORMAT "X".
DEFINE VARIABLE F-CHAR AS CHAR FORMAT "X".
DEFINE VARIABLE G-CHAR AS CHAR FORMAT "X".
DEFINE VARIABLE H-CHAR AS CHAR FORMAT "X".
/* DEFINE VARIABLE I-CHAR AS CHAR FORMAT "X". */
DEFINE VARIABLE J-CHAR AS CHAR FORMAT "X".
DEFINE VARIABLE K-CHAR AS CHAR FORMAT "X".
DEFINE VARIABLE L-CHAR AS CHAR FORMAT "X".
DEFINE VARIABLE M-CHAR AS CHAR FORMAT "X".
DEFINE VARIABLE N-CHAR AS CHAR FORMAT "X".
DEFINE VARIABLE O-CHAR AS CHAR FORMAT "X".
DEFINE VARIABLE P-CHAR AS CHAR FORMAT "X".
DEFINE VARIABLE A-HOLD AS CHAR FORMAT "X".
DEFINE VARIABLE I-HOLD AS CHAR FORMAT "X".
DEFINE VARIABLE HC-AMT AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEFINE VARIABLE HD-AMT AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEFINE VARIABLE H-AMT AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEFINE VARIABLE XCTR AS INTEGER FORMAT "999".
DEFINE VARIABLE RPTDATE AS DATE.
DEFINE SHARED VARIABLE XCOM-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XDIV-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XOPR AS CHAR FORMAT "XXX".
DEFINE VARIABLE AMT-A AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEFINE VARIABLE AMT-B AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEFINE VARIABLE AMT-C AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEFINE VARIABLE AMT-D AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEFINE VARIABLE AMT-E AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEFINE VARIABLE AMT-F AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEFINE VARIABLE AMT-G AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEFINE VARIABLE AMT-H AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
/* DEFINE VARIABLE AMT-I AS DECIMAL FORMAT "$->>>,>>>,>>>.99". */
DEFINE VARIABLE AMT-J AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEFINE VARIABLE AMT-K AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEFINE VARIABLE AMT-L AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEFINE VARIABLE AMT-M AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEFINE VARIABLE AMT-N AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEFINE VARIABLE AMT-O AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
DEFINE VARIABLE AMT-P AS DECIMAL FORMAT "$->>>,>>>,>>>.99".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
XCTR = 0.
A-TRAN = no.
B-TRAN = no.
C-TRAN = no.
D-TRAN = no.
E-TRAN = no.
F-TRAN = no.
G-TRAN = no.
H-TRAN = no.
/* I-TRAN = no. */
J-TRAN = no.
K-TRAN = no.
L-TRAN = no.
M-TRAN = no.
N-TRAN = no.
O-TRAN = no.
P-TRAN = no.
Z-TRAN = no.
ACTIVE = no.
INACTIVE = no.
FORM SPACE(11)
    "A/R   A L L   A C T I V I T Y   R E P O R T   S C R E E N"
    SKIP(1)
    BEG# "BEGINNING CUSTOMER NUMBER"
    SPACE(4) "INCLUDE WHICH TRANSACTIONS" SKIP(0)
    END# "ENDING CUSTOMER NUMBER   " SPACE(4) A-TRAN "INVOICE" SKIP(0)
    B-DATE "BEGINNING DATE OF TRANS  " SPACE(4) B-TRAN "CREDIT" SKIP(0)
    E-DATE "ENDING DATE OF TRANS     " SPACE(4) C-TRAN "CREDIT MEMO" SKIP(0)
    SPACE(40) D-TRAN "SERVICE CHARGE" SKIP(0)
    SPACE(40) E-TRAN "REVERSE SERVICE CHARGE" SKIP(0)
    SPACE(40) F-TRAN "SERVICE CHARGE PAYMENT" SKIP(0)
    SPACE(40) G-TRAN "CASH SALE" SKIP(0)
    SPACE(40) H-TRAN "REVERSE INVOICE" SKIP(0)
    SPACE(40) J-TRAN "REVERSE CREDIT MEMO" SKIP(0)
    SPACE(40) K-TRAN "BAD DEBT" SKIP(0)
    SPACE(40) L-TRAN "CUSTOMER DAMAGE" SKIP(0)
    SPACE(40) M-TRAN "REVERSE PAYMENT" SKIP(0)
    SPACE(40) N-TRAN "FUEL SURCHARGE" SKIP(0)
    SPACE(40) O-TRAN "REVERSE FUEL SURCHARGE" SKIP(0)
    SPACE(40) P-TRAN "FUEL SURCHARGE PAYMENT" SKIP(0)
    SPACE(40) "INCLUDE ACTIVE/INACTIVE TRANSACTIONS" SKIP(0)
    SPACE(40) ACTIVE "INCLUDE ACTIVE TRANSACTIONS ?" SKIP(0)
    SPACE(40) INACTIVE
    "INCLUDE INACTIVE TRANSACTIONS ?" SKIP(0)
    SPACE(40) Z-TRAN "INCLUDE ZERO BALANCE ACCOUNTS ?" WITH FRAME A NO-BOX.
REPEAT:
UPDATE BEG# END# B-DATE E-DATE A-TRAN B-TRAN C-TRAN D-TRAN E-TRAN F-TRAN
    G-TRAN H-TRAN J-TRAN K-TRAN L-TRAN M-TRAN N-TRAN O-TRAN P-TRAN
    ACTIVE INACTIVE Z-TRAN
    WITH FRAME A NO-LABELS COLOR DISPLAY NORMAL PROMPT W/MA.
    IF A-TRAN THEN A-CHAR = "A".
    IF B-TRAN THEN B-CHAR = "B".
    IF C-TRAN THEN C-CHAR = "C".
    IF D-TRAN THEN D-CHAR = "D".
    IF E-TRAN THEN E-CHAR = "E".
    IF F-TRAN THEN F-CHAR = "F".
    IF G-TRAN THEN G-CHAR = "G".
    IF H-TRAN THEN H-CHAR = "H".
    /* IF I-TRAN THEN I-CHAR = "I". */
    IF J-TRAN THEN J-CHAR = "J".
    IF K-TRAN THEN K-CHAR = "K".
    IF L-TRAN THEN L-CHAR = "L".
    IF M-TRAN THEN M-CHAR = "M".
    IF N-TRAN THEN D-CHAR = "N".
    IF O-TRAN THEN E-CHAR = "O".
    IF P-TRAN THEN F-CHAR = "P".
    IF ACTIVE THEN A-HOLD = "A".
    IF INACTIVE THEN I-HOLD = "I".
    IF LASTKEY = KEYCODE("F1") THEN LEAVE.
END.
OUTPUT TO PRINTER.
  H-AMT = 0.0.
  HC-AMT = 0.0.
  HD-AMT = 0.0.
     FOR EACH ACCT-RCV WHERE ACCT-RCV.COMP# = XCOM AND
			     ACCT-RCV.DIV# = XDIV AND
			     ACCT-RCV.CUST# >= BEG# AND
			     ACCT-RCV.CUST <= END#:
     IF Z-TRAN = no AND ACCT-RCV.TOT-BAL = 0.0 THEN NEXT.
     FIND FIRST TRANFILE WHERE TRANFILE.COMP# = ACCT-RCV.COMP# AND
			     TRANFILE.DIV# = ACCT-RCV.DIV# AND
			     TRANFILE.CUST# = ACCT-RCV.CUST# AND
			     TRANFILE.T-DATE >= B-DATE AND
			     TRANFILE.T-DATE <= E-DATE AND
			     (TRANFILE.T-TYPE = A-CHAR OR
			     TRANFILE.T-TYPE = B-CHAR OR
			     TRANFILE.T-TYPE = C-CHAR OR
			     TRANFILE.T-TYPE = D-CHAR OR
			     TRANFILE.T-TYPE = E-CHAR OR
			     TRANFILE.T-TYPE = F-CHAR OR
			     TRANFILE.T-TYPE = G-CHAR OR
			     TRANFILE.T-TYPE = H-CHAR OR
			     TRANFILE.T-TYPE = J-CHAR OR
			     TRANFILE.T-TYPE = K-CHAR OR
			     TRANFILE.T-TYPE = L-CHAR OR
			     TRANFILE.T-TYPE = M-CHAR OR
			     TRANFILE.T-TYPE = N-CHAR OR
			     TRANFILE.T-TYPE = O-CHAR OR
			     TRANFILE.T-TYPE = P-CHAR) AND
			     (TRANFILE.TR-STAT = A-HOLD OR
			     TRANFILE.TR-STAT = I-HOLD) NO-ERROR.
	   IF NOT AVAILABLE TRANFILE THEN NEXT.
    FORM HEADER TODAY FORMAT "99/99/9999"
      "CUSTOMER ALL ACTIVITY REPORT" AT 25
      "PAGE: " AT 65 PAGE-NUMBER FORMAT ">>9" SKIP(0)
      "FROM: " B-DATE "COMPANY :" AT 25 XCOM-N SKIP(0)
      "TO  : " E-DATE "DIVISION:" AT 25 XDIV-N "OPER:" AT 65 XOPR SKIP(0)
"--------------------------------------------------------------------------------" SKIP(0) "DATE" AT 3 "REFERENCE" AT 12 "INVOICE NO" AT 27 "S" AT 39
	    "T" AT 42 "DEBIT" AT 53 "CREDIT" AT 70 SKIP(0)
"--------------------------------------------------------------------------------" SKIP(1)
      WITH FRAME X PAGE-TOP NO-BOX NO-LABEL NO-UNDERLINE.
      VIEW FRAME X.
     DISPLAY
	      SKIP(1) "** " ACCT-RCV.CUST# " **"
	      ACCT-RCV.C-NAME
	      "BALANCE"
	      ACCT-RCV.TOT-BAL WITH NO-BOX NO-LABEL.
     FOR EACH TRANFILE OF ACCT-RCV
		       WHERE TRANFILE.T-DATE >= B-DATE AND
			     TRANFILE.T-DATE <= E-DATE AND
			     (TRANFILE.T-TYPE = A-CHAR OR
			     TRANFILE.T-TYPE = B-CHAR OR
			     TRANFILE.T-TYPE = C-CHAR OR
			     TRANFILE.T-TYPE = D-CHAR OR
			     TRANFILE.T-TYPE = E-CHAR OR
			     TRANFILE.T-TYPE = F-CHAR OR
			     TRANFILE.T-TYPE = G-CHAR OR
			     TRANFILE.T-TYPE = H-CHAR OR
			     TRANFILE.T-TYPE = J-CHAR OR
			     TRANFILE.T-TYPE = K-CHAR OR
			     TRANFILE.T-TYPE = L-CHAR OR
			     TRANFILE.T-TYPE = M-CHAR OR
			     TRANFILE.T-TYPE = N-CHAR OR
			     TRANFILE.T-TYPE = O-CHAR OR
			     TRANFILE.T-TYPE = P-CHAR) AND
			     (TRANFILE.TR-STAT = A-HOLD OR
			     TRANFILE.TR-STAT = I-HOLD)
			     BY TRANFILE.CUST# BY TRANFILE.T-DATE:
	      H-AMT = TRANFILE.T-AMT.
     DISPLAY
	     TRANFILE.T-DATE
	     TRANFILE.REFER
	     TRANFILE.INV-NO SPACE(2)
	     TRANFILE.TR-STAT SPACE(2)
	     TRANFILE.T-TYPE SPACE(2) WITH NO-BOX NO-LABELS.
     IF TRANFILE.T-TYPE = "A" THEN
	AMT-A = AMT-A + TRANFILE.T-AMT.
     IF TRANFILE.T-TYPE = "B" THEN
	AMT-B = AMT-B + TRANFILE.T-AMT.
     IF TRANFILE.T-TYPE = "C" THEN
	AMT-C = AMT-C + TRANFILE.T-AMT.
     IF TRANFILE.T-TYPE = "D" THEN
	AMT-D = AMT-D + TRANFILE.T-AMT.
     IF TRANFILE.T-TYPE = "E" THEN
	AMT-E = AMT-E + TRANFILE.T-AMT.
     IF TRANFILE.T-TYPE = "F" THEN
	AMT-F = AMT-F + TRANFILE.T-AMT.
     IF TRANFILE.T-TYPE = "G" THEN
	AMT-G = AMT-G + TRANFILE.T-AMT.
     IF TRANFILE.T-TYPE = "H" THEN
	AMT-H = AMT-H + TRANFILE.T-AMT.
     /* IF TRANFILE.T-TYPE = "I" THEN
	AMT-I = AMT-I + TRANFILE.T-AMT. */
     IF TRANFILE.T-TYPE = "J" THEN
	AMT-J = AMT-J + TRANFILE.T-AMT.
     IF TRANFILE.T-TYPE = "K" THEN
	AMT-K = AMT-K + TRANFILE.T-AMT.
     IF TRANFILE.T-TYPE = "L" THEN
	AMT-L = AMT-L + TRANFILE.T-AMT.
     IF TRANFILE.T-TYPE = "M" THEN
	AMT-M = AMT-M + TRANFILE.T-AMT.
     IF TRANFILE.T-TYPE = "N" THEN
	AMT-N = AMT-N + TRANFILE.T-AMT.
     IF TRANFILE.T-TYPE = "O" THEN
	AMT-O = AMT-O + TRANFILE.T-AMT.
     IF TRANFILE.T-TYPE = "P" THEN
	AMT-P = AMT-P + TRANFILE.T-AMT.
     IF TRANFILE.T-TYPE = "A" OR TRANFILE.T-TYPE = "D" OR
	TRANFILE.T-TYPE = "G" OR TRANFILE.T-TYPE = "I" OR
	TRANFILE.T-TYPE = "J" OR TRANFILE.T-TYPE = "M" OR
	TRANFILE.T-TYPE = "N"
	THEN DO:
	DISPLAY TRANFILE.T-AMT AT 45.
	HD-AMT = HD-AMT + TRANFILE.T-AMT.
	END.
	ELSE DO:
	DISPLAY H-AMT AT 63.
	HC-AMT = HC-AMT + H-AMT.
	END.
   END.
 END.
 IF HD-AMT <> 0.0 OR HC-AMT <> 0.0 THEN DO:
   DISPLAY SKIP(1) SPACE(35) "TOTALS" WITH NO-BOX NO-LABELS.
   DISPLAY HD-AMT AT 45.
   DISPLAY HC-AMT AT 63 SKIP(1).
 END.
IF AMT-A <> 0.0 THEN
 DISPLAY AMT-A LABEL "INVOICE     " AT 25 WITH NO-BOX SIDE-LABELS.
IF AMT-B <> 0.0 THEN
 DISPLAY AMT-B LABEL "PAYMENT     " AT 25 WITH NO-BOX SIDE-LABELS.
IF AMT-C <> 0.0 THEN
 DISPLAY AMT-C LABEL "CREDIT MEMO " AT 25 WITH NO-BOX SIDE-LABELS.
IF AMT-D <> 0.0 THEN
 DISPLAY AMT-D LABEL "SRVC CHARGE " AT 25 WITH NO-BOX SIDE-LABELS.
IF AMT-E <> 0.0 THEN
 DISPLAY AMT-E LABEL "REV SRVC CHG" AT 25 WITH NO-BOX SIDE-LABELS.
IF AMT-F <> 0.0 THEN
 DISPLAY AMT-F LABEL "SRVC CHG PAY" AT 25 WITH NO-BOX SIDE-LABELS.
IF AMT-G <> 0.0 THEN
 DISPLAY AMT-G LABEL "CASH SALE   " AT 25 WITH NO-BOX SIDE-LABELS.
IF AMT-H <> 0.0 THEN
 DISPLAY AMT-H LABEL "REV INVOICE " AT 25 WITH NO-BOX SIDE-LABELS.
/* IF AMT-I <> 0.0 THEN
 DISPLAY AMT-I LABEL "REV CREDIT  " AT 25 WITH NO-BOX SIDE-LABELS. */
IF AMT-J <> 0.0 THEN
 DISPLAY AMT-J LABEL "REV CR MEMO " AT 25 WITH NO-BOX SIDE-LABELS.
IF AMT-K <> 0.0 THEN
 DISPLAY AMT-K LABEL "BAD DEBT    " AT 25 WITH NO-BOX SIDE-LABELS.
IF AMT-L <> 0.0 THEN
 DISPLAY AMT-L LABEL "CUST DAMAGE " AT 25 WITH NO-BOX SIDE-LABELS.
IF AMT-M <> 0.0 THEN
 DISPLAY AMT-M LABEL "REV PAYMENT " AT 25 WITH NO-BOX SIDE-LABELS.
IF AMT-N <> 0.0 THEN
 DISPLAY AMT-N LABEL "FUEL SURCHRG" AT 25 WITH NO-BOX SIDE-LABELS.
IF AMT-O <> 0.0 THEN
 DISPLAY AMT-O LABEL "REV FUEL CHG" AT 25 WITH NO-BOX SIDE-LABELS.
IF AMT-P <> 0.0 THEN
 DISPLAY AMT-P LABEL "FUEL CHG PAY" AT 25 WITH NO-BOX SIDE-LABELS.
