DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE VAR BDATE AS DATE FORMAT "99/99/9999".
DEFINE VAR EDATE AS DATE FORMAT "99/99/9999".
DEFINE VAR NMO AS INTEGER FORMAT "ZZ".
IF (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
DISPLAY SPACE(7)
"O U T S T A N D I N G   C U R R E N T   T I C K E T   R E P O R T"
SKIP(2) WITH NO-BOX SIDE-LABELS.
/* UPDATE BDATE LABEL "ENTER STARTING DATE RANGE" WITH NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
UPDATE EDATE LABEL "ENTER ENDING DATE RANGE  " WITH NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE. */
UPDATE SKIP(1) NMO LABEL "ENTER MONTH YOU WISH TO REPORT ON"
   WITH NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
OUTPUT TO PRINTER.
FOR EACH TICKET WHERE TICKET.COMP# = XCOM AND
		      TICKET.DIV# = XDIV AND
		      TICKET.T-STAT = "P" AND
		      TICKET.MONTH# = NMO
				    BY TICKET.CUST#
				    BY TICKET.PROPSL#
				    BY TICKET.ITEM#
				    BY TICKET.MONTH#
				    BY TICKET.T-INDX:
    FORM HEADER TODAY FORMAT "99/99/9999"
	 "OUTSTANDING CURRENT TICKET REPORT" AT 24 SKIP(1)
	 "COMPANY" AT 20 TICKET.COMP# "DIVISION" AT 50 TICKET.DIV# SKIP(1)
	 "FROM:" AT 20 BDATE "TO:" AT 40 EDATE SKIP(1).
FIND FIRST ACCT-RCV WHERE ACCT-RCV.COMP# = TICKET.COMP# AND
		    ACCT-RCV.DIV# = TICKET.DIV# AND
		    ACCT-RCV.CUST# = TICKET.CUST# AND
		    ACCT-RCV.C-STATUS <> "I".
IF NOT AVAILABLE ACCT-RCV THEN NEXT.
DISPLAY ACCT-RCV.C-NAME TICKET.FREQ TICKET.DATE-PRT TICKET.T-STAT
	SKIP(0) SPACE(25)
	TICKET.COMP# TICKET.DIV#
	TICKET.CUST# TICKET.PROPSL# TICKET.ITEM#
	TICKET.MONTH# TICKET.T-INDX SKIP(0).
END.
