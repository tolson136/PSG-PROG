DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XCOM-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XDIV-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XOPR AS CHAR FORMAT "XXX".
DEF SHARED VAR XPROG AS LOGICAL.
DEFINE NEW SHARED VARIABLE BEG# AS INTEGER FORMAT "ZZ"
  LABEL "ENTER MONTH & YEAR FOR WHICH YOU WANT TO RUN TICKETS".
DEF VAR JAN AS LOGICAL LABEL "PROCESS JANITORIAL TICKETS ?".
DEFINE NEW SHARED VARIABLE D2 AS DECIMAL FORMAT "9999.99".
DEFINE NEW SHARED VARIABLE D3 AS DECIMAL FORMAT "9999".
DEFINE NEW SHARED VARIABLE D4 AS DECIMAL FORMAT "9999.99".
DEFINE NEW SHARED VARIABLE D5 AS INTEGER FORMAT "9999" LABEL "YEAR (4 DIGITS)".
DEFINE NEW SHARED VARIABLE L-YEAR AS LOGICAL.
DEFINE NEW SHARED VARIABLE DY AS INTEGER FORMAT "99".
DEFINE NEW SHARED VARIABLE UP-LIM AS INTEGER FORMAT "99".
DEFINE NEW SHARED VARIABLE F-CUST AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "CUSTOMER NUMBER".
DEFINE NEW SHARED VARIABLE F-PROP AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "PROPOSAL NUMBER".
DEFINE NEW SHARED VARIABLE F-ITEM AS INTEGER FORMAT "ZZZZ"
    LABEL "ITEM NUMBER".
DEFINE NEW SHARED VARIABLE F-INDEX AS INTEGER FORMAT "ZZ"
    LABEL "TICK INDEX".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
REPEAT:
OUTPUT TO TERMINAL.
DISPLAY SPACE(11)
"S I N G L E   T I C K E T   R E Q U E S T   S C R E E N"
    SKIP(1) SPACE(20)
XCOM-N LABEL "COMPANY" SKIP(0) SPACE(20)
XDIV-N LABEL "DIVISION" SKIP(0) SPACE(20)
XOPR LABEL "OPERATOR"
SKIP(5) WITH FRAME A NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") THEN LEAVE.
IF LASTKEY = KEYCODE("ESC") THEN LEAVE.
REPEAT:
IF LASTKEY = KEYCODE("F4") THEN LEAVE.
IF LASTKEY = KEYCODE("ESC") THEN LEAVE.
UPDATE BEG# D5 SKIP(1) JAN WITH FRAME A NO-BOX SIDE-LABELS.
UPDATE SKIP(1) F-CUST F-PROP SKIP(0)
	       F-ITEM F-INDEX WITH FRAME A NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") THEN LEAVE.
IF LASTKEY = KEYCODE("ESC") THEN LEAVE.
IF BEG# = 2 THEN DO:
    D2 = D5 / 4.
    D3 = TRUNCATE(D2, 0).
    D4 = D3.
    IF D4 = D2 THEN L-YEAR = yes.
END.
IF BEG# = 1 THEN UP-LIM = 31.
IF BEG# = 2 AND L-YEAR THEN UP-LIM = 29.
IF BEG# = 2 AND NOT L-YEAR THEN UP-LIM = 28.
IF BEG# = 3 THEN UP-LIM = 31.
IF BEG# = 4 THEN UP-LIM = 30.
IF BEG# = 5 THEN UP-LIM = 31.
IF BEG# = 6 THEN UP-LIM = 30.
IF BEG# = 7 THEN UP-LIM = 31.
IF BEG# = 8 THEN UP-LIM = 31.
IF BEG# = 9 THEN UP-LIM = 30.
IF BEG# = 10 THEN UP-LIM = 31.
IF BEG# = 11 THEN UP-LIM = 30.
IF BEG# = 12 THEN UP-LIM = 31.
IF BEG# > 0 AND BEG# < 13 THEN LEAVE.
IF LASTKEY = KEYCODE("F4") THEN LEAVE.
IF LASTKEY = KEYCODE("ESC") THEN LEAVE.
END.
IF LASTKEY = KEYCODE("F4") THEN LEAVE.
IF LASTKEY = KEYCODE("ESC") THEN LEAVE.
IF JAN AND NOT XPROG THEN RUN TK-ADDJ.P.
IF NOT JAN AND NOT XPROG THEN RUN TK-ADDR.P.
IF NOT JAN AND XPROG THEN RUN TK-ADDRP.P.
IF JAN AND XPROG THEN RUN TK-ADDJP.P.
END.
