DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE VARIABLE BEG# AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEFINE VARIABLE END# AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEF VAR SEQ AS CHAR FORMAT "X".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
DISPLAY SPACE(3)
"C O N T R A C T   M A I L I N G   L A B E L   R E Q U E S T   S C R E E N"
SKIP(0)
    "COMPANY: " XCOM SPACE(29) "DIVISION: " XDIV SKIP(4)
	WITH NO-BOX NO-LABELS.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
UPDATE BEG# LABEL "ENTER BEGINNING CONTRACT NUMBER"
    WITH NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
UPDATE SKIP(2) END# LABEL "ENTER ENDING CONTRACT NUMBER   "
    WITH NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
UPDATE SKIP(2) SEQ
    LABEL "INCLUDE TRANSFERRED CUST / NON-TRANSFERRED CUST / BOTH  T/N/B"
	WITH NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
IF SEQ = "T" THEN DO:
    OUTPUT TO PRINTER PAGE-SIZE 0.
    FOR EACH METPRO WHERE METPRO.COMP# = XCOM AND
			  METPRO.DIV# = XDIV AND
			  METPRO.CUST-TRF = yes AND
			  METPRO.PROPSL# >= BEG# AND
			  METPRO.PROPSL# <= END# AND
			  METPRO.MLABEL = yes BY
			  METPRO.C-NAME:
	DISPLAY METPRO.C-NAME WITH FRAME A NO-BOX NO-LABELS.
	IF METPRO.ADDR5 <> "" THEN DO:
	    DISPLAY METPRO.ADDR1 SKIP(0) METPRO.ADDR2 SKIP(0) METPRO.ADDR3
		    SKIP(0) METPRO.ADDR4 SKIP(0) METPRO.ADDR5 + ", " +
		    METPRO.STATE FORMAT "X(29)" METPRO.ZIP SKIP(1)
			WITH FRAME B NO-BOX NO-LABELS.
	    END.
	ELSE
	    IF METPRO.ADDR4 <> "" THEN DO:
		DISPLAY METPRO.ADDR1 SKIP(0) METPRO.ADDR2 SKIP(0) METPRO.ADDR3
			SKIP(0) METPRO.ADDR4 + ", " + METPRO.STATE
			FORMAT "X(29)" METPRO.ZIP SKIP(2)
			    WITH FRAME C NO-BOX NO-LABELS.
		END.
	    ELSE
		IF METPRO.ADDR3 <> "" THEN DO:
		    DISPLAY METPRO.ADDR1 SKIP(0) METPRO.ADDR2 SKIP(0)
			    METPRO.ADDR3 + ", " + METPRO.STATE
			    FORMAT "X(29)" METPRO.ZIP SKIP(3)
				WITH FRAME D NO-BOX NO-LABELS.
		    END.
		ELSE
		    IF METPRO.ADDR2 <> "" THEN DO:
			DISPLAY METPRO.ADDR1 SKIP(0) METPRO.ADDR2 +
				", " + METPRO.STATE FORMAT "X(29)"
				METPRO.ZIP SKIP(4)
				    WITH FRAME E NO-BOX NO-LABELS.
			END.
		    ELSE
			IF METPRO.ADDR1 <> "" THEN DO:
			    DISPLAY METPRO.ADDR1 + ", " + METPRO.STATE
				    FORMAT "X(29)" METPRO.ZIP SKIP(5)
					WITH FRAME F NO-BOX NO-LABELS.
			    END.
			ELSE
			    DISPLAY SKIP(6) WITH FRAME G NO-BOX NO-LABELS.
    END.
END.
IF SEQ = "N" THEN DO:
    OUTPUT TO PRINTER PAGE-SIZE 0.
    FOR EACH METPRO WHERE METPRO.COMP# = XCOM AND
			  METPRO.DIV# = XDIV AND
			  METPRO.CUST-TRF = no AND
			  METPRO.PROPSL# >= BEG# AND
			  METPRO.PROPSL# <= END# AND
			  METPRO.MLABEL = yes BY
			  METPRO.C-NAME:
	DISPLAY METPRO.C-NAME WITH FRAME NA NO-BOX NO-LABELS.
	IF METPRO.ADDR5 <> "" THEN DO:
	    DISPLAY METPRO.ADDR1 SKIP(0) METPRO.ADDR2 SKIP(0) METPRO.ADDR3
		    SKIP(0) METPRO.ADDR4 SKIP(0) METPRO.ADDR5 + ", " +
		    METPRO.STATE FORMAT "X(29)" METPRO.ZIP SKIP(1)
			WITH FRAME NB NO-BOX NO-LABELS.
	    END.
	ELSE
	    IF METPRO.ADDR4 <> "" THEN DO:
		DISPLAY METPRO.ADDR1 SKIP(0) METPRO.ADDR2 SKIP(0) METPRO.ADDR3
			SKIP(0) METPRO.ADDR4 + ", " + METPRO.STATE
			FORMAT "X(29)" METPRO.ZIP SKIP(2)
			    WITH FRAME NC NO-BOX NO-LABELS.
		END.
	    ELSE
		IF METPRO.ADDR3 <> "" THEN DO:
		    DISPLAY METPRO.ADDR1 SKIP(0) METPRO.ADDR2 SKIP(0)
			    METPRO.ADDR3 + ", " + METPRO.STATE
			    FORMAT "X(29)" METPRO.ZIP SKIP(3)
				WITH FRAME ND NO-BOX NO-LABELS.
		    END.
		ELSE
		    IF METPRO.ADDR2 <> "" THEN DO:
			DISPLAY METPRO.ADDR1 SKIP(0) METPRO.ADDR2 +
				", " + METPRO.STATE FORMAT "X(29)"
				METPRO.ZIP SKIP(4)
				    WITH FRAME NE NO-BOX NO-LABELS.
			END.
		    ELSE
			IF METPRO.ADDR1 <> "" THEN DO:
			    DISPLAY METPRO.ADDR1 + ", " + METPRO.STATE
				    FORMAT "X(29)" METPRO.ZIP SKIP(5)
					WITH FRAME NF NO-BOX NO-LABELS.
			    END.
			ELSE
			    DISPLAY SKIP(6) WITH FRAME NG NO-BOX NO-LABELS.
    END.
END.
IF SEQ = "B" THEN DO:
    OUTPUT TO PRINTER PAGE-SIZE 0.
    FOR EACH METPRO WHERE METPRO.COMP# = XCOM AND
			  METPRO.DIV# = XDIV AND
			  METPRO.PROPSL# >= BEG# AND
			  METPRO.PROPSL# <= END# AND
			  METPRO.MLABEL = yes BY
			  METPRO.C-NAME:
	DISPLAY METPRO.C-NAME WITH FRAME BA NO-BOX NO-LABELS.
	IF METPRO.ADDR5 <> "" THEN DO:
	    DISPLAY METPRO.ADDR1 SKIP(0) METPRO.ADDR2 SKIP(0) METPRO.ADDR3
		    SKIP(0) METPRO.ADDR4 SKIP(0) METPRO.ADDR5 + ", " +
		    METPRO.STATE FORMAT "X(29)" METPRO.ZIP SKIP(1)
			WITH FRAME BB NO-BOX NO-LABELS.
	    END.
	ELSE
	    IF METPRO.ADDR4 <> "" THEN DO:
		DISPLAY METPRO.ADDR1 SKIP(0) METPRO.ADDR2 SKIP(0) METPRO.ADDR3
			SKIP(0) METPRO.ADDR4 + ", " + METPRO.STATE
			FORMAT "X(29)" METPRO.ZIP SKIP(2)
			    WITH FRAME BC NO-BOX NO-LABELS.
		END.
	    ELSE
		IF METPRO.ADDR3 <> "" THEN DO:
		    DISPLAY METPRO.ADDR1 SKIP(0) METPRO.ADDR2 SKIP(0)
			    METPRO.ADDR3 + ", " + METPRO.STATE
			    FORMAT "X(29)" METPRO.ZIP SKIP(3)
				WITH FRAME BD NO-BOX NO-LABELS.
		    END.
		ELSE
		    IF METPRO.ADDR2 <> "" THEN DO:
			DISPLAY METPRO.ADDR1 SKIP(0) METPRO.ADDR2 +
				", " + METPRO.STATE FORMAT "X(29)"
				METPRO.ZIP SKIP(4)
				    WITH FRAME BE NO-BOX NO-LABELS.
			END.
		    ELSE
			IF METPRO.ADDR1 <> "" THEN DO:
			    DISPLAY METPRO.ADDR1 + ", " + METPRO.STATE
				    FORMAT "X(29)" METPRO.ZIP SKIP(5)
					WITH FRAME BF NO-BOX NO-LABELS.
			    END.
			ELSE
			    DISPLAY SKIP(6) WITH FRAME BG NO-BOX NO-LABELS.
    END.
END.
