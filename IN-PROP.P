DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XCOM-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XDIV-N AS CHAR FORMAT "X(30)".
DEF VAR FINV AS DECIMAL FORMAT "ZZZZZZZZZZ"
  LABEL "ENTER BEGINNING INVOICE NUMBER".
DEF SHARED VAR XOPR AS CHAR FORMAT "XXX".
DEF VAR XPROP AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEF VAR XITEM AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEF VAR XINV AS DECIMAL FORMAT "$->,>>>,>>>.99".
DEF VAR XDATE AS DATE FORMAT "99/99/9999".
DEF VAR S-TOT AS DECIMAL FORMAT "$->>>,>>>.99".
DEF VAR T-TOT AS DECIMAL FORMAT "->>>,>>>.99".
DEF VAR ARD AS CHAR FORMAT "X(60)".
DEF VAR XMONTH AS CHAR FORMAT "X(9)".
DEF VAR CTR AS INTEGER FORMAT "99".
DEF VAR SALZ AS INTEGER FORMAT "ZZZ".
DEF VAR BEG# AS DATE FORMAT "99/99/9999"
 LABEL "MONTH OF SERVICE DATE OF THESE INVOICES".
DEF VAR BEGG AS INTEGER FORMAT "ZZ".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
S-TOT = 0.0.
T-TOT = 0.0.
REPEAT:
UPDATE SKIP(10) BEG#
  WITH FRAME ZZZ NO-BOX SIDE-LABELS COLOR DISPLAY NORMAL PROMPT W/MA.
UPDATE SKIP(2) SPACE(10) FINV
  WITH FRAME ZZZ NO-BOX SIDE-LABELS COLOR DISPLAY NORMAL PROMPT W/MA.
  BEGG = MONTH(BEG#).
IF BEGG > 0 AND BEGG < 13 THEN LEAVE.
END.
  IF BEGG = 1 THEN XMONTH = "JANUARY  ".
  IF BEGG = 2 THEN XMONTH = "FEBRUARY ".
  IF BEGG = 3 THEN XMONTH = "MARCH    ".
  IF BEGG = 4 THEN XMONTH = "APRIL    ".
  IF BEGG = 5 THEN XMONTH = "MAY      ".
  IF BEGG = 6 THEN XMONTH = "JUNE     ".
  IF BEGG = 7 THEN XMONTH = "JULY     ".
  IF BEGG = 8 THEN XMONTH = "AUGUST   ".
  IF BEGG = 9 THEN XMONTH = "SEPTEMBER".
  IF BEGG = 10 THEN XMONTH = "OCTOBER  ".
  IF BEGG = 11 THEN XMONTH = "NOVEMBER ".
  IF BEGG = 12 THEN XMONTH = "DECEMBER ".
OUTPUT TO PRINTER PAGE-SIZE 0.
  FOR EACH INVOICE WHERE INVOICE.COMP# = XCOM AND
			 INVOICE.DIV# = XDIV AND
			 INVOICE.I-TYPE = "N"
			 BREAK BY INVOICE.ORD-NO:
    FIND ACCT-RCV WHERE ACCT-RCV.COMP# = INVOICE.COMP# AND
			ACCT-RCV.DIV# = INVOICE.DIV# AND
			ACCT-RCV.CUST# = INVOICE.CUST#.
    FIND METPRO WHERE METPRO.COMP# = INVOICE.COMP# AND
		      METPRO.DIV# = INVOICE.DIV# AND
		      METPRO.CUST# = INVOICE.CUST# AND
		      METPRO.PROPSL# = INVOICE.PROPSL#.
    SALZ = 0.
    FIND SALESMAN WHERE SALESMAN.SLS# = INVOICE.SLS# NO-ERROR.
    IF AVAILABLE SALESMAN THEN DO:
	SALZ = INVOICE.SLS#.
    END.
IF FIRST-OF(INVOICE.ORD-NO) THEN DO:
  T-TOT = 0.0.
  CTR = 0.
  DISPLAY SKIP(9) SPACE(12)
	  TRIM(STRING(INVOICE.CUST#, ">>>>>>>>>>")) + "-" +
	  TRIM(STRING(INVOICE.PROPSL#, ">>>>>>>>>>")) FORMAT "X(25)"
	  SPACE(14) INVOICE.PO# SKIP(0)
	  SPACE(3) ACCT-RCV.C-NAME SPACE(16) METPRO.L-NAME SKIP(0)
	  SPACE(3) ACCT-RCV.ADDR-1 SPACE(16) METPRO.LADDR01 SKIP(0)
	  WITH FRAME A NO-BOX NO-LABELS.
 IF ACCT-RCV.ADDR-5 <> "" THEN DO:
   DISPLAY SPACE(3) ACCT-RCV.ADDR-2 SPACE(16) METPRO.LADDR02 SKIP(0)
	   SPACE(3) ACCT-RCV.ADDR-3 SPACE(16) METPRO.LADDR03 SKIP(0)
	   SPACE(3) ACCT-RCV.ADDR-4 SPACE(17) METPRO.STATE SKIP(0)
	   SPACE(3) ACCT-RCV.ADDR-5 + ", " + ACCT-RCV.STATE + " "
	   FORMAT "X(25)" ACCT-RCV.ZIP FORMAT "99999-9999" SKIP(1)
	   WITH FRAME BB NO-BOX NO-LABELS.
   END.
 ELSE
  IF ACCT-RCV.ADDR-4 <> "" THEN DO:
    DISPLAY SPACE(3) ACCT-RCV.ADDR-2 SPACE(16) METPRO.LADDR02 SKIP(0)
	    SPACE(3) ACCT-RCV.ADDR-3 SPACE(16) METPRO.LADDR03 SKIP(0)
	    SPACE(3) ACCT-RCV.ADDR-4 + ", " + ACCT-RCV.STATE + " "
	    FORMAT "X(25)" ACCT-RCV.ZIP FORMAT "99999-9999" SPACE(5)
	    METPRO.STATE SKIP(2) WITH FRAME B NO-BOX NO-LABELS.
      END.
      ELSE
       IF ACCT-RCV.ADDR-3 <> "" THEN DO:
	  DISPLAY
	      SPACE(3) ACCT-RCV.ADDR-2 SPACE(16) METPRO.LADDR02 SKIP(0)
	      SPACE(3) ACCT-RCV.ADDR-3 + ", " + ACCT-RCV.STATE + " "
	      FORMAT "X(25)" ACCT-RCV.ZIP FORMAT "99999-9999" SPACE(5)
	      METPRO.LADDR03 SKIP(0) SPACE(45) METPRO.STATE SKIP(2)
	      WITH FRAME C NO-BOX NO-LABELS.
      END.
      ELSE
       IF ACCT-RCV.ADDR-2 <> "" THEN DO:
	  DISPLAY
	      SPACE(3) ACCT-RCV.ADDR-2 + ", " + ACCT-RCV.STATE + " "
	      FORMAT "X(25)" ACCT-RCV.ZIP FORMAT "99999-9999" SPACE(5)
	      METPRO.LADDR02 SKIP(0) SPACE(44)
	      METPRO.LADDR03 SKIP(0) SPACE(45) METPRO.STATE SKIP(2)
	      WITH FRAME CC NO-BOX NO-LABELS.
       END.
  UPDATE INVOICE.I-DATE = BEG#.
  UPDATE INVOICE.INV-NO = FINV.
  DISPLAY SPACE(3) XMONTH SPACE(18) SALZ SPACE(21)
  INVOICE.I-DATE SPACE(4) INVOICE.INV-NO SKIP(1) WITH FRAME D NO-BOX NO-LABELS.
  FINV = FINV + 1.
END.
ELSE DO:
  UPDATE INVOICE.I-DATE = BEG#.
  UPDATE INVOICE.INV-NO = FINV - 1.
END.
  IF INVOICE.COMP# = 4 AND INVOICE.DIV# = 1 THEN DO:
     ARD = "Monthly billing for Metal Maintenance".
   END.
   ELSE DO:
    FIND FIRST AR-DESP WHERE AR-DESP.COMP# = INVOICE.COMP# AND
			     AR-DESP.DIV# = INVOICE.DIV# AND
			     AR-DESP.CUST# = INVOICE.CUST# AND
			     AR-DESP.PROPSL# = INVOICE.PROPSL# AND
			     AR-DESP.ITEM# = INVOICE.ITEM# NO-ERROR.
    IF NOT AVAILABLE AR-DESP THEN DO:
	ARD = "".
    END.
    ELSE DO:
	ARD = AR-DESP.DESC01.
    END.
    END.
      VIEW FRAME FTR.
IF CTR > 16 THEN DO:
  CTR = 0.
  DISPLAY SKIP(1)
	  SPACE(2) "- - - CONTINUED ON NEXT PAGE - - -" SKIP(13) SPACE(12)
	  TRIM(STRING(INVOICE.CUST#, ">>>>>>>>>>")) + "-" +
	  TRIM(STRING(INVOICE.PROPSL#, ">>>>>>>>>>")) FORMAT "X(25)"
	  SPACE(14) INVOICE.PO# SKIP(0)
	  SPACE(3) ACCT-RCV.C-NAME SPACE(16) METPRO.L-NAME SKIP(0)
	  SPACE(3) ACCT-RCV.ADDR-1 SPACE(16) METPRO.LADDR01 SKIP(0)
	  WITH FRAME ZA NO-BOX NO-LABELS.
 IF ACCT-RCV.ADDR-5 <> "" THEN DO:
   DISPLAY SPACE(3) ACCT-RCV.ADDR-2 SPACE(16) METPRO.LADDR02 SKIP(0)
	   SPACE(3) ACCT-RCV.ADDR-3 SPACE(16) METPRO.LADDR03 SKIP(0)
	   SPACE(3) ACCT-RCV.ADDR-4 SPACE(17) METPRO.STATE SKIP(0)
	   SPACE(3) ACCT-RCV.ADDR-5 + ", " + ACCT-RCV.STATE + " "
	   FORMAT "X(25)" ACCT-RCV.ZIP FORMAT "99999-9999" SKIP(1)
	   WITH FRAME ZB NO-BOX NO-LABELS.
   END.
 ELSE
  IF ACCT-RCV.ADDR-4 <> "" THEN DO:
    DISPLAY SPACE(3) ACCT-RCV.ADDR-2 SPACE(16) METPRO.LADDR02 SKIP(0)
	    SPACE(3) ACCT-RCV.ADDR-3 SPACE(16) METPRO.LADDR03 SKIP(0)
	    SPACE(3) ACCT-RCV.ADDR-4 + ", " + ACCT-RCV.STATE + " "
	    FORMAT "X(25)" ACCT-RCV.ZIP FORMAT "99999-9999" SPACE(5)
	    METPRO.STATE SKIP(2) WITH FRAME ZC NO-BOX NO-LABELS.
      END.
      ELSE
       IF ACCT-RCV.ADDR-3 <> "" THEN DO:
	  DISPLAY
	      SPACE(3) ACCT-RCV.ADDR-2 SPACE(16) METPRO.LADDR02 SKIP(0)
	      SPACE(3) ACCT-RCV.ADDR-3 + ", " + ACCT-RCV.STATE + " "
	      FORMAT "X(25)" ACCT-RCV.ZIP FORMAT "99999-9999" SPACE(5)
	      METPRO.LADDR03 SKIP(0) SPACE(45) METPRO.STATE SKIP(2)
	      WITH FRAME ZD NO-BOX NO-LABELS.
      END.
      ELSE
       IF ACCT-RCV.ADDR-2 <> "" THEN DO:
	  DISPLAY
	      SPACE(3) ACCT-RCV.ADDR-2 + ", " + ACCT-RCV.STATE + " "
	      FORMAT "X(25)" ACCT-RCV.ZIP FORMAT "99999-9999" SPACE(5)
	      METPRO.LADDR02 SKIP(0) SPACE(44)
	      METPRO.LADDR03 SKIP(0) SPACE(45) METPRO.STATE SKIP(2)
	      WITH FRAME ZE NO-BOX NO-LABELS.
       END.
  UPDATE INVOICE.I-DATE = BEG#.
  UPDATE INVOICE.INV-NO = FINV - 1.
  DISPLAY SPACE(3) XMONTH SPACE(18) SALZ SPACE(21)
  INVOICE.I-DATE SPACE(4) INVOICE.INV-NO SKIP(1)
  WITH FRAME ZF NO-BOX NO-LABELS.
END.
ELSE DO:
  UPDATE INVOICE.I-DATE = BEG#.
  UPDATE INVOICE.INV-NO = FINV - 1.
END.
      DISPLAY INVOICE.ITEM# SPACE(2) ARD SPACE(3) INVOICE.TOT-INV
	  FORMAT "->>>,>>>.99" SKIP(0) WITH FRAME E NO-BOX NO-LABELS.
      T-TOT = T-TOT + INVOICE.TOT-INV.
      CTR = CTR + 1.
      IF LAST-OF(INVOICE.ORD-NO) THEN DO:
	  IF CTR = 1 THEN DO:
	    DISPLAY SKIP(17) SPACE(10) INVOICE.TERM-DSC SPACE(44) T-TOT
	    SKIP(4) WITH FRAME XA NO-BOX NO-LABELS.
	  END.
	  ELSE
	  IF CTR = 2 THEN DO:
	    DISPLAY SKIP(16) SPACE(10) INVOICE.TERM-DSC SPACE(44) T-TOT
	    SKIP(4) WITH FRAME XB NO-BOX NO-LABELS.
	  END.
	  ELSE
	  IF CTR = 3 THEN DO:
	    DISPLAY SKIP(15) SPACE(10) INVOICE.TERM-DSC SPACE(44) T-TOT
	    SKIP(4) WITH FRAME XC NO-BOX NO-LABELS.
	  END.
	  ELSE
	  IF CTR = 4 THEN DO:
	    DISPLAY SKIP(14) SPACE(10) INVOICE.TERM-DSC SPACE(44) T-TOT
	    SKIP(4) WITH FRAME XD NO-BOX NO-LABELS.
	  END.
	  ELSE
	  IF CTR = 5 THEN DO:
	    DISPLAY SKIP(13) SPACE(10) INVOICE.TERM-DSC SPACE(44) T-TOT
	    SKIP(4) WITH FRAME XE NO-BOX NO-LABELS.
	  END.
	  ELSE
	  IF CTR = 6 THEN DO:
	    DISPLAY SKIP(12) SPACE(10) INVOICE.TERM-DSC SPACE(44) T-TOT
	    SKIP(4) WITH FRAME XF NO-BOX NO-LABELS.
	  END.
	  ELSE
	  IF CTR = 7 THEN DO:
	    DISPLAY SKIP(11) SPACE(10) INVOICE.TERM-DSC SPACE(44) T-TOT
	    SKIP(4) WITH FRAME XG NO-BOX NO-LABELS.
	  END.
	  ELSE
	  IF CTR = 8 THEN DO:
	    DISPLAY SKIP(10) SPACE(10) INVOICE.TERM-DSC SPACE(44) T-TOT
	    SKIP(4) WITH FRAME XH NO-BOX NO-LABELS.
	  END.
	  ELSE
	  IF CTR = 9 THEN DO:
	    DISPLAY SKIP(9) SPACE(10) INVOICE.TERM-DSC SPACE(44) T-TOT
	    SKIP(4) WITH FRAME XI NO-BOX NO-LABELS.
	  END.
	  ELSE
	  IF CTR = 10 THEN DO:
	    DISPLAY SKIP(8) SPACE(10) INVOICE.TERM-DSC SPACE(44) T-TOT
	    SKIP(4) WITH FRAME XJ NO-BOX NO-LABELS.
	  END.
	  ELSE
	  IF CTR = 11 THEN DO:
	    DISPLAY SKIP(7) SPACE(10) INVOICE.TERM-DSC SPACE(44) T-TOT
	    SKIP(4) WITH FRAME XK NO-BOX NO-LABELS.
	  END.
	  ELSE
	  IF CTR = 12 THEN DO:
	    DISPLAY SKIP(6) SPACE(10) INVOICE.TERM-DSC SPACE(44) T-TOT
	    SKIP(4) WITH FRAME XL NO-BOX NO-LABELS.
	  END.
	  ELSE
	  IF CTR = 13 THEN DO:
	    DISPLAY SKIP(5) SPACE(10) INVOICE.TERM-DSC SPACE(44) T-TOT
	    SKIP(4) WITH FRAME XM NO-BOX NO-LABELS.
	  END.
	  ELSE
	  IF CTR = 14 THEN DO:
	    DISPLAY SKIP(4) SPACE(10) INVOICE.TERM-DSC SPACE(44) T-TOT
	    SKIP(4) WITH FRAME XN NO-BOX NO-LABELS.
	  END.
	  ELSE
	  IF CTR = 15 THEN DO:
	    DISPLAY SKIP(3) SPACE(10) INVOICE.TERM-DSC SPACE(44) T-TOT
	    SKIP(4) WITH FRAME XO NO-BOX NO-LABELS.
	  END.
	  ELSE
	  IF CTR = 16 THEN DO:
	    DISPLAY SKIP(2) SPACE(10) INVOICE.TERM-DSC SPACE(44) T-TOT
	    SKIP(4) WITH FRAME XP NO-BOX NO-LABELS.
	  END.
	  ELSE
	  IF CTR = 17 THEN DO:
	    DISPLAY SKIP(1) SPACE(10) INVOICE.TERM-DSC SPACE(44) T-TOT
	    SKIP(4) WITH FRAME XQ NO-BOX NO-LABELS.
	  END.
      END.
  END.
