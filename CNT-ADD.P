DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XCOM-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XDIV-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XOPR AS CHAR FORMAT "XXX".
DEFINE VARIABLE XCUST AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEFINE VARIABLE PRO# AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEFINE NEW SHARED VARIABLE PPRO# AS DECIMAL FORMAT "ZZZZZZZZZZ".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
REPEAT:
    IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN UNDO, LEAVE.
    DO TRANSACTION:
      FIND FIRST SYSCONTROL EXCLUSIVE-LOCK.
      PRO# = SYSCONTROL.NEXT-PRO + 1.
      SYSCONTROL.NEXT-PRO = PRO#.
      RELEASE SYSCONTROL.
    END.
    DO TRANSACTION:
DISPLAY SPACE(7)
"   C O N T R A C T   M A S T E R   C R E A T I O N   S C R E E N   "
SKIP(1) XCOM-N LABEL "CMP" SPACE(1)
	XDIV-N LABEL "DIV" SPACE(1)
	XOPR LABEL "OPR" SKIP(0)
	XCOM LABEL "COMPANY NUMBER" SPACE(18)
	XDIV LABEL "DIVISION NUMBER" SKIP(1).
	CREATE METPRO.
	METPRO.PROPSL# = PRO#.
	METPRO.COMP# = XCOM.
	METPRO.DIV# = XDIV.
    DISPLAY METPRO.PROPSL# LABEL "CONTRACT NUMBER" SPACE(9)
	    METPRO.CUST# LABEL "CUSTOMER NUMBER "SKIP(1)
	    METPRO.C-NAME LABEL "CUSTOMER " SPACE(5)
	    METPRO.L-NAME LABEL "L-NAME " SKIP(0)
	    METPRO.ADDR1 LABEL "ADDRESS 1" SPACE(5)
	    METPRO.LADDR01 LABEL "L-ADDR1" SKIP(0)
	    METPRO.ADDR2 LABEL "ADDRESS 2" SPACE(5)
	    METPRO.LADDR02 LABEL "L-ADDR2" SKIP(0)
	    METPRO.ADDR3 LABEL "ADDRESS 3" SPACE(5)
	    METPRO.LADDR03 LABEL "L-ADDR3" SKIP(0)
	    METPRO.ADDR4 LABEL "ADDRESS 4" SPACE(5)
	    METPRO.L-STATE
	    METPRO.L-TELE SKIP(0)
	    METPRO.ADDR5 LABEL "ADDRESS 5" SPACE(5)
	    METPRO.L-TELE2 LABEL "2ND PHONE OR EXT#" SKIP(0)
	    METPRO.STATE LABEL "STATE    " SPACE(5)
	    METPRO.ZIP SPACE(8)
	    METPRO.L-COMMENTS LABEL "COMMENT" SKIP(0)
	    METPRO.TELE LABEL "TELEPHONE" SPACE(16)
	    METPRO.TOT-AMT SKIP(0)
	    METPRO.FAX-TELE LABEL "FAX PHONE" SPACE(16)
	    METPRO.DATE-P LABEL "PROPOSAL DATE" SKIP(0)
	    METPRO.JANITOR LABEL "JANITORIAL ?" SPACE(24)
	    METPRO.MLABEL LABEL "MAILING LIST ?" SKIP(1)
	    METPRO.EXPIRE-DT LABEL "CONTRACT EXPIRE DATE" SPACE(9)
	    METPRO.MTH-BILL LABEL "MONTHLY BILLING AMOUNT"
	    METPRO.VOL-BUD LABEL "VOLUME BUDGET"
	       WITH SIDE-LABELS NO-BOX.
    IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN UNDO, LEAVE.
    UPDATE
	   METPRO.C-NAME METPRO.ADDR1 METPRO.ADDR2 METPRO.ADDR3
	   METPRO.ADDR4 METPRO.ADDR5 METPRO.STATE METPRO.ZIP
	   METPRO.TELE METPRO.FAX-TELE METPRO.JANITOR
	   METPRO.L-NAME METPRO.LADDR01 METPRO.LADDR02 METPRO.LADDR03
	   METPRO.L-STATE METPRO.L-TELE METPRO.L-TELE2 METPRO.L-COMMENTS
	   METPRO.TOT-AMT METPRO.DATE-P
	   METPRO.MLABEL
	   METPRO.EXPIRE-DT METPRO.MTH-BILL METPRO.VOL-BUD
	       WITH COLOR DISPLAY NORMAL PROMPT W/MA.
    RELEASE METPRO.
    IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN UNDO, LEAVE.
 END.
END.
