DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XCOM-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XDIV-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XOPR AS CHAR FORMAT "XXX".
DEFINE VARIABLE BEG# AS INTEGER FORMAT "ZZ"
  LABEL "MONTH".
DEFINE VARIABLE F-CUST AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "CUST #".
DEFINE VARIABLE F-PROP AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "PROP #".
DEFINE VARIABLE F-ITEM AS INTEGER FORMAT "ZZZZ"
    LABEL "ITEM #".
DEFINE VARIABLE F-INDX AS INTEGER FORMAT "ZZ"
    LABEL "TICK INDEX".
REPEAT:
DISPLAY SPACE(8)
"S I N G L E   T I C K E T   M A I N T E N A N C E   S C R E E N"
    SKIP(0)
XCOM-N LABEL "CO" XDIV-N LABEL "DV" XOPR LABEL "OPER"
SKIP(1) WITH FRAME X NO-BOX SIDE-LABELS.
PROMPT-FOR TICKET.CUST#
	   TICKET.PROPSL#
	   TICKET.ITEM#
	   TICKET.MONTH#
	   TICKET.T-INDX WITH FRAME X NO-BOX SIDE-LABELS.
F-CUST = INPUT TICKET.CUST#.
BEG# = INPUT TICKET.MONTH#.
F-PROP = INPUT TICKET.PROPSL#.
F-ITEM = INPUT TICKET.ITEM#.
F-INDX = INPUT TICKET.T-INDX.
FIND FIRST TICKET WHERE TICKET.COMP# = XCOM AND
			TICKET.DIV# = XDIV AND
			TICKET.CUST# = F-CUST AND
			TICKET.PROPSL# = F-PROP AND
			TICKET.ITEM# = F-ITEM AND
			TICKET.MONTH# = BEG# AND
			TICKET.T-INDX = F-INDX NO-ERROR.
IF NOT AVAILABLE TICKET THEN DO:
    MESSAGE "THIS TICKET DOES NOT EXIST OR HAS ALREADY BEEN PROCESSED".
    NEXT.
END.
TICKET.COMP# = XCOM.
TICKET.DIV# = XDIV.
DISPLAY TICKET.CUST# LABEL "CUST #"
	TICKET.PROPSL# LABEL "PROP #"
	TICKET.ITEM# LABEL "ITEM #"
	TICKET.MONTH# LABEL "MONTH"
	TICKET.T-INDX LABEL "TICK INDEX" SKIP(0)
	TICKET.M-NUM LABEL "MANAGER #" SPACE(11)
	TICKET.M-NAME LABEL "MANAGER NAME" SKIP(0)
	TICKET.FREQ LABEL "FREQUENCY" SKIP(0) SPACE(25)
	"BALANCES & VOLUMES" SPACE(10)
	"EQUIPMENT" SKIP(0) SPACE(25)
	"------------------" SPACE(10)
	"---------" SKIP(0)
	TICKET.PRT LABEL "PRINTED?   " SPACE(11)
	TICKET.DL-BUD LABEL "D/L BUD  " SPACE(1)
	TICKET.CABLE LABEL "CABLE REQ'D?" SKIP(0)
	TICKET.DATE-PRT LABEL "DATE       " SPACE(2)
	TICKET.DL LABEL "D/L USE  " SPACE(1)
	TICKET.CABLE-AMT LABEL "CABLE AMT" SKIP(0)
	TICKET.RET LABEL "TICK RET'D?" SPACE(11)
	TICKET.DL-BAL LABEL "D/L BAL  " SPACE(1)
	TICKET.SCAFFOLD LABEL "SCAFF REQ'D?" SKIP(0)
	TICKET.DATE-RET LABEL "DATE       " SPACE(2)
	TICKET.WK-DL-BUD LABEL "WK DL BUD" SPACE(1)
	TICKET.SCAFF-AMT LABEL "SCAFF AMT" SKIP(0)
	TICKET.T-STAT LABEL "STATUS     " SPACE(11)
	TICKET.WK-DL LABEL "WK DL USE" SPACE(1)
	TICKET.OTHER LABEL "OTHER REQ'D?" SKIP(0) SPACE(25)
	TICKET.WK-DL-BAL LABEL "WK DL BAL" SPACE(1)
	TICKET.OTH-AMT LABEL "OTHER AMT" SKIP(0) SPACE(25)
	TICKET.TOT-AMT LABEL "ORIG VOL " SKIP(0) SPACE(25)
	TICKET.TOT-AMT-REM LABEL "REMAINING" SKIP(0) SPACE(25)
	TICKET.WK-START LABEL "WEEK STRT" SKIP(0) SPACE(25)
	TICKET.WK-USED LABEL "WEEK USED" SKIP(0) SPACE(25)
	TICKET.WK-BAL LABEL "WEEK BAL " SKIP(0) SPACE(25)
	TICKET.MTD-VOL LABEL "MTD VOL  " SKIP(0) SPACE(25)
	TICKET.WTD-VOL LABEL "TTD VOL  " SKIP(0)
	WITH FRAME X NO-BOX NO-HIDE SIDE-LABELS.
	UPDATE TICKET.M-NUM WITH FRAME X.
	FIND FIRST SALESMAN WHERE SALESMAN.SLS# = TICKET.M-NUM.
	TICKET.M-NAME = SALESMAN.SLSNAME.
	DISPLAY TICKET.M-NAME WITH FRAME X NO-BOX SIDE-LABELS.
  REPEAT:
       UPDATE TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
       IF TICKET.FREQ BEGINS "D" OR TICKET.FREQ = "DAILY"
       THEN DO:
             TICKET.FREQ = "DAILY".
             DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
             LEAVE.
       END.
       ELSE       
       IF TICKET.FREQ BEGINS "2XW" OR TICKET.FREQ = "TWO_TIMES_PER_WEEK"
       THEN DO:
	 TICKET.FREQ = "TWO_TIMES_PER_WEEK".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "3XW" OR TICKET.FREQ = "THREE_TIMES_PER_WEEK"
       THEN DO:
	 TICKET.FREQ = "THREE_TIMES_PER_WEEK".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "4XW" OR TICKET.FREQ = "FOUR_TIMES_PER_WEEK"
       THEN DO:
	 TICKET.FREQ = "FOUR_TIMES_PER_WEEK".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "5XW" OR TICKET.FREQ = "FIVE_TIMES_PER_WEEK"
       THEN DO:
	 TICKET.FREQ = "FIVE_TIMES_PER_WEEK".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "6XW" OR TICKET.FREQ = "SIX_TIMES_PER_WEEK"
       THEN DO:
	 TICKET.FREQ = "SIX_TIMES_PER_WEEK".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "W" OR TICKET.FREQ = "WEEKLY"
       THEN DO:
	 TICKET.FREQ = "WEEKLY".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "2W" OR TICKET.FREQ = "EVERY_TWO_WEEKS"
       THEN DO:
	 TICKET.FREQ = "EVERY_TWO_WEEKS".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "3W" OR TICKET.FREQ = "EVERY_THREE_WEEKS"
       THEN DO:
	 TICKET.FREQ = "EVERY_THREE_WEEKS".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "4W" OR TICKET.FREQ = "EVERY_FOUR_WEEKS"
       THEN DO:
	 TICKET.FREQ = "EVERY_FOUR_WEEKS".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "5W" OR TICKET.FREQ = "EVERY_FIVE_WEEKS"
       THEN DO:
	 TICKET.FREQ = "EVERY_FIVE_WEEKS".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "6W" OR TICKET.FREQ = "EVERY_SIX_WEEKS"
       THEN DO:
	 TICKET.FREQ = "EVERY_SIX_WEEKS".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "8W" OR TICKET.FREQ = "EVERY_EIGHT_WEEKS"
       THEN DO:
	 TICKET.FREQ = "EVERY_EIGHT_WEEKS".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "M" OR TICKET.FREQ = "MONTHLY"
       THEN DO:
	 TICKET.FREQ = "MONTHLY".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "Q" OR TICKET.FREQ = "QUARTERLY"
       THEN DO:
	 TICKET.FREQ = "QUARTERLY".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "2XM" OR TICKET.FREQ = "TWO_TIMES_PER_MONTH"
       THEN DO:
	 TICKET.FREQ = "TWO_TIMES_PER_MONTH".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "A" OR TICKET.FREQ = "ANNUAL"
       THEN DO:
	 TICKET.FREQ = "ANNUAL".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "2XYR" OR TICKET.FREQ = "TWO_TIMES_PER_YEAR"
       THEN DO:
	 TICKET.FREQ = "TWO_TIMES_PER_YEAR".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "3XYR" OR TICKET.FREQ = "THREE_TIMES_PER_YEAR"
       THEN DO:
	 TICKET.FREQ = "THREE_TIMES_PER_YEAR".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "4XYR" OR TICKET.FREQ = "FOUR_TIMES_PER_YEAR"
       THEN DO:
	 TICKET.FREQ = "FOUR_TIMES_PER_YEAR".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "5XYR" OR TICKET.FREQ = "FIVE_TIMES_PER_YEAR"
       THEN DO:
	 TICKET.FREQ = "FIVE_TIMES_PER_YEAR".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "6XYR" OR TICKET.FREQ = "SIX_TIMES_PER_YEAR"
       THEN DO:
	 TICKET.FREQ = "SIX_TIMES_PER_YEAR".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "7XYR" OR TICKET.FREQ = "SEVEN_TIMES_PER_YEAR"
       THEN DO:
	 TICKET.FREQ = "SEVEN_TIMES_PER_YEAR".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "8XYR" OR TICKET.FREQ = "EIGHT_TIMES_PER_YEAR"
       THEN DO:
	 TICKET.FREQ = "EIGHT_TIMES_PER_YEAR".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "9XYR" OR TICKET.FREQ = "NINE_TIMES_PER_YEAR"
       THEN DO:
	 TICKET.FREQ = "NINE_TIMES_PER_YEAR".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "10XYR" OR TICKET.FREQ = "TEN_TIMES_PER_YEAR"
       THEN DO:
	 TICKET.FREQ = "TEN_TIMES_PER_YEAR".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "11XYR" OR TICKET.FREQ = "ELEVEN_TIMES_PER_YEAR"
       THEN DO:
	 TICKET.FREQ = "ELEVEN_TIMES_PER_YEAR".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "1X2YR" OR TICKET.FREQ = "EVERY_TWO_YEARS"
       THEN DO:
	 TICKET.FREQ = "EVERY_TWO_YEARS".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "1X3YR" OR TICKET.FREQ = "EVERY_THREE_YEARS"
       THEN DO:
	 TICKET.FREQ = "EVERY_THREE_YEARS".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "1X4YR" OR TICKET.FREQ = "EVERY_FOUR_YEARS"
       THEN DO:
	 TICKET.FREQ = "EVERY_FOUR_YEARS".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "1X5YR" OR TICKET.FREQ = "EVERY_FIVE_YEARS"
       THEN DO:
	 TICKET.FREQ = "EVERY_FIVE_YEARS".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "1X18M" OR TICKET.FREQ = "EVERY_EIGHTEEN_MONTHS"
       THEN DO:
	 TICKET.FREQ = "EVERY_EIGHTEEN_MONTHS".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "SPCL" OR TICKET.FREQ = "SPECIAL_CLEANING"
       THEN DO:
	 TICKET.FREQ = "SPECIAL_CLEANING".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "OC" OR TICKET.FREQ = "ON_CALL"
       THEN DO:
	 TICKET.FREQ = "ON_CALL".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "IC" OR TICKET.FREQ = "INITIAL_CLEANING"
       THEN DO:
	 TICKET.FREQ = "INITIAL_CLEANING".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE
       IF TICKET.FREQ BEGINS "1X" OR TICKET.FREQ = "ONE_TIME_CLEANING"
       THEN DO:
	 TICKET.FREQ = "ONE_TIME_CLEANING".
	 DISPLAY TICKET.FREQ WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	 LEAVE.
       END.
       ELSE MESSAGE "INCORRECT TICKET.FREQUENCY".
   END.
IF (USERID <> "OPERATIONS") AND (USERID <> "LANDMARK") AND (USERID <> "GARCIA")
THEN DO:
	UPDATE TICKET.PRT TICKET.DATE-PRT TICKET.RET
	       TICKET.DATE-RET TICKET.T-STAT TICKET.DL-BUD
	       TICKET.DL TICKET.DL-BAL TICKET.WK-DL-BUD TICKET.WK-DL
	       TICKET.WK-DL-BAL TICKET.TOT-AMT TICKET.TOT-AMT-REM
	       TICKET.WK-START TICKET.WK-USED TICKET.WK-BAL
	       TICKET.MTD-VOL TICKET.WTD-VOL
	       TICKET.CABLE
	       TICKET.CABLE-AMT TICKET.SCAFFOLD TICKET.SCAFF-AMT
	       TICKET.OTHER TICKET.OTH-AMT
		   WITH FRAME X COLOR DISPLAY NORMAL PROMPT W/MA.
	RELEASE TICKET.
END.
END.
