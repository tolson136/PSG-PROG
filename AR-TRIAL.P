DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE VARIABLE BEG# AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "ENTER BEGINNING CUSTOMER NUMBER".
DEFINE VARIABLE END# AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "ENTER ENDING CUSTOMER NUMBER   ".
DEFINE VARIABLE WZERO AS LOGICAL
    LABEL "INCLUDE ZERO BALANCE ACCOUNTS? ".
DEFINE VARIABLE RPTDATE AS DATE FORMAT "99/99/9999".
DEFINE SHARED VARIABLE XCOM-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XDIV-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XOPR AS CHAR FORMAT "XXX".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
DISPLAY SPACE(4)
"A C C O U N T   T R I A L   B A L A N C E   R E P O R T   S C R E E N     "
SKIP(1) WITH FRAME A.
    UPDATE BEG# WITH ROW FRAME-ROW + 5 + FRAME-LINE + 5 COLUMN 17
       SIDE-LABELS OVERLAY FRAME X
       COLOR DISPLAY WHITE/RED PROMPT RED/WHITE.
    UPDATE END# WITH ROW FRAME-ROW + 5 + FRAME-LINE + 5 COLUMN 17
       SIDE-LABELS OVERLAY FRAME B
       COLOR DISPLAY WHITE/RED PROMPT RED/WHITE.
    UPDATE WZERO WITH ROW FRAME-ROW + 5 + FRAME-LINE + 5 COLUMN 17
       SIDE-LABELS OVERLAY FRAME W
       COLOR DISPLAY WHITE/RED PROMPT RED/WHITE.
  OUTPUT TO PRINTER.
  RPTDATE = TODAY.
  FOR EACH ACCT-RCV WHERE ACCT-RCV.COMP# = XCOM AND
			  ACCT-RCV.DIV# = XDIV AND
			  ACCT-RCV.CUST# >= BEG# AND
			  ACCT-RCV.CUST# <= END#:
  IF NOT WZERO AND TOT-BAL = 0.00 THEN NEXT.
       ACCUMULATE SLS-YTD (TOTAL).
       ACCUMULATE TOT-BAL (TOTAL).
       FORM HEADER RPTDATE FORMAT "99/99/9999"
	    "CUSTOMER TRIAL BALANCE REPORT" AT 20
	    "PAGE:" AT 65 PAGE-NUMBER FORMAT ">>9" SKIP(0)
	    "COMPANY: " AT 20 XCOM-N SKIP(0)
	    "DIVISION: " AT 20 XDIV-N "OPER: " AT 65 XOPR SKIP(2).
    DISPLAY
	    ACCT-RCV.CUST# LABEL "ACCT#"
	    C-NAME LABEL "CUSTOMER NAME"
	    SLS-YTD LABEL "SALES YTD" FORMAT "$->>>>,>>>.99"
	    TOT-BAL LABEL "TOTAL BAL DUE" FORMAT "$->>>>,>>>.99" SKIP(0).
  END.
DISPLAY SPACE(20) "*****TOTAL***** "
    (ACCUM TOTAL SLS-YTD) FORMAT "$->>>>,>>>.99" NO-LABEL
    (ACCUM TOTAL TOT-BAL) FORMAT "$->>>>,>>>.99" NO-LABEL.
