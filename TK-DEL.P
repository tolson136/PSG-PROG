DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XCOM-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XDIV-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XOPR AS CHAR FORMAT "XXX".
DEFINE VAR ANS AS LOGICAL LABEL
    "Do you wish to delete this ticket ?".
DEFINE VARIABLE BEG# AS INTEGER FORMAT "ZZ"
  LABEL "MONTH".
DEFINE VARIABLE F-CUST AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "CUST #".
DEFINE VARIABLE F-PROP AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "PROP #".
DEFINE VARIABLE F-ITEM AS INTEGER FORMAT "ZZZZ"
    LABEL "ITEM #".
DEFINE VARIABLE F-INDX AS INTEGER FORMAT "ZZ"
    LABEL "TICK INDEX".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
REPEAT:
DISPLAY SPACE(11)
"S I N G L E   T I C K E T   D E L E T I O N   S C R E E N"
    SKIP(1)
XCOM-N LABEL "CO" XDIV-N LABEL "DV" XOPR LABEL "OPER"
SKIP(1) WITH NO-BOX SIDE-LABELS.
PROMPT-FOR TICKET.CUST#
	   TICKET.PROPSL#
	   TICKET.ITEM#
	   TICKET.MONTH#
	   TICKET.T-INDX WITH NO-BOX SIDE-LABELS.
F-CUST = INPUT TICKET.CUST#.
BEG# = INPUT TICKET.MONTH#.
F-PROP = INPUT TICKET.PROPSL#.
F-ITEM = INPUT TICKET.ITEM#.
F-INDX = INPUT TICKET.T-INDX.
FIND FIRST TICKET WHERE TICKET.COMP# = XCOM AND
			TICKET.DIV# = XDIV AND
			TICKET.CUST# = F-CUST AND
			TICKET.PROPSL# = F-PROP AND
			TICKET.ITEM# = F-ITEM AND
			TICKET.MONTH# = BEG# AND
			TICKET.T-INDX = F-INDX NO-ERROR.
IF NOT AVAILABLE TICKET THEN DO:
    MESSAGE "THIS TICKET DOES NOT EXIST OR HAS ALREADY BEEN PROCESSED".
    NEXT.
END.
TICKET.COMP# = XCOM.
TICKET.DIV# = XDIV.
DISPLAY TICKET.CUST# LABEL "CUST #"
	TICKET.PROPSL# LABEL "PROP #"
	TICKET.ITEM# LABEL "ITEM #"
	TICKET.MONTH# LABEL "MONTH"
	TICKET.T-INDX LABEL "TICK INDEX" SKIP(0)
	TICKET.M-NUM LABEL "MANAGER #" SPACE(11)
	TICKET.M-NAME LABEL "MANAGER NAME" SKIP(0)
	TICKET.FREQ LABEL "FREQUENCY" SKIP(0) SPACE(25)
	"BALANCES & VOLUMES" SPACE(10)
	"EQUIPMENT" SKIP(0) SPACE(25)
	"------------------" SPACE(10)
	"---------" SKIP(0)
	TICKET.PRT LABEL "PRINTED?   " SPACE(11)
	TICKET.DL-BUD LABEL "D/L BUD  " SPACE(1)
	TICKET.CABLE LABEL "CABLE REQ'D?" SKIP(0)
	TICKET.DATE-PRT LABEL "DATE       " SPACE(2)
	TICKET.DL LABEL "D/L USE  " SPACE(1)
	TICKET.CABLE-AMT LABEL "CABLE AMT" SKIP(0)
	TICKET.RET LABEL "TICK RET'D?" SPACE(11)
	TICKET.DL-BAL LABEL "D/L BAL  " SPACE(1)
	TICKET.SCAFFOLD LABEL "SCAFF REQ'D?" SKIP(0)
	TICKET.DATE-RET LABEL "DATE       " SPACE(2)
	TICKET.WK-DL-BUD LABEL "WK DL BUD" SPACE(1)
	TICKET.SCAFF-AMT LABEL "SCAFF AMT" SKIP(0)
	TICKET.T-STAT LABEL "STATUS     " SPACE(11)
	TICKET.WK-DL LABEL "WK DL USE" SPACE(1)
	TICKET.OTHER LABEL "OTHER REQ'D?" SKIP(0) SPACE(25)
	TICKET.WK-DL-BAL LABEL "WK DL BAL" SPACE(1)
	TICKET.OTH-AMT LABEL "OTHER AMT" SKIP(0) SPACE(25)
	TICKET.TOT-AMT LABEL "ORIG VOL " SKIP(0) SPACE(25)
	TICKET.WK-START LABEL "WEEK STRT" SKIP(0) SPACE(25)
	TICKET.WK-USED LABEL "WEEK USED" SKIP(0) SPACE(25)
	TICKET.WK-BAL LABEL "WEEK BAL " SKIP(0) SPACE(25)
	TICKET.MTD-VOL LABEL "MTD VOL  " SKIP(0) SPACE(25)
	TICKET.WTD-VOL LABEL "TTD VOL  " WITH NO-BOX NO-HIDE SIDE-LABELS.
	ANS = no.
	UPDATE ANS WITH ROW FRAME-ROW + 15 + FRAME-LINE + 5 COLUMN 20
		   WITH SIDE-LABELS OVERLAY FRAME DEL-FRAME NO-BOX
		   COLOR DISPLAY W/RED PROMPT RED/W.
	IF ANS THEN DO:
	    FOR EACH EMPLOYEE WHERE EMPLOYEE.COMP# =   TICKET.COMP# AND
				    EMPLOYEE.DIV# =    TICKET.DIV# AND
				    EMPLOYEE.CUST# =   TICKET.CUST# AND
				    EMPLOYEE.PROPSL# = TICKET.PROPSL# AND
				    EMPLOYEE.ITEM# =   TICKET.ITEM# AND
				    EMPLOYEE.MONTH# =  TICKET.MONTH# AND
				    EMPLOYEE.T-INDX =  TICKET.T-INDX:
		DELETE EMPLOYEE.
	    END.
	    DELETE TICKET.
	END.
END.
