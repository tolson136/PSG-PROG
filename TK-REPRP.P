DEF SHARED VAR XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XCOM-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XDIV-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XOPR AS CHAR FORMAT "XXX".
DEFINE VARIABLE H-FREQ AS CHAR FORMAT "X(5)".
DEFINE SHARED VARIABLE BEG# AS INTEGER FORMAT "ZZ"
  LABEL "MONTH".
DEFINE SHARED VARIABLE F-CUST AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "CUST #".
DEFINE SHARED VARIABLE F-PROP AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "PROP #".
DEFINE SHARED VARIABLE F-ITEM AS INTEGER FORMAT "ZZZZ"
    LABEL "ITEM #".
DEFINE SHARED VARIABLE F-INDX AS INTEGER FORMAT "ZZ"
    LABEL "TICK INDEX".
DEFINE SHARED VAR F-NUM AS CHAR FORMAT "X(4)".
DEFINE SHARED VAR F-MAN AS INTEGER FORMAT "ZZZ".
DEF SHARED VAR F-DATE AS DATE FORMAT "99/99/9999".
IF (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
OUTPUT TO TERMINAL.
FIND FIRST TICKET WHERE TICKET.COMP# = XCOM AND
			TICKET.DIV# = XDIV AND
			TICKET.CUST# = F-CUST AND
			TICKET.PROPSL# = F-PROP AND
			TICKET.ITEM# = F-ITEM AND
			TICKET.MONTH# = BEG# AND
			TICKET.T-INDX = F-INDX NO-ERROR.
IF NOT AVAILABLE TICKET THEN DO:
    BELL.
    MESSAGE COLOR BLINK
	"THIS TICKET DOES NOT EXIST".
    BELL.
    UNDO, RETRY.
END.
/*
IF TICKET.T-STAT = "C" THEN DO:
    BELL.
    HIDE MESSAGE.
    MESSAGE COLOR BLINK "THIS TICKET HAS BEEN COMPLETED THIS BILLING CYCLE".
    BELL.
    UNDO, RETRY.
END.
IF TICKET.DL-BAL <= 0.0 OR TICKET.WK-DL-BAL <= 0.0 THEN DO:
    BELL.
    HIDE MESSAGE.
    MESSAGE COLOR BLINK "THERE IS NO D/L BALANCE LEFT ON THIS TICKET".
    MESSAGE COLOR BLINK "AUTHORIZATION REQUIRED TO REPRINT TICKET".
    BELL.
    UNDO, RETRY.
END.
*/
FIND FIRST METDESC WHERE METDESC.COMP# = XCOM AND
			  METDESC.DIV# = XDIV AND
			  METDESC.CUST# = F-CUST AND
			  METDESC.PROPSL# = F-PROP AND
			  METDESC.ITEM# = F-ITEM NO-ERROR.
IF NOT AVAILABLE METDESC THEN DO:
    BELL.
    HIDE MESSAGE.
    MESSAGE COLOR BLINK "THIS CONTRACT DESCRIPTION NO LONGER EXISTS".
    BELL.
    UNDO, RETRY.
END.
FIND FIRST METPRO WHERE METPRO.COMP# = XCOM AND
			METPRO.DIV# = XDIV AND
			METPRO.CUST# = F-CUST AND
			METPRO.PROPSL# = F-PROP NO-ERROR.
IF NOT AVAILABLE METPRO THEN DO:
    BELL.
    HIDE MESSAGE.
    MESSAGE COLOR BLINK "THIS CONTRACT NO LONGER EXISTS".
    BELL.
    UNDO, RETRY.
END.
IF METPRO.JANITOR = yes THEN DO:
    BELL.
    HIDE MESSAGE.
    MESSAGE COLOR BLINK "THIS PROPOSAL IS A JANITORIAL TICKET".
    BELL.
    UNDO, RETRY.
END.
      IF TICKET.FREQ = "DAILY" THEN H-FREQ = "D".
      IF TICKET.FREQ = "TWO_TIMES_PER_WEEK" THEN H-FREQ = "2XW".
      IF TICKET.FREQ = "THREE_TIMES_PER_WEEK" THEN H-FREQ = "3XW".
      IF TICKET.FREQ = "FOUR_TIMES_PER_WEEK" THEN H-FREQ = "4XW".
      IF TICKET.FREQ = "FIVE_TIMES_PER_WEEK" THEN H-FREQ = "5XW".
      IF TICKET.FREQ = "SIX_TIMES_PER_WEEK" THEN H-FREQ = "6XW".
      IF TICKET.FREQ = "WEEKLY" THEN H-FREQ = "W".
      IF TICKET.FREQ = "EVERY_TWO_WEEKS" THEN H-FREQ = "2W".
      IF TICKET.FREQ = "EVERY_THREE_WEEKS" THEN H-FREQ = "3W".
      IF TICKET.FREQ = "EVERY_FOUR_WEEKS" THEN H-FREQ = "4W".
      IF TICKET.FREQ = "EVERY_FIVE_WEEKS" THEN H-FREQ = "5W".
      IF TICKET.FREQ = "EVERY_SIX_WEEKS" THEN H-FREQ = "6W".
      IF TICKET.FREQ = "EVERY_EIGHT_WEEKS" THEN H-FREQ = "8W".
      IF TICKET.FREQ = "MONTHLY" THEN H-FREQ = "M".
      IF TICKET.FREQ = "QUARTERLY" THEN H-FREQ = "Q".
      IF TICKET.FREQ = "TWO_TIMES_PER_MONTH" THEN H-FREQ = "2XM".
      IF TICKET.FREQ = "ANNUAL" THEN H-FREQ = "A".
      IF TICKET.FREQ = "TWO_TIMES_PER_YEAR" THEN H-FREQ = "2XYR".
      IF TICKET.FREQ = "THREE_TIMES_PER_YEAR" THEN H-FREQ = "3XYR".
      IF TICKET.FREQ = "FOUR_TIMES_PER_YEAR" THEN H-FREQ = "4XYR".
      IF TICKET.FREQ = "FIVE_TIMES_PER_YEAR" THEN H-FREQ = "5XYR".
      IF TICKET.FREQ = "SIX_TIMES_PER_YEAR" THEN H-FREQ = "6XYR".
      IF TICKET.FREQ = "SEVEN_TIMES_PER_YEAR" THEN H-FREQ = "7XYR".
      IF TICKET.FREQ = "EIGHT_TIMES_PER_YEAR" THEN H-FREQ = "8XYR".
      IF TICKET.FREQ = "NINE_TIMES_PER_YEAR" THEN H-FREQ = "9XYR".
      IF TICKET.FREQ = "TEN_TIMES_PER_YEAR" THEN H-FREQ = "10XYR".
      IF TICKET.FREQ = "ELEVEN_TIMES_PER_YEAR" THEN H-FREQ = "11XYR".
      IF TICKET.FREQ = "EVERY_TWO_YEARS" THEN H-FREQ = "1X2YR".
      IF TICKET.FREQ = "EVERY_THREE_YEARS" THEN H-FREQ = "1X3YR".
      IF TICKET.FREQ = "EVERY_FOUR_YEARS" THEN H-FREQ = "1X4YR".
      IF TICKET.FREQ = "EVERY_FIVE_YEARS" THEN H-FREQ = "1X5YR".
      IF TICKET.FREQ = "EVERY_EIGHTEEN_MONTHS" THEN H-FREQ = "1X18M".
      IF TICKET.FREQ = "SPECIAL_CLEANING" THEN H-FREQ = "SPCL".
      IF TICKET.FREQ = "ON_CALL" THEN H-FREQ = "OC".
      IF TICKET.FREQ = "INITIAL_CLEANING" THEN H-FREQ = "IC".
      IF TICKET.FREQ = "ONE_TIME_CLEANING" THEN H-FREQ = "1X".
OUTPUT TO PRINTER PAGE-SIZE 0.
  IF TICKET.PRISEC = "S" THEN DO:
      DISPLAY SPACE(74) H-FREQ SKIP(2) SPACE(44)
	      STRING(TICKET.COMP#, ">>") + "-" +
	      TRIM(STRING(TICKET.DIV#, ">>")) + "-" +
	      TRIM(STRING(TICKET.CUST#, ">>>>>>>>>>")) + "-" +
	      TRIM(STRING(TICKET.PROPSL#, ">>>>>>>>>>")) + "-" +
	      TRIM(STRING(TICKET.ITEM#, ">>>>")) + "-" +
	      TRIM(STRING(TICKET.MONTH, ">>")) + "-" +
	      TRIM(STRING(TICKET.T-INDX, ">>"))
	      FORMAT "X(35)" SKIP(0) SPACE(20)
	      METPRO.L-NAME SPACE(1)
	      METPRO.LADDR01 SKIP(0)
	      METDESC.S-TYPE SPACE(17)
	      METPRO.LADDR02 SPACE(1)
	      METPRO.LADDR03 SKIP(0)
	      METDESC.S-DESC1 SKIP(0)
	      METDESC.S-DESC2 SKIP(0)
	      METDESC.S-DESC3 SKIP(0)
	      METDESC.S-DESC4 SKIP(0)
	      "*"
	      METDESC.S-SPCL1 SKIP(0)
	      "*"
	      METDESC.S-SPCL2 SKIP(0)
	      SKIP(10) WITH FRAME H2 NO-BOX NO-LABELS.
  END.
  ELSE DO:
      DISPLAY SPACE(74) H-FREQ SKIP(2) SPACE(44)
	      STRING(TICKET.COMP#, ">>") + "-" +
	      TRIM(STRING(TICKET.DIV#, ">>")) + "-" +
	      TRIM(STRING(TICKET.CUST#, ">>>>>>>>>>")) + "-" +
	      TRIM(STRING(TICKET.PROPSL#, ">>>>>>>>>>")) + "-" +
	      TRIM(STRING(TICKET.ITEM#, ">>>>")) + "-" +
	      TRIM(STRING(TICKET.MONTH, ">>")) + "-" +
	      TRIM(STRING(TICKET.T-INDX, ">>"))
	      FORMAT "X(35)" SKIP(0) SPACE(20)
	      METPRO.L-NAME SPACE(1)
	      METPRO.LADDR01 SKIP(0)
	      METDESC.P-TYPE SPACE(17)
	      METPRO.LADDR02 SPACE(1)
	      METPRO.LADDR03 SKIP(0)
	      METDESC.P-DESC1 SKIP(0)
	      METDESC.P-DESC2 SKIP(0)
	      METDESC.P-DESC3 SKIP(0)
	      METDESC.P-DESC4 SKIP(0)
	      "*"
	      METDESC.P-SPCL1 SKIP(0)
	      "*"
	      METDESC.P-SPCL2 SKIP(0)
	      SKIP(10) WITH FRAME H1 NO-BOX NO-LABELS.
  END.
