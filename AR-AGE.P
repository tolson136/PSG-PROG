DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE VARIABLE BEG# AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "ENTER BEGINNING CUSTOMER NUMBER".
DEFINE VARIABLE END# AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "ENTER ENDING CUSTOMER NUMBER   ".
DEFINE VARIABLE P1-DATE AS DATE FORMAT "99/99/9999"
    LABEL "ENTER PERIOD 1 DATE  ".
DEFINE VARIABLE P2-DATE AS DATE FORMAT "99/99/9999"
    LABEL "ENTER PERIOD 2 DATE  ".
DEFINE VARIABLE P3-DATE AS DATE FORMAT "99/99/9999"
    LABEL "ENTER PERIOD 3 DATE  ".
DEFINE VARIABLE P4-DATE AS DATE FORMAT "99/99/9999"
    LABEL "ENTER PERIOD 4 DATE  ".
DEFINE VARIABLE P5-DATE AS DATE FORMAT "99/99/9999"
    LABEL "ENTER PERIOD 5 DATE  ".
DEFINE VARIABLE XCTR AS INTEGER FORMAT "99".
DEFINE VARIABLE H-ACCT AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEFINE VARIABLE P0-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE P1-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE P2-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE P3-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE P4-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE P5-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE HP0-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE HP1-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE HP2-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE HP3-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE HP4-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE HP5-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE TP0-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE TP1-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE TP2-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE TP3-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE TP4-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE TP5-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE RPTDATE AS DATE.
DEFINE SHARED VARIABLE XCOM-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XDIV-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XOPR AS CHAR FORMAT "XXX".
DEFINE VAR ZER-BAL AS LOGICAL
       LABEL "INCLUDE ZERO BALANCE ACCOUNTS ON REPORT ?".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
DISPLAY SPACE(11)
"A/R   A G E   A N A L Y S I S   R E P O R T   S C R E E N          "
SKIP(4).
    UPDATE BEG# SKIP(2) WITH SIDE-LABELS COLOR DISPLAY NORMAL PROMPT W/MA.
    UPDATE END# SKIP(2) WITH SIDE-LABELS COLOR DISPLAY NORMAL PROMPT W/MA.
    UPDATE P5-DATE SKIP(0) WITH SIDE-LABELS COLOR DISPLAY NORMAL PROMPT W/MA.
    UPDATE P4-DATE SKIP(0) WITH SIDE-LABELS COLOR DISPLAY NORMAL PROMPT W/MA.
    UPDATE P3-DATE SKIP(0) WITH SIDE-LABELS COLOR DISPLAY NORMAL PROMPT W/MA.
    UPDATE P2-DATE SKIP(0) WITH SIDE-LABELS COLOR DISPLAY NORMAL PROMPT W/MA.
    UPDATE P1-DATE SKIP(0) WITH SIDE-LABELS COLOR DISPLAY NORMAL PROMPT W/MA.
    UPDATE ZER-BAL SKIP(0) WITH SIDE-LABELS COLOR DISPLAY NORMAL PROMPT W/MA.
    HIDE.
  OUTPUT TO PRINTER.
REPEAT:
     FOR EACH ACCT-RCV WHERE ACCT-RCV.COMP# = XCOM AND
			     ACCT-RCV.DIV# = XDIV AND
			     ACCT-RCV.CUST# >= BEG# AND
			     ACCT-RCV.CUST <= END#:
    IF NOT ZER-BAL AND TOT-BAL = 0.00 THEN NEXT.
    FORM HEADER TODAY FORMAT "99/99/9999"
      "CUSTOMER AGE ANALYSIS REPORT" AT 25
      "PAGE: " AT 65 PAGE-NUMBER FORMAT ">>9" SKIP(0)
      "COMPANY :" AT 25 XCOM-N SKIP(0)
      "DIVISION:" AT 25 XDIV-N "OPER:" AT 65 XOPR SKIP(0)
"--------------------------------------------------------------------------------" SKIP(0)
	    "ACCT NO." AT 1 "CUSTOMER NAME" AT 12 "TELEPHONE" AT 38
	    "LAST-PAY" AT 54 "SALES YTD" AT 68 SKIP(0)
	    "INVOICE NO" AT 1 "DATE" AT 14 "TY" AT 22 P1-DATE AT 26
	    P2-DATE AT 37 P3-DATE AT 48 P4-DATE AT 59 P5-DATE AT 70 SKIP(0)
	    "TOTAL BAL" AT 1 "FUTURE-BAL" AT 12 "PERIOD 1" AT 27
	    "PERIOD 2" AT 38 "PERIOD 3" AT 49 "PERIOD 4" AT 60
	    "PERIOD 5" AT 71 SKIP(0)
"--------------------------------------------------------------------------------" SKIP(1)
      WITH FRAME X PAGE-TOP NO-BOX NO-LABEL NO-UNDERLINE.
      VIEW FRAME X.
     DISPLAY
	      ACCT-RCV.CUST# AT 1
	      ACCT-RCV.C-NAME AT 12
	      ACCT-RCV.TELE AT 38
	      ACCT-RCV.LP-DATE AT 53
	      ACCT-RCV.SLS-YTD AT 63 SKIP(1) WITH NO-BOX NO-LABEL.
   P0-AMT = 0.0.
   P1-AMT = 0.0.
   P2-AMT = 0.0.
   P3-AMT = 0.0.
   P4-AMT = 0.0.
   P5-AMT = 0.0.
   REPEAT:
     FOR EACH TRANFILE OF ACCT-RCV
		       WHERE
			     TRANFILE.TR-STAT = "A"
			     BY TRANFILE.CUST# BY TRANFILE.T-DATE
			     BY TRANFILE.INV-NO:
     IF TRANFILE.T-DATE > P1-DATE
     THEN DO:
	IF TRANFILE.T-TYPE = "A" OR TRANFILE.T-TYPE = "D" OR
	   TRANFILE.T-TYPE = "G" OR TRANFILE.T-TYPE = "I" OR
	   TRANFILE.T-TYPE = "J" OR TRANFILE.T-TYPE = "N"
	   THEN DO:
	      P0-AMT = P0-AMT + TRANFILE.T-AMT.
	      TP0-AMT = TP0-AMT + TRANFILE.T-AMT.
	   END.
	   ELSE DO:
	      P0-AMT = P0-AMT - TRANFILE.T-AMT.
	      TP0-AMT = TP0-AMT - TRANFILE.T-AMT.
	   END.
     END.
     IF TRANFILE.T-DATE > P2-DATE AND TRANFILE.T-DATE <= P1-DATE
     THEN DO:
	IF TRANFILE.T-TYPE = "A" OR TRANFILE.T-TYPE = "D" OR
	   TRANFILE.T-TYPE = "G" OR TRANFILE.T-TYPE = "I" OR
	   TRANFILE.T-TYPE = "J" OR TRANFILE.T-TYPE = "N"
	   THEN DO:
	       XCTR = 26.
	       P1-AMT = P1-AMT + TRANFILE.T-AMT.
	       TP1-AMT = TP1-AMT + TRANFILE.T-AMT.
	       HP1-AMT = TRANFILE.T-AMT.
	   END.
	   ELSE DO:
	       XCTR = 26.
	       P1-AMT = P1-AMT - TRANFILE.T-AMT.
	       TP1-AMT = TP1-AMT - TRANFILE.T-AMT.
	       HP1-AMT = TRANFILE.T-AMT.
	   END.
     END.
     IF TRANFILE.T-DATE > P3-DATE AND TRANFILE.T-DATE <= P2-DATE
     THEN DO:
	IF TRANFILE.T-TYPE = "A" OR TRANFILE.T-TYPE = "D" OR
	   TRANFILE.T-TYPE = "G" OR TRANFILE.T-TYPE = "I" OR
	   TRANFILE.T-TYPE = "J" OR TRANFILE.T-TYPE = "N"
	   THEN DO:
	       XCTR = 37.
	       P2-AMT = P2-AMT + TRANFILE.T-AMT.
	       TP2-AMT = TP2-AMT + TRANFILE.T-AMT.
	       HP2-AMT = TRANFILE.T-AMT.
	   END.
	   ELSE DO:
	       XCTR = 37.
	       P2-AMT = P2-AMT - TRANFILE.T-AMT.
	       TP2-AMT = TP2-AMT - TRANFILE.T-AMT.
	       HP2-AMT = TRANFILE.T-AMT.
	   END.
     END.
     IF TRANFILE.T-DATE > P4-DATE AND TRANFILE.T-DATE <= P3-DATE
     THEN DO:
	IF TRANFILE.T-TYPE = "A" OR TRANFILE.T-TYPE = "D" OR
	   TRANFILE.T-TYPE = "G" OR TRANFILE.T-TYPE = "I" OR
	   TRANFILE.T-TYPE = "J" OR TRANFILE.T-TYPE = "N"
	   THEN DO:
	       XCTR = 48.
	       P3-AMT = P3-AMT + TRANFILE.T-AMT.
	       TP3-AMT = TP3-AMT + TRANFILE.T-AMT.
	       HP3-AMT = TRANFILE.T-AMT.
	   END.
	   ELSE DO:
	       XCTR = 48.
	       P3-AMT = P3-AMT - TRANFILE.T-AMT.
	       TP3-AMT = TP3-AMT - TRANFILE.T-AMT.
	       HP3-AMT = TRANFILE.T-AMT.
	   END.
     END.
     IF TRANFILE.T-DATE > P5-DATE AND TRANFILE.T-DATE <= P4-DATE
     THEN DO:
	IF TRANFILE.T-TYPE = "A" OR TRANFILE.T-TYPE = "D" OR
	   TRANFILE.T-TYPE = "G" OR TRANFILE.T-TYPE = "I" OR
	   TRANFILE.T-TYPE = "J" OR TRANFILE.T-TYPE = "N"
	   THEN DO:
	       XCTR = 59.
	       P4-AMT = P4-AMT + TRANFILE.T-AMT.
	       TP4-AMT = TP4-AMT + TRANFILE.T-AMT.
	       HP4-AMT = TRANFILE.T-AMT.
	   END.
	   ELSE DO:
	       XCTR = 59.
	       P4-AMT = P4-AMT - TRANFILE.T-AMT.
	       TP4-AMT = TP4-AMT - TRANFILE.T-AMT.
	       HP4-AMT = TRANFILE.T-AMT.
	   END.
     END.
     IF TRANFILE.T-DATE <= P5-DATE
     THEN DO:
	IF TRANFILE.T-TYPE = "A" OR TRANFILE.T-TYPE = "D" OR
	   TRANFILE.T-TYPE = "G" OR TRANFILE.T-TYPE = "I" OR
	   TRANFILE.T-TYPE = "J" OR TRANFILE.T-TYPE = "N"
	   THEN DO:
	       XCTR = 70.
	       P5-AMT = P5-AMT + TRANFILE.T-AMT.
	       TP5-AMT = TP5-AMT + TRANFILE.T-AMT.
	       HP5-AMT = TRANFILE.T-AMT.
	   END.
	   ELSE DO:
	       XCTR = 70.
	       P5-AMT = P5-AMT - TRANFILE.T-AMT.
	       TP5-AMT = TP5-AMT - TRANFILE.T-AMT.
	       HP5-AMT = TRANFILE.T-AMT.
	   END.
     END.
     DISPLAY
	     TRANFILE.INV-NO
	     TRANFILE.T-DATE
	     TRANFILE.T-TYPE WITH NO-BOX NO-LABEL.
    IF XCTR = 26 THEN DISPLAY HP1-AMT AT 26 WITH NO-BOX NO-LABEL.
    IF XCTR = 37 THEN DISPLAY HP2-AMT AT 37 WITH NO-BOX NO-LABEL.
    IF XCTR = 48 THEN DISPLAY HP3-AMT AT 48 WITH NO-BOX NO-LABEL.
    IF XCTR = 59 THEN DISPLAY HP4-AMT AT 59 WITH NO-BOX NO-LABEL.
    IF XCTR = 70 THEN DISPLAY HP5-AMT AT 70 WITH NO-BOX NO-LABEL.
   END.
   DISPLAY SKIP(1) P1-AMT + P2-AMT + P3-AMT + P4-AMT + P5-AMT AT 1
		   FORMAT "->>>>>>.99"
		   P0-AMT AT 12
		   P1-AMT AT 26
		   P2-AMT AT 37
		   P3-AMT AT 48
		   P4-AMT AT 59
		   P5-AMT AT 70 SKIP(0)
"--------------------------------------------------------------------------------" SKIP(1) WITH NO-BOX NO-LABEL.
    LEAVE.
  END.
 END.
 DISPLAY SKIP(2) TP1-AMT + TP2-AMT + TP3-AMT + TP4-AMT + TP5-AMT AT 1
		 FORMAT "->>>>>>.99"
		 TP0-AMT AT 12
		 TP1-AMT AT 26
		 TP2-AMT AT 37
		 TP3-AMT AT 48
		 TP4-AMT AT 59
		 TP5-AMT AT 70 SKIP(1)
"T  O  T  A  L  S      T  O  T  A  L  S      T  O  T  A  L  S" AT 10
WITH NO-BOX NO-LABEL.
   LEAVE.
END.
