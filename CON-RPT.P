DEFINE SHARED VARIABLE XCOM-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XDIV-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XOPR AS CHAR FORMAT "XXX".
DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE VARIABLE BEG# AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "ENTER BEGINNING CONTRACT NUMBER".
DEFINE VARIABLE END# AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "ENTER ENDING CONTRACT NUMBER   ".
DEFINE VARIABLE RPTDATE AS DATE FORMAT "99/99/9999".
DEFINE VARIABLE SEQ AS CHAR FORMAT "X"
    LABEL "     ALPHA OR NUMERIC SEQUENCE  A/N      ".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
DISPLAY SPACE(10)
"C O N T R A C T   R E P O R T   R E Q U E S T   S C R E E N         "
SKIP(1).
    UPDATE BEG# WITH ROW FRAME-ROW + 5 + FRAME-LINE + 5 COLUMN 17
       SIDE-LABELS OVERLAY FRAME A
       COLOR DISPLAY WHITE/RED PROMPT RED/WHITE.
    UPDATE END# WITH ROW FRAME-ROW + 5 + FRAME-LINE + 5 COLUMN 17
       SIDE-LABELS OVERLAY FRAME B
       COLOR DISPLAY WHITE/RED PROMPT RED/WHITE.
    UPDATE SEQ WITH ROW FRAME-ROW + 5 + FRAME-LINE + 5 COLUMN 17
       SIDE-LABELS OVERLAY FRAME C
       COLOR DISPLAY WHITE/RED PROMPT RED/WHITE.
  OUTPUT TO PRINTER.
IF SEQ = "N" THEN DO:
  RPTDATE = TODAY.
  FOR EACH METPRO WHERE METPRO.PROPSL# >= BEG# AND
			METPRO.PROPSL# <= END# AND
			METPRO.COMP# = XCOM  AND
			METPRO.DIV#  = XDIV BY METPRO.CUST#:
    FORM HEADER RPTDATE FORMAT "99/99/9999"
		"REPORT ALL CONTRACTS FOR GIVEN RANGE" AT 22
		"PAGE:" AT 65 PAGE-NUMBER FORMAT ">>9" SKIP(0)
		"OPER: " AT 65 XOPR SKIP(0)
		"NUMERIC" AT 36 SKIP(2).
    DISPLAY
	    METPRO.PROPSL# LABEL "CONTRACT"
	    METPRO.COMP# LABEL "CO" SPACE(2)
	    METPRO.DIV# LABEL "DV" SPACE(2)
	    METPRO.C-NAME LABEL "CUSTOMER NAME" SPACE(2)
	    METPRO.CUST# LABEL "CUSTOMER #" SPACE(2)
	    METPRO.DATE-P LABEL "DATE".
END.
END.
ELSE DO:
  RPTDATE = TODAY.
  FOR EACH METPRO WHERE METPRO.PROPSL# >= BEG# AND
			METPRO.PROPSL# <= END# AND
			METPRO.COMP# = XCOM  AND
			METPRO.DIV#  = XDIV BY METPRO.C-NAME:
    FORM HEADER RPTDATE FORMAT "99/99/9999"
		"REPORT ALL CONTRACTS FOR GIVEN RANGE" AT 22
		"PAGE:" AT 65 PAGE-NUMBER FORMAT ">>9" SKIP(0)
		"OPER: " AT 65 XOPR SKIP(0)
		"ALPHA" AT 37 SKIP(2).
    DISPLAY
	    METPRO.PROPSL# LABEL "CONTRACT"
	    METPRO.COMP# LABEL "CO" SPACE(2)
	    METPRO.DIV# LABEL "DV" SPACE(2)
	    METPRO.C-NAME LABEL "CUSTOMER NAME" SPACE(2)
	    METPRO.CUST# LABEL "CUSTOMER #" SPACE(2)
	    METPRO.DATE-P LABEL "DATE".
END.
END.
