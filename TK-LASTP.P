DEFINE SHARED VARIABLE XCOM-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XDIV-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XOPR AS CHAR FORMAT "XXX".
DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE VARIABLE BEG# AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "ENTER BEGINNING CUSTOMER NUMBER".
DEFINE VARIABLE END# AS DECIMAL FORMAT "ZZZZZZZZZZ"
    LABEL "ENTER ENDING CUSTOMER NUMBER   ".
DEFINE VARIABLE RPTDATE AS DATE FORMAT "99/99/9999".
IF (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
DISPLAY SPACE(4)
"    L A S T   C L E A N I N G   D A T E   R E P O R T   S C R E E N    "
SKIP(0) WITH FRAME A NO-BOX.
DISPLAY "COMPANY: " XCOM SPACE(25) "DIVISION: " XDIV SKIP(1)
WITH FRAME AA NO-BOX NO-LABELS.
    UPDATE BEG# WITH ROW FRAME-ROW + 5 + FRAME-LINE + 5 COLUMN 17
       SIDE-LABELS OVERLAY FRAME X
       COLOR DISPLAY WHITE/RED PROMPT RED/WHITE.
    IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
    UPDATE END# WITH ROW FRAME-ROW + 5 + FRAME-LINE + 5 COLUMN 17
       SIDE-LABELS OVERLAY FRAME B
       COLOR DISPLAY WHITE/RED PROMPT RED/WHITE.
    IF LASTKEY = KEYCODE("F4") OR LASTKEY = KEYCODE("ESC") THEN LEAVE.
  OUTPUT TO PRINTER.
  RPTDATE = TODAY.
  FOR EACH METDESC WHERE METDESC.COMP# = XCOM AND
			  METDESC.DIV# = XDIV AND
			  METDESC.CUST# >= BEG# AND
			  METDESC.CUST# <= END#
			  BY METDESC.CUST#
			  BY METDESC.PROPSL#
			  BY METDESC.ITEM#:
       FIND FIRST METPRO WHERE METPRO.COMP# = XCOM AND
			       METPRO.DIV# = XDIV AND
			       METPRO.CUST# = METDESC.CUST# AND
			       METPRO.PROPSL# = METDESC.PROPSL# NO-ERROR.
       IF NOT AVAILABLE METPRO THEN NEXT.
       FORM HEADER RPTDATE FORMAT "99/99/9999"
	    "LAST CLEANING DATE REPORT" AT 28
	    "PAGE:" AT 65 PAGE-NUMBER FORMAT ">>9" SKIP(0)
	    "COMPANY: " AT 21 XCOM-N SKIP(0)
	    "DIVISION: " AT 21 XDIV-N "OPER: " AT 65 XOPR SKIP(1)
	    "CUST NUMBER" AT 1 "CUSTOMER NAME" AT 15 "LOCATION" AT 50 SKIP(0)
	    "ITEM #" AT 1 "PROPOSAL #" AT 10 "FREQUENCY" AT 25
	    "LAST CLEANING" AT 60 SKIP(0).
    DISPLAY
	    METPRO.CUST# AT 1
	    METPRO.C-NAME AT 15
	    METPRO.L-NAME AT 50 SKIP(0)
	    METDESC.ITEM# AT 1
	    METPRO.PROPSL# AT 10
	    METDESC.P-FREQ AT 25
	    METDESC.P-CL-DATE AT 60 SKIP(0)
	    METDESC.ITEM# AT 1
	    METPRO.PROPSL# AT 10
	    METDESC.S-FREQ AT 25
	    METDESC.S-CL-DATE AT 60 SKIP(0)
	    WITH NO-BOX NO-LABELS.
  END.
