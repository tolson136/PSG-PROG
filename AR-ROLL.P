DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE VARIABLE P1-DATE AS DATE FORMAT "99/99/9999"
    LABEL "ENTER PERIOD 1 DATE (MOST CURRENT)".
DEFINE VARIABLE P2-DATE AS DATE FORMAT "99/99/9999"
    LABEL "ENTER PERIOD 2 DATE               ".
DEFINE VARIABLE P3-DATE AS DATE FORMAT "99/99/9999"
    LABEL "ENTER PERIOD 3 DATE               ".
DEFINE VARIABLE P4-DATE AS DATE FORMAT "99/99/9999"
    LABEL "ENTER PERIOD 4 DATE (OLDEST)      ".
DEFINE VARIABLE P0-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE P1-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE P2-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE P3-AMT AS DECIMAL FORMAT "->>>>>>.99".
DEFINE VARIABLE P4-AMT AS DECIMAL FORMAT "->>>>>>.99".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
DISPLAY SPACE(15)
"A/R   M O N T H L Y   R O L L   B A L A N C E   S C R E E N" SKIP(4)
    WITH NO-BOX.
    UPDATE P4-DATE SKIP(0) P3-DATE SKIP(0) P2-DATE SKIP(0) P1-DATE
    WITH SIDE-LABELS COLOR DISPLAY NORMAL PROMPT W/MA.
FOR EACH ACCT-RCV WHERE ACCT-RCV.COMP# = XCOM AND
			ACCT-RCV.DIV# = XDIV:
   P0-AMT = 0.0.
   P1-AMT = 0.0.
   P2-AMT = 0.0.
   P3-AMT = 0.0.
   P4-AMT = 0.0.
     FOR EACH TRANFILE OF ACCT-RCV:
     IF TRANFILE.T-DATE > P1-DATE AND TR-STAT = "A"
     THEN DO:
	IF TRANFILE.T-TYPE = "A" OR TRANFILE.T-TYPE = "D" OR
	   TRANFILE.T-TYPE = "G" OR TRANFILE.T-TYPE = "I" OR
	   TRANFILE.T-TYPE = "J" OR TRANFILE.T-TYPE = "N"
	   THEN P0-AMT = P0-AMT + TRANFILE.T-AMT.
	   ELSE P0-AMT = P0-AMT - TRANFILE.T-AMT.
     END.
     IF TRANFILE.T-DATE > P2-DATE AND TRANFILE.T-DATE <= P1-DATE AND
	TR-STAT = "A"
     THEN DO:
	IF TRANFILE.T-TYPE = "A" OR TRANFILE.T-TYPE = "D" OR
	   TRANFILE.T-TYPE = "G" OR TRANFILE.T-TYPE = "I" OR
	   TRANFILE.T-TYPE = "J" OR TRANFILE.T-TYPE = "N"
	   THEN P1-AMT = P1-AMT + TRANFILE.T-AMT.
	   ELSE P1-AMT = P1-AMT - TRANFILE.T-AMT.
     END.
     IF TRANFILE.T-DATE > P3-DATE AND TRANFILE.T-DATE <= P2-DATE AND
	TR-STAT = "A"
     THEN DO:
	IF TRANFILE.T-TYPE = "A" OR TRANFILE.T-TYPE = "D" OR
	   TRANFILE.T-TYPE = "G" OR TRANFILE.T-TYPE = "I" OR
	   TRANFILE.T-TYPE = "J" OR TRANFILE.T-TYPE = "N"
	   THEN P2-AMT = P2-AMT + TRANFILE.T-AMT.
	   ELSE P2-AMT = P2-AMT - TRANFILE.T-AMT.
     END.
     IF TRANFILE.T-DATE > P4-DATE AND TRANFILE.T-DATE <= P3-DATE AND
	TR-STAT = "A"
     THEN DO:
	IF TRANFILE.T-TYPE = "A" OR TRANFILE.T-TYPE = "D" OR
	   TRANFILE.T-TYPE = "G" OR TRANFILE.T-TYPE = "I" OR
	   TRANFILE.T-TYPE = "J" OR TRANFILE.T-TYPE = "N"
	   THEN P3-AMT = P3-AMT + TRANFILE.T-AMT.
	   ELSE P3-AMT = P3-AMT - TRANFILE.T-AMT.
     END.
     IF TRANFILE.T-DATE <= P4-DATE AND TR-STAT = "A"
     THEN DO:
	IF TRANFILE.T-TYPE = "A" OR TRANFILE.T-TYPE = "D" OR
	   TRANFILE.T-TYPE = "G" OR TRANFILE.T-TYPE = "I" OR
	   TRANFILE.T-TYPE = "J" OR TRANFILE.T-TYPE = "N"
	   THEN P4-AMT = P4-AMT + TRANFILE.T-AMT.
	   ELSE P4-AMT = P4-AMT - TRANFILE.T-AMT.
     END.
  END.
 UPDATE ACCT-RCV.FUTR-DUE = P0-AMT.
 UPDATE ACCT-RCV.BAL-1 = P1-AMT.
 UPDATE ACCT-RCV.BAL-2 = P2-AMT.
 UPDATE ACCT-RCV.BAL-3 = P3-AMT.
 UPDATE ACCT-RCV.BAL-4 = P4-AMT.
 UPDATE ACCT-RCV.TOT-BAL = P0-AMT + P1-AMT + P2-AMT + P3-AMT + P4-AMT.
END.
