DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XCOM-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XDIV-N AS CHAR FORMAT "X(30)".
DEFINE VARIABLE BEG# AS INTEGER FORMAT "ZZ"
  LABEL "ENTER MONTH & YEAR FOR WHICH YOU WANT TO RUN TICKETS".
DEFINE VARIABLE H-FREQ AS CHAR FORMAT "X(10)".
DEF VAR B-CUST AS DECIMAL FORMAT "ZZZZZZZZZZ"
  LABEL "ENTER BEGINNING TICKET CUST # TO DELETE".
DEF VAR E-CUST AS DECIMAL FORMAT "ZZZZZZZZZZ"
  LABEL "ENTER ENDING TICKET CUST # TO DELETE".
DEFINE VARIABLE D2 AS DECIMAL FORMAT "9999.99".
DEFINE VARIABLE D3 AS DECIMAL FORMAT "9999".
DEFINE VARIABLE D4 AS DECIMAL FORMAT "9999.99".
DEFINE VARIABLE D5 AS INTEGER FORMAT "9999" LABEL "YEAR (4 DIGITS)".
DEFINE VARIABLE L-YEAR AS LOGICAL.
DEFINE VARIABLE TICKS AS INTEGER FORMAT "9999".
DEFINE VARIABLE F-TICK AS LOGICAL.
DEFINE VARIABLE H-WEEK AS INTEGER FORMAT "9".
DEFINE VARIABLE DY AS INTEGER FORMAT "99".
DEFINE VARIABLE UP-LIM AS INTEGER FORMAT "99".
DEFINE VARIABLE C-DATE AS DATE FORMAT "99/99/9999".
DEFINE VAR T-DL AS DECIMAL FORMAT "$->,>>>,>>>.99".
DEFINE VAR T-BILL AS DECIMAL FORMAT "$->,>>>,>>>.99".
DEFINE VAR H-MON AS CHARACTER FORMAT "X(10)".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
T-DL = 0.00.
T-BILL = 0.00.
DISPLAY SPACE(11)
"M O N T H L Y   T I C K E T   D E L E T E   S C R E E N"
    SKIP(1) SPACE(20)
XCOM-N LABEL "COMPANY" SKIP(0) SPACE(20) XDIV-N LABEL "DIVISION"
SKIP(5) WITH FRAME A NO-BOX SIDE-LABELS.
REPEAT:
UPDATE BEG# D5 WITH NO-BOX SIDE-LABELS.
IF BEG# = 2 THEN DO:
    D2 = D5 / 4.
    D3 = TRUNCATE(D2, 0).
    D4 = D3.
    IF D4 = D2 THEN L-YEAR = yes.
END.
IF BEG# = 1 THEN DO:
    UP-LIM = 31.
    H-MON = "JANUARY".
END.
IF BEG# = 2 AND L-YEAR THEN DO:
    UP-LIM = 29.
    H-MON = "FEBRUARY".
END.
IF BEG# = 2 AND NOT L-YEAR THEN DO:
    UP-LIM = 28.
    H-MON = "FEBRUARY".
END.
IF BEG# = 3 THEN DO:
    UP-LIM = 31.
    H-MON = "MARCH".
END.
IF BEG# = 4 THEN DO:
    UP-LIM = 30.
    H-MON = "APRIL".
END.
IF BEG# = 5 THEN DO:
    UP-LIM = 31.
    H-MON = "MAY".
END.
IF BEG# = 6 THEN DO:
    UP-LIM = 30.
    H-MON = "JUNE".
END.
IF BEG# = 7 THEN DO:
    UP-LIM = 31.
    H-MON = "JULY".
END.
IF BEG# = 8 THEN DO:
    UP-LIM = 31.
    H-MON = "AUGUST".
END.
IF BEG# = 9 THEN DO:
    UP-LIM = 30.
    H-MON = "SEPTEMBER".
END.
IF BEG# = 10 THEN DO:
    UP-LIM = 31.
    H-MON = "OCTOBER".
END.
IF BEG# = 11 THEN DO:
    UP-LIM = 30.
    H-MON = "NOVEMBER".
END.
IF BEG# = 12 THEN DO:
    UP-LIM = 31.
    H-MON = "DECEMBER".
END.
IF BEG# > 0 AND BEG# < 13 THEN LEAVE.
END.
UPDATE SKIP(1) B-CUST WITH NO-BOX SIDE-LABELS.
UPDATE SKIP(1) E-CUST WITH NO-BOX SIDE-LABELS.
IF LASTKEY = KEYCODE("F4") THEN LEAVE.
IF LASTKEY = KEYCODE("ESC") THEN LEAVE.
HIDE.
OUTPUT TO PRINTER.
FOR EACH TICKET WHERE TICKET.COMP# = XCOM AND TICKET.DIV# = XDIV AND
		      TICKET.MONTH# = BEG# AND TICKET.CUST# >= B-CUST AND
		      TICKET.CUST# <= E-CUST AND TICKET.T-STAT = "P"
		      BY TICKET.CUST# BY TICKET.PROPSL#
		      BY TICKET.ITEM# BY TICKET.T-INDX:
FORM HEADER "DELETED TICKETS" AT 32.
DISPLAY TICKET.COMP# TICKET.DIV# TICKET.CUST# TICKET.PROPSL# TICKET.ITEM#
	TICKET.MONTH# TICKET.T-INDX.
DELETE TICKET.
END.
