DEFINE SHARED VARIABLE XCOM AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XDIV AS INTEGER FORMAT "ZZ".
DEFINE SHARED VARIABLE XCOM-N AS CHAR FORMAT "X(30)".
DEFINE SHARED VARIABLE XDIV-N AS CHAR FORMAT "X(30)".
DEF VAR FINV AS DECIMAL FORMAT "ZZZZZZZZZZ"
  LABEL "ENTER BEGINNING INVOICE NUMBER".
DEF SHARED VAR XOPR AS CHAR FORMAT "XXX".
DEF VAR XPROP AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEF VAR XITEM AS DECIMAL FORMAT "ZZZZZZZZZZ".
DEF VAR XINV AS DECIMAL FORMAT "$->,>>>,>>>.99".
DEF VAR XDATE AS DATE FORMAT "99/99/9999".
DEF VAR F-TOT AS DECIMAL FORMAT "->>>,>>>.99".
DEF VAR S-TOT AS DECIMAL FORMAT "$->>>,>>>.99".
DEF VAR T-TOT AS DECIMAL FORMAT "->>>,>>>.99".
DEF VAR H-COMMIS AS DECIMAL.
DEF VAR H-SUBCON AS DECIMAL.
DEFINE VARIABLE MN AS CHAR FORMAT "XX".
DEFINE VARIABLE DA AS CHAR FORMAT "XX".
DEFINE VARIABLE YR AS CHAR FORMAT "XXXX".
DEFINE VARIABLE MNN AS INTEGER FORMAT "99".
DEFINE VARIABLE DAN AS INTEGER FORMAT "99".
DEFINE VARIABLE YRN AS INTEGER FORMAT "9999".
DEFINE VARIABLE P-PERIOD AS CHAR FORMAT "XXXXXX".
DEF VAR ARD AS CHAR FORMAT "X(60)".
DEF VAR XMONTH AS CHAR FORMAT "X(9)".
DEF VAR CTR AS INTEGER FORMAT "99".
DEF VAR SALZ AS INTEGER FORMAT "ZZZ".
DEF VAR BEG# AS DATE FORMAT "99/99/9999"
 LABEL "MONTH OF SERVICE DATE OF THESE INVOICES".
DEF VAR BEGG AS INTEGER FORMAT "ZZ".
IF (USERID = "OPERATIONS") OR (USERID = "LANDMARK") OR (USERID = "GARCIA")
THEN DO:
    MESSAGE "YOU ARE NOT AUTHORIZED TO RUN THIS PROCEDURE".
    RETURN.
END.
S-TOT = 0.0.
T-TOT = 0.0.
REPEAT:
UPDATE SKIP(10) BEG#
  WITH FRAME ZZZ NO-BOX SIDE-LABELS COLOR DISPLAY NORMAL PROMPT W/MA.
/* UPDATE SKIP(2) SPACE(10) FINV
  WITH FRAME ZZZ NO-BOX SIDE-LABELS COLOR DISPLAY NORMAL PROMPT W/MA. */
  BEGG = MONTH(BEG#).
IF BEGG > 0 AND BEGG < 13 THEN LEAVE.
END.
  IF BEGG = 1 THEN XMONTH = "JANUARY  ".
  IF BEGG = 2 THEN XMONTH = "FEBRUARY ".
  IF BEGG = 3 THEN XMONTH = "MARCH    ".
  IF BEGG = 4 THEN XMONTH = "APRIL    ".
  IF BEGG = 5 THEN XMONTH = "MAY      ".
  IF BEGG = 6 THEN XMONTH = "JUNE     ".
  IF BEGG = 7 THEN XMONTH = "JULY     ".
  IF BEGG = 8 THEN XMONTH = "AUGUST   ".
  IF BEGG = 9 THEN XMONTH = "SEPTEMBER".
  IF BEGG = 10 THEN XMONTH = "OCTOBER  ".
  IF BEGG = 11 THEN XMONTH = "NOVEMBER ".
  IF BEGG = 12 THEN XMONTH = "DECEMBER ".
/* OUTPUT TO PRINTER PAGE-SIZE 0. */
  FOR EACH INVOICE WHERE INVOICE.COMP# = XCOM AND
                         INVOICE.DIV# = XDIV AND
                         invoice.route# = 0 and
                         INVOICE.I-TYPE = "N"
                         BREAK BY INVOICE.ORD-NO BY INVOICE.ITEM#:
    FIND ACCT-RCV WHERE ACCT-RCV.COMP# = INVOICE.COMP# AND
                        ACCT-RCV.DIV# = INVOICE.DIV# AND
                        ACCT-RCV.CUST# = INVOICE.CUST#.
    FIND PROPSL WHERE PROPSL.COMP# = INVOICE.COMP# AND
                      PROPSL.DIV# = INVOICE.DIV# AND
                      PROPSL.CUST# = INVOICE.CUST# AND
                      PROPSL.PROPSL# = INVOICE.PROPSL#.
    FIND PRO-DESP WHERE PRO-DESP.COMP# = INVOICE.COMP# AND
                        PRO-DESP.DIV# = INVOICE.DIV# AND
                        PRO-DESP.CUST# = INVOICE.CUST# AND
                        PRO-DESP.PROPSL# = INVOICE.PROPSL# AND
                        PRO-DESP.ITEM# = INVOICE.ITEM#.
    SALZ = 0.
    FIND SALESMAN WHERE SALESMAN.SLS# = INVOICE.SLS# NO-ERROR.
    IF AVAILABLE SALESMAN THEN DO:
        SALZ = INVOICE.SLS#.
    END.
IF FIRST-OF(INVOICE.ORD-NO) THEN DO:
  find first syscontrol exclusive-lock.
  finv = syscontrol.next-inv.
  syscontrol.next-inv = finv + 1.
  release syscontrol.
  T-TOT = 0.0.
  F-TOT = 0.0.
  CTR = 0.
/*  DISPLAY SKIP(9) SPACE(12)
          TRIM(STRING(INVOICE.CUST#, ">>>>>>>>>>")) + "-" +
          TRIM(STRING(INVOICE.PROPSL#, ">>>>>>>>>>")) FORMAT "X(25)"
          SKIP(0)
          SPACE(3) ACCT-RCV.C-NAME SPACE(16) PROPSL.L-NAME SKIP(0)
          SPACE(3) ACCT-RCV.ADDR-1 SPACE(16) PROPSL.LADDR01 SKIP(0)
          WITH FRAME A NO-BOX NO-LABELS.
 IF ACCT-RCV.ADDR-5 <> "" THEN DO:
   DISPLAY SPACE(3) ACCT-RCV.ADDR-2 SPACE(16) PROPSL.LADDR02 SKIP(0)
           SPACE(3) ACCT-RCV.ADDR-3 SPACE(16) PROPSL.LADDR03 SKIP(0)
           SPACE(3) ACCT-RCV.ADDR-4 SPACE(17) PROPSL.STATE SKIP(0)
           SPACE(3) ACCT-RCV.ADDR-5 + ", " + ACCT-RCV.STATE + " "
           FORMAT "X(25)" ACCT-RCV.ZIP FORMAT "99999-9999" SKIP(1)
           WITH FRAME BB NO-BOX NO-LABELS.
   END.
 ELSE
  IF ACCT-RCV.ADDR-4 <> "" THEN DO:
    DISPLAY SPACE(3) ACCT-RCV.ADDR-2 SPACE(16) PROPSL.LADDR02 SKIP(0)
            SPACE(3) ACCT-RCV.ADDR-3 SPACE(16) PROPSL.LADDR03 SKIP(0)
            SPACE(3) ACCT-RCV.ADDR-4 + ", " + ACCT-RCV.STATE + " "
            FORMAT "X(25)" ACCT-RCV.ZIP FORMAT "99999-9999" SPACE(5)
            PROPSL.STATE SKIP(2) WITH FRAME B NO-BOX NO-LABELS.
      END.
      ELSE
       IF ACCT-RCV.ADDR-3 <> "" THEN DO:
          DISPLAY
              SPACE(3) ACCT-RCV.ADDR-2 SPACE(16) PROPSL.LADDR02 SKIP(0)
              SPACE(3) ACCT-RCV.ADDR-3 + ", " + ACCT-RCV.STATE + " "
              FORMAT "X(25)" ACCT-RCV.ZIP FORMAT "99999-9999" SPACE(5)
              PROPSL.LADDR03 SKIP(0) SPACE(45) PROPSL.STATE SKIP(2)
              WITH FRAME C NO-BOX NO-LABELS.
      END.
      ELSE
       IF ACCT-RCV.ADDR-2 <> "" THEN DO:
          DISPLAY
              SPACE(3) ACCT-RCV.ADDR-2 + ", " + ACCT-RCV.STATE + " "
              FORMAT "X(25)" ACCT-RCV.ZIP FORMAT "99999-9999" SPACE(5)
              PROPSL.LADDR02 SKIP(0) SPACE(44)
              PROPSL.LADDR03 SKIP(0) SPACE(45) PROPSL.STATE SKIP(2)
              WITH FRAME CC NO-BOX NO-LABELS.
       END.                  */
  UPDATE INVOICE.I-DATE = BEG#.
  UPDATE INVOICE.INV-NO = FINV.
/*  DISPLAY SPACE(3) XMONTH SPACE(15) SALZ SPACE(5)
  SPACE(19) INVOICE.I-DATE SPACE(4) INVOICE.INV-NO SKIP(1)
  WITH FRAME D NO-BOX NO-LABELS.       */
END.
ELSE DO:
  UPDATE INVOICE.I-DATE = BEG#.
END.
    FIND FIRST AR-DESP WHERE AR-DESP.COMP# = INVOICE.COMP# AND
                             AR-DESP.DIV# = INVOICE.DIV# AND
                             AR-DESP.CUST# = INVOICE.CUST# AND
                             AR-DESP.PROPSL# = INVOICE.PROPSL# AND
                             AR-DESP.ITEM# = INVOICE.ITEM# NO-ERROR.
    IF NOT AVAILABLE AR-DESP THEN DO:
        ARD = "".
    END.
    ELSE DO:
        ARD = AR-DESP.DESC01.
    END.
/*  VIEW FRAME E.   */
   UPDATE INVOICE.DESC01 = ARD.
IF CTR > 16 THEN DO:
  CTR = 0.
/*  DISPLAY SKIP(0)
          SPACE(2) "- - - CONTINUED ON NEXT PAGE - - -" SKIP(13) SPACE(12)
          TRIM(STRING(INVOICE.CUST#, ">>>>>>>>>>")) + "-" +
          TRIM(STRING(INVOICE.PROPSL#, ">>>>>>>>>>")) FORMAT "X(25)"
          SKIP(0)
          SPACE(3) ACCT-RCV.C-NAME SPACE(16) PROPSL.L-NAME SKIP(0)
          SPACE(3) ACCT-RCV.ADDR-1 SPACE(16) PROPSL.LADDR01 SKIP(0)
          WITH FRAME ZA NO-BOX NO-LABELS.
 IF ACCT-RCV.ADDR-5 <> "" THEN DO:
   DISPLAY SPACE(3) ACCT-RCV.ADDR-2 SPACE(16) PROPSL.LADDR02 SKIP(0)
           SPACE(3) ACCT-RCV.ADDR-3 SPACE(16) PROPSL.LADDR03 SKIP(0)
           SPACE(3) ACCT-RCV.ADDR-4 SPACE(17) PROPSL.STATE SKIP(0)
           SPACE(3) ACCT-RCV.ADDR-5 + ", " + ACCT-RCV.STATE + " "
           FORMAT "X(25)" ACCT-RCV.ZIP FORMAT "99999-9999" SKIP(1)
           WITH FRAME ZB NO-BOX NO-LABELS.
   END.
 ELSE
  IF ACCT-RCV.ADDR-4 <> "" THEN DO:
    DISPLAY SPACE(3) ACCT-RCV.ADDR-2 SPACE(16) PROPSL.LADDR02 SKIP(0)
            SPACE(3) ACCT-RCV.ADDR-3 SPACE(16) PROPSL.LADDR03 SKIP(0)
            SPACE(3) ACCT-RCV.ADDR-4 + ", " + ACCT-RCV.STATE + " "
            FORMAT "X(25)" ACCT-RCV.ZIP FORMAT "99999-9999" SPACE(5)
            PROPSL.STATE SKIP(2) WITH FRAME ZC NO-BOX NO-LABELS.
      END.
      ELSE
       IF ACCT-RCV.ADDR-3 <> "" THEN DO:
          DISPLAY
              SPACE(3) ACCT-RCV.ADDR-2 SPACE(16) PROPSL.LADDR02 SKIP(0)
              SPACE(3) ACCT-RCV.ADDR-3 + ", " + ACCT-RCV.STATE + " "
              FORMAT "X(25)" ACCT-RCV.ZIP FORMAT "99999-9999" SPACE(5)
              PROPSL.LADDR03 SKIP(0) SPACE(45) PROPSL.STATE SKIP(2)
              WITH FRAME ZD NO-BOX NO-LABELS.
      END.
      ELSE
       IF ACCT-RCV.ADDR-2 <> "" THEN DO:
          DISPLAY
              SPACE(3) ACCT-RCV.ADDR-2 + ", " + ACCT-RCV.STATE + " "
              FORMAT "X(25)" ACCT-RCV.ZIP FORMAT "99999-9999" SPACE(5)
              PROPSL.LADDR02 SKIP(0) SPACE(44)
              PROPSL.LADDR03 SKIP(0) SPACE(45) PROPSL.STATE SKIP(2)
              WITH FRAME ZE NO-BOX NO-LABELS.
       END.          */
  UPDATE INVOICE.I-DATE = BEG#.
  UPDATE INVOICE.INV-NO = FINV.
/*  DISPLAY SPACE(3) XMONTH SPACE(18) SALZ SPACE(21)
  INVOICE.I-DATE SPACE(4) INVOICE.INV-NO SKIP(1)
  WITH FRAME ZF NO-BOX NO-LABELS.              */
END.
ELSE DO:
  UPDATE INVOICE.I-DATE = BEG#.
  UPDATE INVOICE.INV-NO = FINV.
END.
      UPDATE MNN = MONTH(INVOICE.C-DATE).
      UPDATE DAN = DAY(INVOICE.C-DATE).
/*      DISPLAY INVOICE.ITEM# SPACE(2)
      ARD SPACE(3)
      INVOICE.TOT-INV FORMAT "->>>,>>>.99" SKIP(0)
      "PO#:" PRO-DESP.PO# SPACE(2) "SUB#:" PRO-DESP.SUB#
      "ROUTE#:" PRO-DESP.ROUTE# SPACE(2) "DATE:" INVOICE.C-DATE
          WITH FRAME E NO-BOX NO-LABELS.
          view frame e.  */
      T-TOT = T-TOT + INVOICE.TOT-INV.
      CTR = CTR + 2.
      IF LAST-OF(INVOICE.ORD-NO) THEN DO:
          IF ACCT-RCV.FUEL_SUR AND ACCT-RCV.FUEL% > 0.00 THEN DO:
            UPDATE MNN = MONTH(INVOICE.I-DATE).
            UPDATE YRN = YEAR(INVOICE.I-DATE).
            MN = STRING(MNN,"99").
            YR = STRING(YRN,"9999").
            UPDATE P-PERIOD = STRING(MN + YR,"XXXXXX").
            F-TOT = 0.00.
            F-TOT = T-TOT * ACCT-RCV.FUEL%.
            CREATE TRANFILE.
            SET TRANFILE.SUB# = 0.
            SET TRANFILE.ROUTE# = 0.
            SET TRANFILE.AGE = "1".
            SET TRANFILE.REC# = 0.
            SET TRANFILE.CHECK# = "".
            SET TRANFILE.COMP# = INVOICE.COMP#.
            SET TRANFILE.DIV# = INVOICE.DIV#.
            SET TRANFILE.CUST# = INVOICE.CUST#.
            SET TRANFILE.INV-NO = INVOICE.INV-NO.
            SET TRANFILE.PERIOD = P-PERIOD.
            SET TRANFILE.REFER = "FUEL SURCHARGE".
            SET TRANFILE.SLS# = INVOICE.SLS#.
            SET TRANFILE.T-AMT = F-TOT.
            SET TRANFILE.T-DATE = INVOICE.I-DATE.
            SET TRANFILE.T-OPR = XOPR.
            SET TRANFILE.T-TYPE = "N".
            SET TRANFILE.COMMIS = 0.
            SET TRANFILE.SUB-CON = 0.
            SET TRANFILE.TR-STAT = "A".
            RELEASE TRANFILE.
          END.
/*          IF CTR = 1 THEN DO:
            DISPLAY SKIP(15) SPACE(53) "Fuel Surcharge" SPACE(2) F-TOT
            SKIP(1) SPACE(10) INVOICE.TERM-DSC SPACE(45) T-TOT + F-TOT
            SKIP(4) WITH FRAME XA NO-BOX NO-LABELS.
          END.
          ELSE
          IF CTR = 2 THEN DO:
            DISPLAY SKIP(14) SPACE(53) "Fuel Surcharge" SPACE(2) F-TOT
            SKIP(1) SPACE(10) INVOICE.TERM-DSC SPACE(45) T-TOT + F-TOT
            SKIP(4) WITH FRAME XB NO-BOX NO-LABELS.
          END.
          ELSE
          IF CTR = 3 THEN DO:
            DISPLAY SKIP(13) SPACE(53) "Fuel Surcharge" SPACE(2) F-TOT
            SKIP(1) SPACE(10) INVOICE.TERM-DSC SPACE(45) T-TOT + F-TOT
            SKIP(4) WITH FRAME XC NO-BOX NO-LABELS.
          END.
          ELSE
          IF CTR = 4 THEN DO:
            DISPLAY SKIP(12) SPACE(53) "Fuel Surcharge" SPACE(2) F-TOT
            SKIP(1) SPACE(10) INVOICE.TERM-DSC SPACE(45) T-TOT + F-TOT
            SKIP(4) WITH FRAME XD NO-BOX NO-LABELS.
          END.
          ELSE
          IF CTR = 5 THEN DO:
            DISPLAY SKIP(11) SPACE(53) "Fuel Surcharge" SPACE(2) F-TOT
            SKIP(1) SPACE(10) INVOICE.TERM-DSC SPACE(45) T-TOT + F-TOT
            SKIP(4) WITH FRAME XE NO-BOX NO-LABELS.
          END.
          ELSE
          IF CTR = 6 THEN DO:
            DISPLAY SKIP(10) SPACE(53) "Fuel Surcharge" SPACE(2) F-TOT
            SKIP(1) SPACE(10) INVOICE.TERM-DSC SPACE(45) T-TOT + F-TOT
            SKIP(4) WITH FRAME XF NO-BOX NO-LABELS.
          END.
          ELSE
          IF CTR = 7 THEN DO:
            DISPLAY SKIP(9) SPACE(53) "Fuel Surcharge" SPACE(2) F-TOT
            SKIP(1) SPACE(10) INVOICE.TERM-DSC SPACE(45) T-TOT + F-TOT
            SKIP(4) WITH FRAME XG NO-BOX NO-LABELS.
          END.
          ELSE
          IF CTR = 8 THEN DO:
            DISPLAY SKIP(8) SPACE(53) "Fuel Surcharge" SPACE(2) F-TOT
            SKIP(1) SPACE(10) INVOICE.TERM-DSC SPACE(45) T-TOT + F-TOT
            SKIP(4) WITH FRAME XH NO-BOX NO-LABELS.
          END.
          ELSE
          IF CTR = 9 THEN DO:
            DISPLAY SKIP(7) SPACE(53) "Fuel Surcharge" SPACE(2) F-TOT
            SKIP(1) SPACE(10) INVOICE.TERM-DSC SPACE(45) T-TOT + F-TOT
            SKIP(4) WITH FRAME XI NO-BOX NO-LABELS.
          END.
          ELSE
          IF CTR = 10 THEN DO:
            DISPLAY SKIP(6) SPACE(53) "Fuel Surcharge" SPACE(2) F-TOT
            SKIP(1) SPACE(10) INVOICE.TERM-DSC SPACE(45) T-TOT + F-TOT
            SKIP(4) WITH FRAME XJ NO-BOX NO-LABELS.
          END.
          ELSE
          IF CTR = 11 THEN DO:
            DISPLAY SKIP(5) SPACE(53) "Fuel Surcharge" SPACE(2) F-TOT
            SKIP(1) SPACE(10) INVOICE.TERM-DSC SPACE(45) T-TOT + F-TOT
            SKIP(4) WITH FRAME XK NO-BOX NO-LABELS.
          END.
          ELSE
          IF CTR = 12 THEN DO:
            DISPLAY SKIP(4) SPACE(53) "Fuel Surcharge" SPACE(2) F-TOT
            SKIP(1) SPACE(10) INVOICE.TERM-DSC SPACE(45) T-TOT + F-TOT
            SKIP(4) WITH FRAME XL NO-BOX NO-LABELS.
          END.
          ELSE
          IF CTR = 13 THEN DO:
            DISPLAY SKIP(3) SPACE(53) "Fuel Surcharge" SPACE(2) F-TOT
            SKIP(1) SPACE(10) INVOICE.TERM-DSC SPACE(45) T-TOT + F-TOT
            SKIP(4) WITH FRAME XM NO-BOX NO-LABELS.
          END.
          ELSE
          IF CTR = 14 THEN DO:
            DISPLAY SKIP(2) SPACE(53) "Fuel Surcharge" SPACE(2) F-TOT
            SKIP(1) SPACE(10) INVOICE.TERM-DSC SPACE(45) T-TOT + F-TOT
            SKIP(4) WITH FRAME XN NO-BOX NO-LABELS.
          END.
          ELSE
          IF CTR = 15 THEN DO:
            DISPLAY SKIP(1) SPACE(53) "Fuel Surcharge" SPACE(2) F-TOT
            SKIP(1) SPACE(10) INVOICE.TERM-DSC SPACE(45) T-TOT + F-TOT
            SKIP(4) WITH FRAME XO NO-BOX NO-LABELS.
          END.
          ELSE
            IF CTR = 16 THEN DO:
            DISPLAY SKIP(0) SPACE(53) "Fuel Surcharge" SPACE(2) F-TOT
            SKIP(1) SPACE(10) INVOICE.TERM-DSC SPACE(45) T-TOT + F-TOT
            SKIP(4) WITH FRAME XP NO-BOX NO-LABELS.
          END.              */
      END.
  END. 
S-TOT = 0.0.
T-TOT = 0.0.
OUTPUT TO PRINTER.
   FOR EACH INVOICE USE-INDEX INDX7
                    WHERE INVOICE.COMP# = XCOM AND INVOICE.DIV# = XDIV AND
                          invoice.route# = 0 and
                          INVOICE.I-TYPE = "N" BREAK BY INVOICE.INV-NO:
   FIND FIRST PROPSL /* USE-INDEX INDX  */
                 WHERE PROPSL.COMP# = INVOICE.COMP# AND
                       PROPSL.DIV# = INVOICE.DIV# AND
                       PROPSL.CUST# = INVOICE.CUST# AND
                       PROPSL.PROPSL# = INVOICE.PROPSL#.
/*    FIND FIRST AR-DESP WHERE AR-DESP.COMP# = INVOICE.COMP# AND
                             AR-DESP.DIV# = INVOICE.DIV# AND
                             AR-DESP.CUST# = INVOICE.CUST# AND
                             AR-DESP.PROPSL# = INVOICE.PROPSL# AND
                             AR-DESP.ITEM# = INVOICE.ITEM# NO-ERROR.
    IF NOT AVAILABLE AR-DESP THEN DO:
        ARD = "".
    END.
    ELSE DO:
        ARD = AR-DESP.DESC01.
    END.                               */
   FORM HEADER TODAY FORMAT "99/99/9999"
               "QUICKBOOKS INVOICE REPORT" AT 30 "PAGE:" AT 65
               PAGE-NUMBER FORMAT ">>9" SKIP(1) XCOM-N SPACE(5) XDIV-N SKIP(1)
               "CUSTOMER NAME" AT 1 "LOCATION NAME" AT 30
               SKIP(0) "LOCATION ADDRESS 1" AT 1 "LOCATION ADDRESS 2" AT 27
               "LOCATION ADDRESS 3" AT 54 SKIP(0) "CUSTOMER #" AT 1
               "PROPOSAL #" AT 12 "ITM#" AT 23 "T-INDX" AT 28 SKIP(0)
               "INVOICE #" AT 1 "COMP-DATE" AT 12 "AMOUNT" AT 32
               "PURCHASE ORDER" AT 40 SKIP(0) "INVOICE DESCRIPTION" AT 1
               "SUB#" AT 65 "RT#" AT 70
                SKIP(1) WITH FRAME QP PAGE-TOP NO-LABELS NO-BOX.
   VIEW FRAME QP.
   T-TOT = T-TOT + TOT-INV.
   IF FIRST-OF(INVOICE.INV-NO)
       THEN DO:
           S-TOT = 0.0.
           DISPLAY SKIP(1) PROPSL.C-NAME SPACE(4) INVOICE.L-NAME SKIP(0)
                   INVOICE.LADDR01 SPACE(1) INVOICE.LADDR02 SPACE(1)
                   INVOICE.LADDR03 SKIP(0) INVOICE.CUST# SPACE(1) INVOICE.PROPSL#
                   SPACE(1) INVOICE.ITEM# SPACE(5) INVOICE.T-INDX SKIP(0)
                   INVOICE.INV-NO SPACE(1) INVOICE.C-DATE SPACE(1)
                   INVOICE.TOT-INV SPACE(2) INVOICE.PO# SKIP(0)
                   INVOICE.DESC01 SPACE(4) INVOICE.SUB# SPACE(2) INVOICE.ROUTE#
               WITH FRAME QA NO-BOX NO-LABELS.
           S-TOT = S-TOT + TOT-INV.
           NEXT.
       END.
   IF LAST-OF(INVOICE.INV-NO)
       THEN DO:
           S-TOT = S-TOT + TOT-INV.
           DISPLAY PROPSL.C-NAME SPACE(4) INVOICE.L-NAME SKIP(0)
                   INVOICE.LADDR01 SPACE(1) INVOICE.LADDR02 SPACE(1)
                   INVOICE.LADDR03 SKIP(0) INVOICE.CUST# SPACE(1) INVOICE.PROPSL#
                   SPACE(1) INVOICE.ITEM# SPACE(5) INVOICE.T-INDX SKIP(0)
                   INVOICE.INV-NO SPACE(1) INVOICE.C-DATE SPACE(1)
                   INVOICE.TOT-INV SPACE(2) INVOICE.PO# SKIP(0)
                   INVOICE.DESC01 SPACE(4) INVOICE.SUB# SPACE(2) INVOICE.ROUTE#
           SKIP(0) SPACE(35) S-TOT "TOTAL" WITH FRAME QB NO-BOX NO-LABELS.
           S-TOT = 0.0.
           NEXT.
       END.
       ELSE DO:
           DISPLAY PROPSL.C-NAME SPACE(4) INVOICE.L-NAME SKIP(0)
                   INVOICE.LADDR01 SPACE(1) INVOICE.LADDR02 SPACE(1)
                   INVOICE.LADDR03 SKIP(0) INVOICE.CUST# SPACE(1) INVOICE.PROPSL#
                   SPACE(1) INVOICE.ITEM# SPACE(5) INVOICE.T-INDX SKIP(0)
                   INVOICE.INV-NO SPACE(1) INVOICE.C-DATE SPACE(1)
                   INVOICE.TOT-INV SPACE(2) INVOICE.PO# SKIP(0)
                   INVOICE.DESC01 SPACE(4) INVOICE.SUB# SPACE(2) INVOICE.ROUTE#
                   WITH FRAME QC NO-BOX NO-LABELS.
           S-TOT = S-TOT + TOT-INV.
       END.
   END.
   DISPLAY SKIP(2) SPACE(14) "ORDER TOTALS >>" T-TOT
       WITH FRAME QD NO-LABELS NO-BOX.
